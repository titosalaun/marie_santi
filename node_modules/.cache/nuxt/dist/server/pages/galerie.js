exports.ids = [3];
exports.modules = {

/***/ 43:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(URL) {/* harmony import */ var vuex__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3);
/* harmony import */ var vuex__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(vuex__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(5);
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var tone__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(37);
/* harmony import */ var tone__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(tone__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(38);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__);
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//




var playerSound;
var bufferSound = new Array();
/* harmony default export */ __webpack_exports__["a"] = ({
  middleware: 'auth',
  computed: { ...Object(vuex__WEBPACK_IMPORTED_MODULE_0__["mapGetters"])(['isAuthenticated', 'loggedInfont'])
  },

  mounted() {
    var id = 0;
    localStorage.setItem('id_message', JSON.stringify(id));
    this.parametres = JSON.parse(localStorage.getItem('parametres') || "[]");
    this.getGalerie();
    playerSound = new tone__WEBPACK_IMPORTED_MODULE_2__["Player"]().toDestination();
    this.initDisplayErreur();
  },

  data() {
    return {
      url_server: this.$store.state.url_server,
      id_user: this.$auth.user.id,
      parametres: '',
      messages: [],
      isShowLoading: true,
      isShowNoResult: false,
      timeoutObj: '',
      isTools: false,
      isPause: false,
      myCurrentTimeSave: 0,
      valSetTimeout: 0
    };
  },

  methods: {
    getGalerie: function () {
      axios__WEBPACK_IMPORTED_MODULE_1___default.a.get(this.url_server + "/getGalerie").then(response => {
        this.isShowLoading = false;
        this.messages = response.data.liste;
        if (this.messages.length == 0) this.isShowNoResult = true;
      }).catch(error => displayErreur('Erreur lors du chargement de la galerie'));
    },

    async logout() {
      await this.$auth.logout();
      this.$router.push('/login');
    },

    loadSound(file, id, index) {
      console.log("debut"); //file = convertSound(file);

      console.log("blob : " + file); //var blobUrl = URL.createObjectURL(file);

      bufferSound[index] = new tone__WEBPACK_IMPORTED_MODULE_2__["ToneAudioBuffer"]({
        onload: () => {
          document.querySelector('#' + id + ' .duration').innerHTML = this.convertSoundDuration(bufferSound[index].duration);
          document.querySelector('#' + id + ' .content-play').classList.remove('isLoading');
        },
        onerror: () => {
          document.querySelector('#' + id + ' .duration').innerHTML = "no sound";
        },
        reverse: false,
        url: file
      });
      /*bufferSound[index] = new Tone.ToneAudioBuffer(file, ( ) => {
      		console.log("in : " + id)
      	document.querySelector('#' + id + ' .duration').innerHTML = this.convertSoundDuration(bufferSound[index].duration);
      	document.querySelector('#' + id + ' .content-play').classList.remove('isLoading');
      });*/
    },

    onload() {
      console.log("ONLOAD");
    },

    playSound(file, id, index) {
      if (!document.querySelector('#' + id + ' .content-play').classList.contains('isLoading')) {
        if (this.isPlayingSound == index) {
          this.stopSound();
        } else {
          if (this.isPlayingSound != -1) {
            clearTimeout(this.valSetTimeout);
            this.stopSound();
          }

          this.initAllSound();
          tone__WEBPACK_IMPORTED_MODULE_2__["Transport"].start();
          this.myCurrentTime = new tone__WEBPACK_IMPORTED_MODULE_2__["TransportTime"]();
          this.isPlayingSound = index;
          this.progressValTotal = bufferSound[index].duration;
          playerSound.buffer = bufferSound[index];
          playerSound.start();

          playerSound.onstop = () => {
            this.stopSound();
          };

          this.playSoundProgress(id);
          console.log("TITO1"); //document.querySelector('#' + id + ' .player img').setAttribute("src","/img/pause.png");

          document.querySelector('#' + id + ' .ctrlPlay').classList.add("hide");
          document.querySelector('#' + id + ' .ctrlPause').classList.remove("hide");
        }
      }
    },

    initAllSound() {
      document.querySelectorAll('.progress-play').forEach(el => el.style.width = '0px');
      document.querySelectorAll('.ctrlPlay').forEach(el => el.classList.remove("hide"));
      document.querySelectorAll('.ctrlPause').forEach(el => el.classList.add("hide"));
    },

    pauseSound(id) {
      //Tone.Transport.stop();
      clearInterval(this.valSetInterval);
      playerSound.stop();
      this.myCurrentTimeSave = this.myCurrentTime;
      console.log("PAUSE : " + this.myCurrentTimeSave); //document.querySelector('#' + id + ' .player img').setAttribute("src","/img/play.svg");

      document.querySelector('#' + id + ' .ctrlPlay').classList.remove("hide");
      document.querySelector('#' + id + ' .ctrlPause').classList.add("hide"); //Tone.Transport.stop();
      //this.myCurrentTime = 0;
    },

    stopSound() {
      //Tone.stop();
      console.log("STOP");
      this.isPlayingSound = -1;
      this.progressValTotal = 0;
      clearInterval(this.valSetInterval);
      this.initAllSound();
      playerSound.stop();
      tone__WEBPACK_IMPORTED_MODULE_2__["Transport"].stop();
      this.myCurrentTime = 0;
    },

    playSoundProgress(id) {
      console.log(this.myCurrentTime + ' / ' + this.progressValTotal);
      var val_progress = Math.round(this.myCurrentTime * 100 / this.progressValTotal);

      if (this.isPlayingSound != -1 && val_progress <= 101) {
        document.querySelector('#' + id + ' .progress-play').style.width = val_progress + '%';
        this.valSetInterval = setTimeout(function () {
          if (this.isPlayingSound != -1) this.playSoundProgress(id);
        }.bind(this), 200);
      } else {
        clearTimeout(this.valSetInterval);
        tone__WEBPACK_IMPORTED_MODULE_2__["Transport"].stop();
      }
    },

    convertSoundDuration(sec) {
      var val = (sec / 60).toFixed(2);
      return val.toString().replace(".", ":");
    },

    convertSound(data) {
      let binary = convertURIToBinary(data);
      let blob = new Blob([binary], {
        type: 'audio/ogg'
      });
      let blobUrl = URL.createObjectURL(blob);
      return blobUrl;
    },

    initDisplayErreur: function () {
      hideErreur();
    },

    getRandomNumber(min, max) {
      return Math.floor(Math.random() * (max - min + 1) + min);
    },

    delPoster: function (id_message) {
      axios__WEBPACK_IMPORTED_MODULE_1___default.a.get(this.url_server + "/delPoster?id_message=" + id_message).then(response => {
        this.isShowLoading = true;
        this.isShowNoResult = false;
        this.messages = new Array();
        this.getGalerie();
      }).catch(error => displayErreur('Erreur lors de la suppression du poster'));
    }
  }
});
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(39)["URL"]))

/***/ }),

/***/ 62:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@nuxt/components/dist/loader.js??ref--0-0!./node_modules/vue-loader/lib??vue-loader-options!./pages/galerie.vue?vue&type=template&id=c41ec1b0&scoped=true&
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"container",staticStyle:{"background-color":"#383838"}},[_vm._ssrNode("<div class=\"content\" data-v-c41ec1b0>","</div>",[_vm._ssrNode("<div class=\"col-left\" data-v-c41ec1b0>","</div>",[_vm._ssrNode("<div class=\"logo\" data-v-c41ec1b0>","</div>",[_c('nuxt-link',{attrs:{"to":"/"}},[_c('svg',{attrs:{"id":"Calque_1","data-name":"Calque 1","xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 776.86 861.5"}},[_c('path',{attrs:{"d":"M291.29,701.18c0,92.18,68.41,131,165.81,131,112.47,0,162.9-51,162.9-163.49V558.56H444.92C360.86,558.56,291.29,614.22,291.29,701.18ZM151.57,725.53c0-113,68.41-197.69,176.24-208.13V490.15c-84.06-10.43-146.67-87-146.67-179.14,0-133.34,130.44-215.66,280-215.66C622.9,95.35,740,173,747,332.46H611.89c-7-80-60.87-117.1-149-117.1-83.48,0-141.45,38.84-141.45,114.78s55.65,117.11,139.14,117.11H928.43V558.56H755.08c0,266.11-3.47,265,5.8,273.64,8.12,7.54,11.6,5.22,167.55,5.22V945.25c-207.55,0-224.94,5.8-263.21-34.2-22.61-23.77-21.45-74.79-21.45-74.79H622.9c-34.78,86.38-107.83,120.59-203.49,120.59C265.2,956.85,151.57,877.42,151.57,725.53Z","transform":"translate(-151.57 -95.35)"}})])])],1),_vm._ssrNode(" <div class=\"tools hidePara\" data-v-c41ec1b0><div"+(_vm._ssrClass("tools-content",{ open: _vm.isTools }))+" data-v-c41ec1b0></div> <div class=\"tools-nav\" data-v-c41ec1b0>Paramètres</div></div>")],2),_vm._ssrNode(" <div"+(_vm._ssrClass("col-content",{ marge: _vm.isTools }))+" data-v-c41ec1b0><div class=\"col-content-list galerie\" data-v-c41ec1b0>"+((!_vm.messages.length)?("<div data-v-c41ec1b0><div"+(_vm._ssrStyle(null,null, { display: (_vm.isShowLoading) ? '' : 'none' }))+" data-v-c41ec1b0>Chargement de la galerie...</div> <div"+(_vm._ssrStyle(null,null, { display: (_vm.isShowNoResult) ? '' : 'none' }))+" data-v-c41ec1b0>aucun élément enregistré</div></div>"):"<!---->")+" "+(_vm._ssrList((_vm.messages),function(message,indexMessage){return ("<div class=\"item-galerie\" data-v-c41ec1b0><div data-v-c41ec1b0><img"+(_vm._ssrAttr("src",'/upload/poster_' + message.id_message + '.png'))+" alt=\"poster\" data-v-c41ec1b0></div> <div class=\"item-galerie-tools\" data-v-c41ec1b0><div data-v-c41ec1b0><button class=\"cursor-pointer toPoster\" data-v-c41ec1b0>  Modifier  </button></div> <div data-v-c41ec1b0><button class=\"cursor-pointer toPoster\" data-v-c41ec1b0>Supprimer</button></div></div></div>")}))+"</div></div> <div class=\"col-right\" data-v-c41ec1b0></div>")],2)])}
var staticRenderFns = []


// CONCATENATED MODULE: ./pages/galerie.vue?vue&type=template&id=c41ec1b0&scoped=true&

// EXTERNAL MODULE: ./node_modules/babel-loader/lib??ref--2-0!./node_modules/@nuxt/components/dist/loader.js??ref--0-0!./node_modules/vue-loader/lib??vue-loader-options!./pages/galerie.vue?vue&type=script&lang=js&
var galerievue_type_script_lang_js_ = __webpack_require__(43);

// CONCATENATED MODULE: ./pages/galerie.vue?vue&type=script&lang=js&
 /* harmony default export */ var pages_galerievue_type_script_lang_js_ = (galerievue_type_script_lang_js_["a" /* default */]); 
// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js
var componentNormalizer = __webpack_require__(2);

// CONCATENATED MODULE: ./pages/galerie.vue



function injectStyles (context) {
  
  
}

/* normalize component */

var component = Object(componentNormalizer["a" /* default */])(
  pages_galerievue_type_script_lang_js_,
  render,
  staticRenderFns,
  false,
  injectStyles,
  "c41ec1b0",
  "b60d2bfe"
  
)

/* harmony default export */ var galerie = __webpack_exports__["default"] = (component.exports);

/***/ })

};;
//# sourceMappingURL=galerie.js.map