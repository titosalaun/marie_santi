{"version":3,"file":"pages/typotheque.js","sources":["webpack:///./pages/typotheque.vue","webpack:///./pages/typotheque.vue?5e52","webpack:///./pages/typotheque.vue?f0b9","webpack:///./pages/typotheque.vue?8c50"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from 'vuex';\nimport axios from 'axios';\nimport * as Tone from 'tone';\nimport moment from 'moment';\n\nvar P5;\n\nif (process.browser) {\n  var effet_1 = require('~/assets/js/ms1.js')\n  var effet_2 = require('~/assets/js/ms2.js')\n  var effet_3 = require('~/assets/js/ms3.js')\n  \n  \n  //\n}\n\nvar playerSound;\nvar bufferSound = new Array();\n\nexport default {\n\tmiddleware: 'auth',\n   computed: {\n    ...mapGetters(['isAuthenticated', 'loggedInfont']),\n  },\n\tmounted() {   \n\t var id = 0;\n\t localStorage.setItem('id_message', JSON.stringify(id));\n\t this.parametres = JSON.parse(localStorage.getItem('parametres') || \"[]\") ;\n\t this.getMessages();\n\t \n\t playerSound = new Tone.Player().toDestination();\n\t \n\t this.initDisplayErreur();\n\t \n\t P5 = require('p5');\n\t},\n\tdata() {\n\t    return {\n\t\t    script: null,\n\t\t\tps: null,\n\t\t\tradar:new Array(),\n\t\t    url_server:this.$store.state.url_server,\n\t\t    id_user: this.$auth.user.id,\n\t\t    parametres:'',\n\t\t    messages : [],\n\t\t    isShowLoading:true,\n\t\t    isShowNoResult:false,\n\t\t    timeoutObj:'',\n\t\t\tisTools:false,\n\t\t\tisPause:false,\n\t\t\tmyCurrentTimeSave:0,\n\t\t\tvalSetTimeout:0,\n\t\t\tindexLoad:0,\n\t\t\ttito:'',\n\t    }\n\t  },\n\t  directives: {\n    forCallback(el, binding) {\n\t    \n      let element = binding.value\n      var key = element.key\n      var len = 0\n\n      if (Array.isArray(element.array)) {\n        len = element.array.length\n      }\n\n      else if (typeof element.array === 'object') {\n        var keys = Object.keys(element.array)\n        key = keys.indexOf(key)\n        len = keys.length\n      }\n\n      if (key == len - 1) {\n        if (typeof element.callback === 'function') {\n          element.callback(0,element.array)\n        }\n      }\n    }\n  },\n\tmethods: {\n\t\t getMessages: function()\n\t\t {\n\t       axios.get(this.url_server + \"/getMessages?id_user=\" + this.id_user)\n\t       .then(response => {\n\t\t       this.isShowLoading = false;\n\t\t       this.messages = response.data.liste;\n\t\t       if (this.messages.length == 0) this.isShowNoResult = true;\n\t\t   })\n\t       .catch(error => displayErreur('Erreur lors du chargement des messages'))\n\t    }\n\t    ,\n\t    delMessage: function(id_message)\n\t\t {\n\t       axios.get(this.url_server + \"/delMessage?id_message=\" + id_message)\n\t       .then(response => {\n\t\t       this.isShowLoading = true;\n\t\t       this.isShowNoResult = false;\n\t\t       this.messages = new Array();\n\t\t       this.getMessages();\n\t\t   })\n\t       .catch(error => displayErreur('Erreur lors du chargement des messages'))\n\t    }\n\t    ,\n\t    getPoster: function(id_message,event)\n\t\t {\n\t       event.target.innerHTML = 'dev en cours';\n\t        setTimeout(function () { event.target.innerHTML = 'Créer un poster'; }.bind(this), 2000);\n\t    }\n\t\t,\n\t\tasync logout() {\n\t      await this.$auth.logout();\n\t      this.$router.push('/login')\n\t    }\n\t    ,\n\t\tloadSound(file, id, index)\n\t\t{\n\t\t\tconsole.log(\"debut\")\n\t\t\t\n\t\t\t//file = convertSound(file);\n\t\t\tconsole.log(\"blob : \" + file)\n\t\t\t//var blobUrl = URL.createObjectURL(file);\n\t\t\t\n\t\t\tbufferSound[index] = new Tone.ToneAudioBuffer({\n\t\t\t\tonload: () => {\n\t\t\t\t\tdocument.querySelector('#' + id + ' .duration').innerHTML = this.convertSoundDuration(bufferSound[index].duration);\n\t\t\t\t\tdocument.querySelector('#' + id + ' .content-play').classList.remove('isLoading');\n\t\t\t\t},\n\t\t\t\tonerror: () => {\n\t\t\t\t\tdocument.querySelector('#' + id + ' .duration').innerHTML = \"no sound\";\n\t\t\t\t},\n\t\t\t\treverse: false,\n\t\t\t\turl: file,\n\t\t\t});\n\t\t\t\n\t\t\t/*bufferSound[index] = new Tone.ToneAudioBuffer(file, ( ) => {\n\n\t\t\t\tconsole.log(\"in : \" + id)\n\t\t\t\tdocument.querySelector('#' + id + ' .duration').innerHTML = this.convertSoundDuration(bufferSound[index].duration);\n\t\t\t\tdocument.querySelector('#' + id + ' .content-play').classList.remove('isLoading');\n\t\t\t});*/\n\t\t\t\n\t\t\t\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\t\t}\n\t    ,\n\t    onload()\n\t    {\n\t\t    console.log(\"ONLOAD\")\n\t    }\n\t    ,\n\t\tplaySound(file,id,index)  \n\t\t{\n\t\t\tif (!document.querySelector('#' + id + ' .content-play').classList.contains('isLoading')) {\n\t\t\t\t\n\t\t\t\tif (this.isPlayingSound == index) {\n\t\t\t\t\tthis.stopSound();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (this.isPlayingSound != -1) {\n\t\t\t\t\t\tclearTimeout(this.valSetTimeout);\n\t\t\t\t\t\tthis.stopSound();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.initAllSound();\n\t\t\t\t\t\n\t\t\t\t\tTone.Transport.start();\n\t\t\t\t\tthis.myCurrentTime = new Tone.TransportTime();\n\t\t\t\t\t\n\t\t\t\t\tthis.isPlayingSound = index;\n\t\t\t\t\tthis.progressValTotal = bufferSound[index].duration;\n\t\t\t\t\tplayerSound.buffer = bufferSound[index];\n\t\t\t\t\tplayerSound.start();\n\t\t\t\t\tplayerSound.onstop = () => {\n\t\t\t\t\t    this.stopSound();\n\t\t\t\t\t  };\n\t\t\t\t\tthis.playSoundProgress(id);\n\t\t\t\t\tconsole.log(\"TITO1\")\n\t\t\t\t\t//document.querySelector('#' + id + ' .player img').setAttribute(\"src\",\"/img/pause.png\");\n\t\t\t\t\tdocument.querySelector('#' + id + ' .ctrlPlay').classList.add(\"hide\");\n\t\t\t\t\tdocument.querySelector('#' + id + ' .ctrlPause').classList.remove(\"hide\");\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t,\n\t\tinitAllSound()\n\t\t{\n\t\t\tdocument.querySelectorAll('.progress-play').forEach(el => el.style.width = '0px');\n\t\t\tdocument.querySelectorAll('.ctrlPlay').forEach(el => el.classList.remove(\"hide\"));\n\t\t\tdocument.querySelectorAll('.ctrlPause').forEach(el => el.classList.add(\"hide\"));\n\t\t}\n\t\t,\n\t\tpauseSound(id)  \n\t\t{\n\t\t\t//Tone.Transport.stop();\n\t\t\tclearInterval(this.valSetInterval);\t\t\n\t\t\tplayerSound.stop();\t\t\n\t\t\t\n\t\t\t\n\t\t\tthis.myCurrentTimeSave = this.myCurrentTime;\n\t\t\tconsole.log(\"PAUSE : \" + this.myCurrentTimeSave)\n\t\t\t//document.querySelector('#' + id + ' .player img').setAttribute(\"src\",\"/img/play.svg\");\n\t\t\tdocument.querySelector('#' + id + ' .ctrlPlay').classList.remove(\"hide\");\n\t\t\tdocument.querySelector('#' + id + ' .ctrlPause').classList.add(\"hide\");\n\t\t\t//Tone.Transport.stop();\n\t\t\t//this.myCurrentTime = 0;\n\t\t}\n\t\t,\n\t\tstopSound()  \n\t\t{\n\t\t\t//Tone.stop();\n\t\t\tconsole.log(\"STOP\")\n\t\t\tthis.isPlayingSound = -1;\n\t\t\tthis.progressValTotal = 0;\n\t\t\tclearInterval(this.valSetInterval);\n\t\t\tthis.initAllSound();\n\t\t\tplayerSound.stop();\t\t\n\t\t\tTone.Transport.stop();\n\t\t\tthis.myCurrentTime = 0;\n\t\t}\n\t\t,\n\t\tplaySoundProgress(id)  \n\t\t{\n\t\t\tconsole.log(this.myCurrentTime + ' / ' + this.progressValTotal)\n\t\t\tvar val_progress = Math.round((this.myCurrentTime*100) / this.progressValTotal )\n\t\t\tif ((this.isPlayingSound != -1) && (val_progress <= 101)) {\t\t\n\t\t\t\tdocument.querySelector('#' + id + ' .progress-play').style.width = val_progress + '%';\n\t\t\t\t\n\t\t\t\tthis.valSetInterval = setTimeout(function () { if (this.isPlayingSound != -1) this.playSoundProgress(id) }.bind(this), 200);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tclearTimeout(this.valSetInterval);\n\t\t\t\tTone.Transport.stop();\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t,\n\t\tconvertSoundDuration(sec)\n\t\t{\n\t\t\tvar val = (sec / 60).toFixed(2);\n\t\t\treturn val.toString().replace(\".\",\":\")\n\t\t}\n\t\t,\n\t\tconvertSound(data) {\n\t\t\tlet binary = convertURIToBinary(data);\n\t\t\tlet blob = new Blob([binary], {\n\t\t\t  type: 'audio/ogg'\n\t\t\t});\n\t\t\tlet blobUrl = URL.createObjectURL(blob);\n\t\t\t\n\t\t\treturn blobUrl;\n\t\t}\n\t\t,\n\t    initDisplayErreur: function()\n\t    {\n\t\t    hideErreur();\n\t    }\n\t    ,\n\t    getRandomNumber(min,max){\n\t\t    return Math.floor(Math.random()*(max-min+1)+min);\n\t\t}\n\t\t,\n\t\tcallbackOnP5: function(timeStr) {\n\t\t    this.tito = timeStr;\n\t\t  }\n\t\t,\n\t\tloadMessage: function(elements,index,id_message,id_effet,message,color_text,color_bg,font_size) {\n\t\t\tconsole.log(\"id_effet : \" + id_effet)\n\t\t\tthis.radar[index] = this.selectEffet(index,id_effet);\n\t\t\t\n\t\t\tthis.ps = new P5(this.radar[index].main)\n\t\t    this.radar[index].setDelegate(this.callbackOnP5);\n\t\t    this.radar[index].setFctCanvasSize(800,500)\n\t\t    this.radar[index].setFctCanvasId(id_message)\n\t\t    this.radar[index].setFctSound(0)\n\t\t    this.radar[index].setFctTextColor(color_text)\n\t\t    this.radar[index].setFctBgColor(color_bg)\n\t\t    this.radar[index].setFctFontSize(font_size)\n    \n\t\t\tthis.radar[index].setFctTexte(message,index);\n\t\t\t\n\t\t\tindex++;\n\t\t\t//if (index < 2) this.callback(index,elements)\n\t\t\t\n\t\t\t//this.startP5();\n\t\t}\n\t\t,\n\t\tselectEffet: function(index,id_effet)\n\t\t{\n\t\t\tif (id_effet == 1) this.radar[index] = effet_1;\n\t\t\tif (id_effet == 2) this.radar[index] = effet_2;\n\t\t\tif (id_effet == 3) this.radar[index] = effet_3;\n\t\t\t\n\t\t\treturn this.radar[index];\n\t\t}\n\t\t,\n\t\tcallback(index,elements) {\t\n\t\t\t\t//this.loadMessage(elements,index,elements[index].id_message,elements[index].id_effet,elements[index].texte,elements[index].color_text,elements[index].color_bg,elements[index].font_size);\n\t    },\n\t\tgoHome: function(id_message)\n\t\t{\n\t\t\tlocalStorage.setItem('id_message', JSON.stringify(id_message));\n\t\t\tdocument.location = '/'\n\t\t}\n\t\t,\n\t\tformatMessage: function(message) {\n\t\t\tmessage = message.replaceAll(\"<br>\",' ');\n\t\t\tmessage = message.replaceAll(\"<div>\",' ');\n\t\t\tmessage = message.replaceAll(\"</div>\",' ');\n\t\t\tmessage = message.replaceAll(\"<br />\",' ');\n\t\t\treturn message\n\t\t}\n\t    \t\t\n\t}\n}\n\n\n\n\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_vm._ssrNode(\"<div class=\\\"content\\\" data-v-54621e73>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-left\\\" data-v-54621e73>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"logo\\\" data-v-54621e73>\",\"</div>\",[_c('nuxt-link',{attrs:{\"to\":\"/\"}},[_c('svg',{attrs:{\"id\":\"Calque_1\",\"data-name\":\"Calque 1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 776.86 861.5\"}},[_c('path',{attrs:{\"d\":\"M291.29,701.18c0,92.18,68.41,131,165.81,131,112.47,0,162.9-51,162.9-163.49V558.56H444.92C360.86,558.56,291.29,614.22,291.29,701.18ZM151.57,725.53c0-113,68.41-197.69,176.24-208.13V490.15c-84.06-10.43-146.67-87-146.67-179.14,0-133.34,130.44-215.66,280-215.66C622.9,95.35,740,173,747,332.46H611.89c-7-80-60.87-117.1-149-117.1-83.48,0-141.45,38.84-141.45,114.78s55.65,117.11,139.14,117.11H928.43V558.56H755.08c0,266.11-3.47,265,5.8,273.64,8.12,7.54,11.6,5.22,167.55,5.22V945.25c-207.55,0-224.94,5.8-263.21-34.2-22.61-23.77-21.45-74.79-21.45-74.79H622.9c-34.78,86.38-107.83,120.59-203.49,120.59C265.2,956.85,151.57,877.42,151.57,725.53Z\",\"transform\":\"translate(-151.57 -95.35)\"}})])])],1),_vm._ssrNode(\" <div class=\\\"tools hidePara\\\" data-v-54621e73><div\"+(_vm._ssrClass(\"tools-content\",{ open: _vm.isTools }))+\" data-v-54621e73></div> <div class=\\\"tools-nav\\\" data-v-54621e73>Paramètres</div></div>\")],2),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div\"+(_vm._ssrClass(\"col-content\",{ marge: _vm.isTools }))+\" data-v-54621e73>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-content-list\\\" data-v-54621e73>\",\"</div>\",[_vm._ssrNode(((!_vm.messages.length)?(\"<div data-v-54621e73><div\"+(_vm._ssrStyle(null,null, { display: (_vm.isShowLoading) ? '' : 'none' }))+\" data-v-54621e73>Chargement des messages...</div> <div\"+(_vm._ssrStyle(null,null, { display: (_vm.isShowNoResult) ? '' : 'none' }))+\" data-v-54621e73>aucun message enregistré</div></div>\"):\"<!---->\")+\" \"),_vm._l((_vm.messages),function(message,indexMessage){return _c('div',{directives:[{name:\"for-callback\",rawName:\"v-for-callback\",value:({key: indexMessage, array: _vm.messages, callback: _vm.callback}),expression:\"{key: indexMessage, array: messages, callback: callback}\"}],staticClass:\"item\"},[_vm._ssrNode(\"<div\"+(_vm._ssrAttr(\"id\",'S_' + indexMessage))+\" class=\\\"item-content\\\" data-v-54621e73><div class=\\\"message relative cursor-pointer\\\"\"+(_vm._ssrStyle(null,{ 'color': message.color_text }, null))+\" data-v-54621e73>\"+_vm._ssrEscape(\"\\n\\t\\t\\t\\t\\t  \\t\\t \"+_vm._s(_vm.formatMessage(message.texte))+\" \\n\\t\\t\\t\\t\\t  \\t\\t\")+\"<div\"+(_vm._ssrAttr(\"id\",'p5Canvas_' + message.id_message))+\" class=\\\"canvas-area\\\" style=\\\"display:block;width: 100%;height:auto\\\" data-v-54621e73></div></div> <div class=\\\"item-tools\\\" data-v-54621e73><div data-v-54621e73><button class=\\\"getPoster\\\" data-v-54621e73><a\"+(_vm._ssrAttr(\"href\",'/poster?id=' + message.id_message))+\" data-v-54621e73>Créer un poster</a></button></div> <div data-v-54621e73><button data-v-54621e73>Modifier la font</button></div> <div data-v-54621e73><button data-v-54621e73>Supprimer</button></div></div></div>\")])})],2)])],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./typotheque.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./typotheque.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./typotheque.vue?vue&type=template&id=54621e73&scoped=true&\"\nimport script from \"./typotheque.vue?vue&type=script&lang=js&\"\nexport * from \"./typotheque.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"54621e73\",\n  \"2abaa23e\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA,6CAOA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhBA;AAkBA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvBA;AAwBA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAYA;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAEA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAGA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AA5OA;AA7DA;;;;;;;;;;;;;ACpEA;AACA;AACA;;;;;;;;ACFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}