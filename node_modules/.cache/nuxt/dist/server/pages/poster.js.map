{"version":3,"file":"pages/poster.js","sources":["webpack:///./pages/poster.vue?c978","webpack:///./pages/poster.vue","webpack:///./pages/poster.vue?9224","webpack:///./pages/poster.vue?7167"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_vm._ssrNode(\"<div class=\\\"content\\\" data-v-6c4d59ec>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-left\\\" data-v-6c4d59ec>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"logo\\\" data-v-6c4d59ec>\",\"</div>\",[_c('nuxt-link',{attrs:{\"to\":\"/\"}},[_c('svg',{attrs:{\"id\":\"Calque_1\",\"data-name\":\"Calque 1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 776.86 861.5\"}},[_c('path',{attrs:{\"d\":\"M291.29,701.18c0,92.18,68.41,131,165.81,131,112.47,0,162.9-51,162.9-163.49V558.56H444.92C360.86,558.56,291.29,614.22,291.29,701.18ZM151.57,725.53c0-113,68.41-197.69,176.24-208.13V490.15c-84.06-10.43-146.67-87-146.67-179.14,0-133.34,130.44-215.66,280-215.66C622.9,95.35,740,173,747,332.46H611.89c-7-80-60.87-117.1-149-117.1-83.48,0-141.45,38.84-141.45,114.78s55.65,117.11,139.14,117.11H928.43V558.56H755.08c0,266.11-3.47,265,5.8,273.64,8.12,7.54,11.6,5.22,167.55,5.22V945.25c-207.55,0-224.94,5.8-263.21-34.2-22.61-23.77-21.45-74.79-21.45-74.79H622.9c-34.78,86.38-107.83,120.59-203.49,120.59C265.2,956.85,151.57,877.42,151.57,725.53Z\",\"transform\":\"translate(-151.57 -95.35)\"}})])])],1),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"tools\\\" data-v-6c4d59ec>\",\"</div>\",[_vm._ssrNode(\"<div\"+(_vm._ssrClass(\"tools-content\",{ open: _vm.isTools }))+\" data-v-6c4d59ec>\",\"</div>\",[_vm._ssrNode(\"<div data-v-6c4d59ec>\",\"</div>\",[_vm._ssrNode(\"<label class=\\\"big\\\" data-v-6c4d59ec>Couleur</label> \"),_vm._ssrNode(\"<div class=\\\"zoneColorText\\\" data-v-6c4d59ec>\",\"</div>\",[_c('color-picker',{on:{\"change\":_vm.updateColorText},model:{value:(_vm.color_text),callback:function ($$v) {_vm.color_text=$$v},expression:\"color_text\"}})],1)],2),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div data-v-6c4d59ec>\",\"</div>\",[_vm._ssrNode(\"<label class=\\\"big\\\" data-v-6c4d59ec>Fond</label> \"),_vm._ssrNode(\"<div class=\\\"zoneColorBg\\\" data-v-6c4d59ec>\",\"</div>\",[_c('color-picker',{on:{\"change\":_vm.updateColorBg},model:{value:(_vm.color_bg),callback:function ($$v) {_vm.color_bg=$$v},expression:\"color_bg\"}})],1)],2),_vm._ssrNode(\" <div data-v-6c4d59ec><label data-v-6c4d59ec>\"+_vm._ssrEscape(\"Taille de la font : \"+_vm._s(_vm.tools_font_size))+\"</label> <input type=\\\"range\\\" id=\\\"font_size\\\" min=\\\"10\\\" max=\\\"200\\\"\"+(_vm._ssrAttr(\"value\",(_vm.font_size)))+\" class=\\\"slider\\\" data-v-6c4d59ec></div> <div data-v-6c4d59ec><label data-v-6c4d59ec>\"+_vm._ssrEscape(\"Interlettrage : \"+_vm._s(_vm.tools_interlettrage))+\"</label> <input type=\\\"range\\\" id=\\\"interlettrage\\\" min=\\\"-10\\\" max=\\\"40\\\"\"+(_vm._ssrAttr(\"value\",(_vm.interlettrage)))+\" class=\\\"slider\\\" data-v-6c4d59ec></div> <div data-v-6c4d59ec><label data-v-6c4d59ec>\"+_vm._ssrEscape(\"Interlignage : \"+_vm._s(_vm.tools_interlignage))+\"</label> <input type=\\\"range\\\" id=\\\"interlignage\\\" min=\\\"10\\\" max=\\\"200\\\"\"+(_vm._ssrAttr(\"value\",(_vm.interlignage)))+\" class=\\\"slider\\\" data-v-6c4d59ec></div> <div data-v-6c4d59ec><button class=\\\"cursor-pointer toGalerie\\\" data-v-6c4d59ec>Galerie</button></div> <div data-v-6c4d59ec><button class=\\\"cursor-pointer toPoster\\\" data-v-6c4d59ec>Export JPG</button></div>\")],2)])],2),_vm._ssrNode(\" <div\"+(_vm._ssrClass(\"col-content\",{ marge: _vm.isTools }))+\" data-v-6c4d59ec><div class=\\\"col-content-list\\\" data-v-6c4d59ec><div class=\\\"item flex-col\\\" data-v-6c4d59ec><div class=\\\"block text-center w-full\\\"\"+(_vm._ssrStyle(null,null, { display: (_vm.isShowLoading) ? '' : 'none' }))+\" data-v-6c4d59ec>Chargement du poster...</div> <div id=\\\"p5Canvas_99\\\" class=\\\"canvas-area flex justify-center w-full\\\" data-v-6c4d59ec></div></div></div></div>\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from 'vuex';\nimport axios from 'axios';\nimport * as Tone from 'tone';\nimport moment from 'moment';\n\nvar P5;\n\nif (process.browser) {\n  var effet_1 = require('~/assets/js/ms1.js')\n  var effet_2 = require('~/assets/js/ms2.js')\n  var effet_3 = require('~/assets/js/ms3.js')\n}\n\nvar playerSound;\nvar bufferSound = new Array();\n\nexport default {\n\tmiddleware: 'auth',\n   computed: {\n    ...mapGetters(['isAuthenticated', 'loggedInfont']),\n  }\n  ,\n   created() {\n\t\t this.id_message = parseInt(this.$route.query.id);\n\t}\n\t,\n\tmounted() {   \n     var id = 0;\n\t localStorage.setItem('id_message', JSON.stringify(id));\n\t \n\t this.parametres = JSON.parse(localStorage.getItem('parametres') || \"[]\") ;\n\t \n\t \n\t this.getMessage();\n\t \n\t playerSound = new Tone.Player().toDestination();\n\t \n\t this.initDisplayErreur();\n\t \n\t P5 = require('p5');\n\t},\n\tdata() {\n\t    return {\n\t\t    script: null,\n\t\t\tps: null,\n\t\t\tradar:'',\n\t\t    url_server:this.$store.state.url_server,\n\t\t    id_user: this.$auth.user.id,\n\t\t    parametres:'',\n\t\t    message : [],\n\t\t    isShowLoading:true,\n\t\t    isShowNoResult:false,\n\t\t    timeoutObj:'',\n\t\t\tisTools:false,\n\t\t\tisPause:false,\n\t\t\tmyCurrentTimeSave:0,\n\t\t\tvalSetTimeout:0,\n\t\t\tindexLoad:0,\n\t\t\ttito:'',\n\t\t\tid_message:0,\n\t\t\tid_effet:1,\n\t\t\ttexte:'',\n\t\t\tcolor_text:'',\n\t\t\tcolor_bg:'',\n\t\t\tfont_size:'',\n\t\t\tinterlignage:'',\n\t\t\tinterlettrage:'',\n\t\t\tisTools:true,\n\t\t\ttimeOutTools:0,\n\t    }\n\t  \n  },\n\tmethods: {\n\t\t getMessage: function()\n\t\t {\n\t       axios.get(this.url_server + \"/getMessage?id_message=\" + this.id_message)\n\t       .then(response => {\n\t\t       this.message = response.data.liste;\n\t\t\t   if (typeof this.message.texte !== 'undefined') {\n\t\t\t\t    this.id_message = this.message.id_message;\n\t\t\t        this.id_effet = this.message.id_effet;\n\t\t\t        this.texte = this.message.texte;\n\t\t\t        this.color_text = this.message.color_text;\n\t\t\t        this.color_bg = this.message.color_bg;\n\t\t\t        this.font_size = this.message.font_size;\n\t\t\t        \n\t\t\t        this.initTools();\n\t\t\t        \n\t\t\t        console.log(\"font_size : \" + this.font_size)\n\t\t\t        this.loadMessage(true,this.id_message,this.id_effet,this.texte,this.color_text,this.color_bg,this.font_size)\n\t\t\t    }\n\t\t   })\n\t       .catch(error => {\n\t\t       this.id_message = 0;\n\t\t\t   displayErreur(\"Erreur lors du chargement du message : \" +error)\n\t      })\n\t    }\n\t    ,\n\t    initDisplayErreur: function()\n\t    {\n\t\t    hideErreur();\n\t    }\n\t    ,\n\t\tloadMessage: function(isFirst,id_message,id_effet,message,color_text,color_bg,font_size) {\n\t\t\tconsole.log(\"color_text : \" + color_text)\n\t\t\t\n\t\t\tif (!isFirst) {\n\t\t\t\tdocument.querySelector('#p5Canvas_99').removeChild(document.querySelector('canvas'));\n\t\t\t}\n\t\t\tthis.radar = this.selectEffet(id_effet);\n\t\t\t\n\t\t\tthis.ps = new P5(this.radar.main)\n\t\t\tthis.radar.setFctCanvasSize(547,910);\n\t\t    this.radar.setFctCanvasId(99)\n\t\t    this.radar.setFctSound(0)\n\t\t    this.radar.setFctTextColor(color_text)\n\t\t    this.radar.setFctBgColor(color_bg)\n\t\t    this.radar.setFctFontSize(font_size)\n    \n\t\t\tthis.radar.setFctTexte(message,0);\n\t\t\t\n\t\t\tthis.isShowLoading = false;\n\t\t\tdocument.querySelector('.canvas-area').classList.remove(\"hidden\");\n\t\t}\n\t\t,\n\t\tselectEffet: function(id_effet)\n\t\t{\n\t\t\tif (id_effet == 1) this.radar = effet_1;\n\t\t\tif (id_effet == 2) this.radar = effet_2;\n\t\t\tif (id_effet == 3) this.radar = effet_3;\n\t\t\t\n\t\t\treturn this.radar;\n\t\t}\n\t\t,\n\t    updateColorText: function() {\n\t\t    clearTimeout(this.timeOutTools);\n\t\t    this.timeOutTools = setTimeout(function () {  \n\t\t\t    this.updateColorPicker(true);\n\t\t    }.bind(this), 100)\n\t    }\n\t    ,\n\t    updateColorBg: function() {\n\t\t    clearTimeout(this.timeOutTools);\n\t\t    this.timeOutTools = setTimeout(function () {  \n\t\t\t    this.updateColorPicker(true);\n\t\t    }.bind(this), 100)\n\t    }\n\t    ,\n\t    updateColorPicker: function(isRadar) {\n\t\t    if (isRadar) {\n\t\t\t    this.loadMessage(false,this.id_message,this.id_effet,this.texte,this.color_text,this.color_bg,this.font_size)\n\t\t\t    /*this.radar.setFctTextColor(this.color_text)\n\t\t\t\tthis.radar.setFctBgColor(this.color_bg)\n\t\t\t\tthis.radar.setFctRedraw(this.color_text);*/\n\t\t\t\t//this.startP5()\n\t\t\t\t//this.stopP5()\n\t\t    }\n\t\t    \n\t\t    document.querySelector('.zoneColorText .color-block .value').innerHTML = this.color_text;\n\t\t    document.querySelector('.zoneColorBg .color-block .value').innerHTML = this.color_bg;\n\t    }\n\t    ,\n\t    initTools: function() {\n\t\t    this.updateColorPicker(false);\n\t\t}\n\t\t,\n\t\tstartP5: function() {\n\t\t\tthis.radar.startLoopP5();\n\t\t},\n\t\tstopP5: function() {\n\t\t\tthis.radar.stopLoopP5();\n\t\t},\n\t\texportPoster: function() {\n\t\t\tthis.radar.setFctSave();\n\t    \t\n\t    }\n\t    ,\n\t\texportGalerie: function() {\n\t\t\tisAction('Exportation du poster en cours...',false);\n\t\t\t\n\t\t\tvar el = document.querySelector(\".toGalerie\");\n\t\t\tel.classList.add(\"cursornotallowed\");\n\t\t\tel.disabled = true;\n\t\n\t\t\tvar canvas = document.getElementById(\"defaultCanvas0\");\n\t\t\tvar dataURL = canvas.toDataURL(\"image/png\");\n\t\t\tconsole.log(dataURL)\n\t\t\t\n\t\t\t//var base64 = this.resultSound;\n\t\t\tlet formData = new FormData();\n\t\t\tformData.append('poster', dataURL) ;\n\t\t\tformData.append('id_message', this.id_message) ;\n\t\t\t\n\t\t\tconst timeOutTools = setTimeout(() => {\n\t\t\taxios.post(this.url_server + '/addPoster',\n\t\t\t    formData,\n\t\t\t    {\n\t\t\t      headers: {\n\t\t\t          'Content-Type': 'multipart/form-data'\n\t\t\t      },\n\t\t\t      onUploadProgress: function( progressEvent ) {\n\t\t\t\t      \n\t\t\t\t      //var val = parseInt( Math.round((progressEvent.loaded*100) / progressEvent.total ));\n\t\t\t\t      //document.querySelector('.progress-alert').style.width = val + \"px\";\n\t\t\t\t      //console.log(\"progress : \" + val)\n\t\t\t      }.bind(this)\n\t\t\t    }\n\t\t\t  )\n\t\t\t  .then(response => {\n\t\t\t  \t   //document.querySelector('.progress-alert').style.width = \"0px\";\t\n\t\t\t       //this.id_message = response.data.id_message;\n\t\t\t       \n\t\t\t       var el = document.querySelector(\".toGalerie\");\n\t\t\t\t\tel.classList.remove(\"cursornotallowed\");\n\t\t\t\t\tel.disabled = false;\n\t\t\t\t\tisAction('',false);\n\t\t\t       displayErreur('Votre poster a été sauvegardé dans la galerie');\n\t\t      })\n\t\t      .catch(err => {\n\t\t\t      if (typeof err.response.data.message === 'undefined') displayErreur(err.response.data.message)\n\t\t\t      else displayErreur(err.response.data.message)\n\n\t\t      })\n\t\t}, 1500);\n\t    \t\n\t    },\n\t\tgoHome: function(id_message)\n\t\t{\n\t\t\tlocalStorage.setItem('id_message', JSON.stringify(id_message));\n\t\t\tdocument.location = '/'\n\t\t}\n\t    \t\t\n\t}\n}\n\n\n\n\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./poster.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./poster.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./poster.vue?vue&type=template&id=6c4d59ec&scoped=true&\"\nimport script from \"./poster.vue?vue&type=script&lang=js&\"\nexport * from \"./poster.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"6c4d59ec\",\n  \"4654d9d2\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;;;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA,6CAIA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AAEA;AAEA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1BA;AA6BA;AACA;AAAA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAGA;AACA;AADA;AAGA;AAGA;AACA;AACA;AATA;AAaA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AAEA;AACA;AAEA;AACA;AACA;AA9JA;AAxDA;;ACzEA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}