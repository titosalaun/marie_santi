{"version":3,"file":"pages/galerie.js","sources":["webpack:///./pages/galerie.vue","webpack:///./pages/galerie.vue?3714","webpack:///./pages/galerie.vue?b7da","webpack:///./pages/galerie.vue?94c4"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from 'vuex';\nimport axios from 'axios';\nimport * as Tone from 'tone';\nimport moment from 'moment';\n\nvar playerSound;\nvar bufferSound = new Array();\n\nexport default {\n\tmiddleware: 'auth',\n   computed: {\n    ...mapGetters(['isAuthenticated', 'loggedInfont']),\n  },\n\tmounted() {   \n\t\t\n\t\tvar id = 0;\n\t localStorage.setItem('id_message', JSON.stringify(id));\n\n\t this.parametres = JSON.parse(localStorage.getItem('parametres') || \"[]\") ;\n\t this.getGalerie();\n\t \n\t playerSound = new Tone.Player().toDestination();\n\t \n\t this.initDisplayErreur();\n\t},\n\tdata() {\n\t    return {\n\t\t    url_server:this.$store.state.url_server,\n\t\t    id_user: this.$auth.user.id,\n\t\t    parametres:'',\n\t\t    messages : [],\n\t\t    isShowLoading:true,\n\t\t    isShowNoResult:false,\n\t\t    timeoutObj:'',\n\t\t\tisTools:false,\n\t\t\tisPause:false,\n\t\t\tmyCurrentTimeSave:0,\n\t\t\tvalSetTimeout:0,\n\t    }\n\t  },\n\tmethods: {\n\t\t getGalerie: function()\n\t\t {\n\t       axios.get(this.url_server + \"/getGalerie\")\n\t       .then(response => {\n\t\t       this.isShowLoading = false;\n\t\t       this.messages = response.data.liste;\n\t\t       if (this.messages.length == 0) this.isShowNoResult = true;\n\t\t   })\n\t       .catch(error => displayErreur('Erreur lors du chargement de la galerie'))\n\t    }\n\t\t,\n\t\tasync logout() {\n\t      await this.$auth.logout();\n\t      this.$router.push('/login')\n\t    }\n\t    ,\n\t\tloadSound(file, id, index)\n\t\t{\n\t\t\tconsole.log(\"debut\")\n\t\t\t\n\t\t\t//file = convertSound(file);\n\t\t\tconsole.log(\"blob : \" + file)\n\t\t\t//var blobUrl = URL.createObjectURL(file);\n\t\t\t\n\t\t\tbufferSound[index] = new Tone.ToneAudioBuffer({\n\t\t\t\tonload: () => {\n\t\t\t\t\tdocument.querySelector('#' + id + ' .duration').innerHTML = this.convertSoundDuration(bufferSound[index].duration);\n\t\t\t\t\tdocument.querySelector('#' + id + ' .content-play').classList.remove('isLoading');\n\t\t\t\t},\n\t\t\t\tonerror: () => {\n\t\t\t\t\tdocument.querySelector('#' + id + ' .duration').innerHTML = \"no sound\";\n\t\t\t\t},\n\t\t\t\treverse: false,\n\t\t\t\turl: file,\n\t\t\t});\n\t\t\t\n\t\t\t/*bufferSound[index] = new Tone.ToneAudioBuffer(file, ( ) => {\n\n\t\t\t\tconsole.log(\"in : \" + id)\n\t\t\t\tdocument.querySelector('#' + id + ' .duration').innerHTML = this.convertSoundDuration(bufferSound[index].duration);\n\t\t\t\tdocument.querySelector('#' + id + ' .content-play').classList.remove('isLoading');\n\t\t\t});*/\n\t\t\t\n\t\t\t\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\t\t}\n\t    ,\n\t    onload()\n\t    {\n\t\t    console.log(\"ONLOAD\")\n\t    }\n\t    ,\n\t\tplaySound(file,id,index)  \n\t\t{\n\t\t\tif (!document.querySelector('#' + id + ' .content-play').classList.contains('isLoading')) {\n\t\t\t\t\n\t\t\t\tif (this.isPlayingSound == index) {\n\t\t\t\t\tthis.stopSound();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (this.isPlayingSound != -1) {\n\t\t\t\t\t\tclearTimeout(this.valSetTimeout);\n\t\t\t\t\t\tthis.stopSound();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.initAllSound();\n\t\t\t\t\t\n\t\t\t\t\tTone.Transport.start();\n\t\t\t\t\tthis.myCurrentTime = new Tone.TransportTime();\n\t\t\t\t\t\n\t\t\t\t\tthis.isPlayingSound = index;\n\t\t\t\t\tthis.progressValTotal = bufferSound[index].duration;\n\t\t\t\t\tplayerSound.buffer = bufferSound[index];\n\t\t\t\t\tplayerSound.start();\n\t\t\t\t\tplayerSound.onstop = () => {\n\t\t\t\t\t    this.stopSound();\n\t\t\t\t\t  };\n\t\t\t\t\tthis.playSoundProgress(id);\n\t\t\t\t\tconsole.log(\"TITO1\")\n\t\t\t\t\t//document.querySelector('#' + id + ' .player img').setAttribute(\"src\",\"/img/pause.png\");\n\t\t\t\t\tdocument.querySelector('#' + id + ' .ctrlPlay').classList.add(\"hide\");\n\t\t\t\t\tdocument.querySelector('#' + id + ' .ctrlPause').classList.remove(\"hide\");\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t,\n\t\tinitAllSound()\n\t\t{\n\t\t\tdocument.querySelectorAll('.progress-play').forEach(el => el.style.width = '0px');\n\t\t\tdocument.querySelectorAll('.ctrlPlay').forEach(el => el.classList.remove(\"hide\"));\n\t\t\tdocument.querySelectorAll('.ctrlPause').forEach(el => el.classList.add(\"hide\"));\n\t\t}\n\t\t,\n\t\tpauseSound(id)  \n\t\t{\n\t\t\t//Tone.Transport.stop();\n\t\t\tclearInterval(this.valSetInterval);\t\t\n\t\t\tplayerSound.stop();\t\t\n\t\t\t\n\t\t\t\n\t\t\tthis.myCurrentTimeSave = this.myCurrentTime;\n\t\t\tconsole.log(\"PAUSE : \" + this.myCurrentTimeSave)\n\t\t\t//document.querySelector('#' + id + ' .player img').setAttribute(\"src\",\"/img/play.svg\");\n\t\t\tdocument.querySelector('#' + id + ' .ctrlPlay').classList.remove(\"hide\");\n\t\t\tdocument.querySelector('#' + id + ' .ctrlPause').classList.add(\"hide\");\n\t\t\t//Tone.Transport.stop();\n\t\t\t//this.myCurrentTime = 0;\n\t\t}\n\t\t,\n\t\tstopSound()  \n\t\t{\n\t\t\t//Tone.stop();\n\t\t\tconsole.log(\"STOP\")\n\t\t\tthis.isPlayingSound = -1;\n\t\t\tthis.progressValTotal = 0;\n\t\t\tclearInterval(this.valSetInterval);\n\t\t\tthis.initAllSound();\n\t\t\tplayerSound.stop();\t\t\n\t\t\tTone.Transport.stop();\n\t\t\tthis.myCurrentTime = 0;\n\t\t}\n\t\t,\n\t\tplaySoundProgress(id)  \n\t\t{\n\t\t\tconsole.log(this.myCurrentTime + ' / ' + this.progressValTotal)\n\t\t\tvar val_progress = Math.round((this.myCurrentTime*100) / this.progressValTotal )\n\t\t\tif ((this.isPlayingSound != -1) && (val_progress <= 101)) {\t\t\n\t\t\t\tdocument.querySelector('#' + id + ' .progress-play').style.width = val_progress + '%';\n\t\t\t\t\n\t\t\t\tthis.valSetInterval = setTimeout(function () { if (this.isPlayingSound != -1) this.playSoundProgress(id) }.bind(this), 200);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tclearTimeout(this.valSetInterval);\n\t\t\t\tTone.Transport.stop();\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t,\n\t\tconvertSoundDuration(sec)\n\t\t{\n\t\t\tvar val = (sec / 60).toFixed(2);\n\t\t\treturn val.toString().replace(\".\",\":\")\n\t\t}\n\t\t,\n\t\tconvertSound(data) {\n\t\t\tlet binary = convertURIToBinary(data);\n\t\t\tlet blob = new Blob([binary], {\n\t\t\t  type: 'audio/ogg'\n\t\t\t});\n\t\t\tlet blobUrl = URL.createObjectURL(blob);\n\t\t\t\n\t\t\treturn blobUrl;\n\t\t}\n\t\t,\n\t    initDisplayErreur: function()\n\t    {\n\t\t    hideErreur();\n\t    }\n\t    ,\n\t    getRandomNumber(min,max){\n\t\t    return Math.floor(Math.random()*(max-min+1)+min);\n\t\t}\n\t\t,\n\t    delPoster: function(id_message)\n\t\t {\n\t       axios.get(this.url_server + \"/delPoster?id_message=\" + id_message)\n\t       .then(response => {\n\t\t       this.isShowLoading = true;\n\t\t       this.isShowNoResult = false;\n\t\t       this.messages = new Array();\n\t\t       this.getGalerie();\n\t\t   })\n\t       .catch(error => displayErreur('Erreur lors de la suppression du poster'))\n\t    }\n\t    \t\t\n\t}\n}\n\n\n\n\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\",staticStyle:{\"background-color\":\"#383838\"}},[_vm._ssrNode(\"<div class=\\\"content\\\" data-v-c41ec1b0>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-left\\\" data-v-c41ec1b0>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"logo\\\" data-v-c41ec1b0>\",\"</div>\",[_c('nuxt-link',{attrs:{\"to\":\"/\"}},[_c('svg',{attrs:{\"id\":\"Calque_1\",\"data-name\":\"Calque 1\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 776.86 861.5\"}},[_c('path',{attrs:{\"d\":\"M291.29,701.18c0,92.18,68.41,131,165.81,131,112.47,0,162.9-51,162.9-163.49V558.56H444.92C360.86,558.56,291.29,614.22,291.29,701.18ZM151.57,725.53c0-113,68.41-197.69,176.24-208.13V490.15c-84.06-10.43-146.67-87-146.67-179.14,0-133.34,130.44-215.66,280-215.66C622.9,95.35,740,173,747,332.46H611.89c-7-80-60.87-117.1-149-117.1-83.48,0-141.45,38.84-141.45,114.78s55.65,117.11,139.14,117.11H928.43V558.56H755.08c0,266.11-3.47,265,5.8,273.64,8.12,7.54,11.6,5.22,167.55,5.22V945.25c-207.55,0-224.94,5.8-263.21-34.2-22.61-23.77-21.45-74.79-21.45-74.79H622.9c-34.78,86.38-107.83,120.59-203.49,120.59C265.2,956.85,151.57,877.42,151.57,725.53Z\",\"transform\":\"translate(-151.57 -95.35)\"}})])])],1),_vm._ssrNode(\" <div class=\\\"tools hidePara\\\" data-v-c41ec1b0><div\"+(_vm._ssrClass(\"tools-content\",{ open: _vm.isTools }))+\" data-v-c41ec1b0></div> <div class=\\\"tools-nav\\\" data-v-c41ec1b0>Paramètres</div></div>\")],2),_vm._ssrNode(\" <div\"+(_vm._ssrClass(\"col-content\",{ marge: _vm.isTools }))+\" data-v-c41ec1b0><div class=\\\"col-content-list galerie\\\" data-v-c41ec1b0>\"+((!_vm.messages.length)?(\"<div data-v-c41ec1b0><div\"+(_vm._ssrStyle(null,null, { display: (_vm.isShowLoading) ? '' : 'none' }))+\" data-v-c41ec1b0>Chargement de la galerie...</div> <div\"+(_vm._ssrStyle(null,null, { display: (_vm.isShowNoResult) ? '' : 'none' }))+\" data-v-c41ec1b0>aucun élément enregistré</div></div>\"):\"<!---->\")+\" \"+(_vm._ssrList((_vm.messages),function(message,indexMessage){return (\"<div class=\\\"item-galerie\\\" data-v-c41ec1b0><div data-v-c41ec1b0><img\"+(_vm._ssrAttr(\"src\",'/upload/poster_' + message.id_message + '.png'))+\" alt=\\\"poster\\\" data-v-c41ec1b0></div> <div class=\\\"item-galerie-tools\\\" data-v-c41ec1b0><div data-v-c41ec1b0><button class=\\\"cursor-pointer toPoster\\\" data-v-c41ec1b0>  Modifier  </button></div> <div data-v-c41ec1b0><button class=\\\"cursor-pointer toPoster\\\" data-v-c41ec1b0>Supprimer</button></div></div></div>\")}))+\"</div></div> <div class=\\\"col-right\\\" data-v-c41ec1b0></div>\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./galerie.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./galerie.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./galerie.vue?vue&type=template&id=c41ec1b0&scoped=true&\"\nimport script from \"./galerie.vue?vue&type=script&lang=js&\"\nexport * from \"./galerie.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"c41ec1b0\",\n  \"b60d2bfe\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;AAaA;AACA;AAAA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAYA;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAEA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAnLA;AAhCA;;;;;;;;;;;;;AC3DA;AACA;AACA;;;;;;;;ACFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}