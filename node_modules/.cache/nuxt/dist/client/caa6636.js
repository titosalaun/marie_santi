(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{447:function(t,e,n){!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(object,t){return Object.prototype.hasOwnProperty.call(object,t)},n.p="",n(n.s=40)}([function(t,e,n){var r;r=function(){"use strict";function a(t,e){this.isUndef(t)||1===t?this.input=this.context.createGain():1<t&&(this.input=new Array(t)),this.isUndef(e)||1===e?this.output=this.context.createGain():1<e&&(this.output=new Array(t))}var t;return a.prototype.set=function(t,e,n){if(this.isObject(t))n=e;else if(this.isString(t)){var r={};r[t]=e,t=r}t:for(var i in t){e=t[i];var o=this;if(-1!==i.indexOf(".")){for(var s=i.split("."),u=0;u<s.length-1;u++)if((o=o[s[u]])instanceof a){s.splice(0,u+1);var p=s.join(".");o.set(p,e);continue t}i=s[s.length-1]}var c=o[i];this.isUndef(c)||(a.Signal&&c instanceof a.Signal||a.Param&&c instanceof a.Param?c.value!==e&&(this.isUndef(n)?c.value=e:c.rampTo(e,n)):c instanceof AudioParam?c.value!==e&&(c.value=e):c instanceof a?c.set(e):c!==e&&(o[i]=e))}return this},a.prototype.get=function(t){this.isUndef(t)?t=this._collectDefaults(this.constructor):this.isString(t)&&(t=[t]);for(var e={},n=0;n<t.length;n++){var r=t[n],i=this,o=e;if(-1!==r.indexOf(".")){for(var s=r.split("."),u=0;u<s.length-1;u++){var p=s[u];o[p]=o[p]||{},o=o[p],i=i[p]}r=s[s.length-1]}var c=i[r];this.isObject(t[r])?o[r]=c.get():a.Signal&&c instanceof a.Signal||a.Param&&c instanceof a.Param||c instanceof AudioParam?o[r]=c.value:c instanceof a?o[r]=c.get():this.isFunction(c)||this.isUndef(c)||(o[r]=c)}return e},a.prototype._collectDefaults=function(t){var e=[];if(this.isUndef(t.defaults)||(e=Object.keys(t.defaults)),!this.isUndef(t._super))for(var n=this._collectDefaults(t._super),r=0;r<n.length;r++)-1===e.indexOf(n[r])&&e.push(n[r]);return e},a.prototype.toString=function(){for(var t in a){var e=t[0].match(/^[A-Z]$/),n=a[t]===this.constructor;if(this.isFunction(a[t])&&e&&n)return t}return"Tone"},Object.defineProperty(a.prototype,"numberOfInputs",{get:function(){return this.input?this.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(a.prototype,"numberOfOutputs",{get:function(){return this.output?this.isArray(this.output)?this.output.length:1:0}}),a.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this},a.prototype.connect=function(t,e,n){return Array.isArray(this.output)?(e=this.defaultArg(e,0),this.output[e].connect(t,0,n)):this.output.connect(t,e,n),this},a.prototype.disconnect=function(t,e,n){this.isArray(this.output)?this.isNumber(t)?this.output[t].disconnect():(e=this.defaultArg(e,0),this.output[e].disconnect(t,0,n)):this.output.disconnect.apply(this.output,arguments)},a.prototype.connectSeries=function(){if(1<arguments.length)for(var t=arguments[0],e=1;e<arguments.length;e++){var n=arguments[e];t.connect(n),t=n}return this},a.prototype.chain=function(){if(0<arguments.length)for(var t=this,e=0;e<arguments.length;e++){var n=arguments[e];t.connect(n),t=n}return this},a.prototype.fan=function(){if(0<arguments.length)for(var t=0;t<arguments.length;t++)this.connect(arguments[t]);return this},AudioNode.prototype.chain=a.prototype.chain,AudioNode.prototype.fan=a.prototype.fan,a.prototype.defaultArg=function(t,e){if(this.isObject(t)&&this.isObject(e)){var n={};for(var r in t)n[r]=this.defaultArg(e[r],t[r]);for(var i in e)n[i]=this.defaultArg(t[i],e[i]);return n}return this.isUndef(t)?e:t},a.prototype.optionsObject=function(t,e,n){var r={};if(1===t.length&&this.isObject(t[0]))r=t[0];else for(var i=0;i<e.length;i++)r[e[i]]=t[i];return this.isUndef(n)?r:this.defaultArg(r,n)},a.prototype.isUndef=function(t){return void 0===t},a.prototype.isFunction=function(t){return"function"==typeof t},a.prototype.isNumber=function(t){return"number"==typeof t},a.prototype.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object},a.prototype.isBoolean=function(t){return"boolean"==typeof t},a.prototype.isArray=function(t){return Array.isArray(t)},a.prototype.isString=function(t){return"string"==typeof t},a.noOp=function(){},a.prototype._readOnly=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._readOnly(t[e]);else Object.defineProperty(this,t,{writable:!1,enumerable:!0})},a.prototype._writable=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._writable(t[e]);else Object.defineProperty(this,t,{writable:!0})},a.State={Started:"started",Stopped:"stopped",Paused:"paused"},a.prototype.equalPowerScale=function(t){var e=.5*Math.PI;return Math.sin(t*e)},a.prototype.dbToGain=function(t){return Math.pow(2,t/6)},a.prototype.gainToDb=function(t){return Math.log(t)/Math.LN10*20},a.prototype.intervalToFrequencyRatio=function(t){return Math.pow(2,t/12)},a.prototype.now=function(){return a.context.now()},a.now=function(){return a.context.now()},a.extend=function(t,e){function n(){}a.prototype.isUndef(e)&&(e=a),n.prototype=e.prototype,t.prototype=new n,(t.prototype.constructor=t)._super=e},Object.defineProperty(a,"context",{get:function(){return t},set:function(e){t=a.Context&&e instanceof a.Context?e:new a.Context(e),a.Context&&a.Context.emit("init",t)}}),Object.defineProperty(a.prototype,"context",{get:function(){return a.context}}),a.setContext=function(t){a.context=t},Object.defineProperty(a.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(a.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(a,"supported",{get:function(){var t=window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"),e=window.hasOwnProperty("Promise"),n=window.hasOwnProperty("Worker");return t&&e&&n}}),a.version="r10",window.TONE_SILENCE_VERSION_LOGGING||console.log("%c * Tone.js "+a.version+" * ","background: #000; color: #fff"),a}.call(e,n,e,t),void 0===r||(t.exports=r)},function(t,e,n){var r,o;r=[n(0),n(2),n(10)],void 0===(o=function(i){"use strict";return i.Multiply=function(t){this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new i.Gain,this._param=this.input[1]=this.output.gain,this._param.value=this.defaultArg(t,0)},i.extend(i.Multiply,i.Signal),i.Multiply.prototype.dispose=function(){return i.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},i.Multiply}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(6),n(9),n(18),n(10)],o=function(t){"use strict";return t.Signal=function(){var e=this.optionsObject(arguments,["value","units"],t.Signal.defaults);this.output=this._gain=this.context.createGain(),e.param=this._gain.gain,t.Param.call(this,e),this.input=this._param=this._gain.gain,this.context.getConstant(1).chain(this._gain)},t.extend(t.Signal,t.Param),t.Signal.defaults={value:0,units:t.Type.Default,convert:!0},t.Signal.prototype.connect=t.SignalBase.prototype.connect,t.Signal.prototype.dispose=function(){return t.Param.prototype.dispose.call(this),this._param=null,this._gain.disconnect(),this._gain=null,this},t.Signal}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return y}));var r=n(22),o=n.n(r),c=n(0),l=n.n(c),h=n(12);n.n(h);t.TONE_SILENCE_VERSION_LOGGING=!0;var f=new window.AudioContext;function d(){return f}function y(t,e){var n=t;return t instanceof p5.Element?n=t.elt:t instanceof Array&&t[0]instanceof p5.Element&&(n=t.map((function(t){return t.elt}))),o()(f,n,e)}l.a.setContext(f),e.a=f}).call(this,n(26))},function(t,e,n){var r,o;r=[n(0),n(2),n(10)],void 0===(o=function(i){"use strict";return i.Add=function(t){this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new i.Gain,this._param=this.input[1]=new i.Signal(t),this._param.connect(this._sum)},i.extend(i.Add,i.Signal),i.Add.prototype.dispose=function(){return i.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this._param.dispose(),this._param=null,this},i.Add}.apply(e,r))||(t.exports=o)},function(t,e){t.exports={recorderProcessor:"recorder-processor",soundFileProcessor:"sound-file-processor",amplitudeProcessor:"amplitude-processor"}},function(t,e,n){var r,o;r=[n(0),n(15)],void 0===(o=function(t){"use strict";return t.WaveShaper=function(t,e){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(t)?this.curve=t:isFinite(t)||this.isUndef(t)?this._curve=new Float32Array(this.defaultArg(t,1024)):this.isFunction(t)&&(this._curve=new Float32Array(this.defaultArg(e,1024)),this.setMap(t))},t.extend(t.WaveShaper,t.SignalBase),t.WaveShaper.prototype.setMap=function(t){for(var e=0,n=this._curve.length;e<n;e++){var s=e/(n-1)*2-1;this._curve[e]=t(s,e)}return this._shaper.curve=this._curve,this},Object.defineProperty(t.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(t){this._curve=new Float32Array(t),this._shaper.curve=this._curve}}),Object.defineProperty(t.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){if(-1===["none","2x","4x"].indexOf(t))throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=t}}),t.WaveShaper.prototype.dispose=function(){return t.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},t.WaveShaper}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(2),n(19)],o=function(t){"use strict";return t.TimelineSignal=function(){var e=this.optionsObject(arguments,["value","units"],t.Signal.defaults);this._events=new t.Timeline(10),t.Signal.apply(this,e),e.param=this._param,t.Param.call(this,e),this._initial=this._fromUnits(this._param.value)},t.extend(t.TimelineSignal,t.Param),t.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"},Object.defineProperty(t.TimelineSignal.prototype,"value",{get:function(){var t=this.now(),e=this.getValueAtTime(t);return this._toUnits(e)},set:function(t){var e=this._fromUnits(t);this._initial=e,this.cancelScheduledValues(),this._param.value=e}}),t.TimelineSignal.prototype.setValueAtTime=function(e,n){return e=this._fromUnits(e),n=this.toSeconds(n),this._events.add({type:t.TimelineSignal.Type.Set,value:e,time:n}),this._param.setValueAtTime(e,n),this},t.TimelineSignal.prototype.linearRampToValueAtTime=function(e,n){return e=this._fromUnits(e),n=this.toSeconds(n),this._events.add({type:t.TimelineSignal.Type.Linear,value:e,time:n}),this._param.linearRampToValueAtTime(e,n),this},t.TimelineSignal.prototype.exponentialRampToValueAtTime=function(e,n){n=this.toSeconds(n);var i=this._searchBefore(n);i&&0===i.value&&this.setValueAtTime(this._minOutput,i.time),e=this._fromUnits(e);var r=Math.max(e,this._minOutput);return this._events.add({type:t.TimelineSignal.Type.Exponential,value:r,time:n}),e<this._minOutput?(this._param.exponentialRampToValueAtTime(this._minOutput,n-this.sampleTime),this.setValueAtTime(0,n)):this._param.exponentialRampToValueAtTime(e,n),this},t.TimelineSignal.prototype.setTargetAtTime=function(e,n,i){return e=this._fromUnits(e),e=Math.max(this._minOutput,e),i=Math.max(this._minOutput,i),n=this.toSeconds(n),this._events.add({type:t.TimelineSignal.Type.Target,value:e,time:n,constant:i}),this._param.setTargetAtTime(e,n,i),this},t.TimelineSignal.prototype.setValueCurveAtTime=function(e,n,i,r){r=this.defaultArg(r,1);for(var a=new Array(e.length),o=0;o<a.length;o++)a[o]=this._fromUnits(e[o])*r;n=this.toSeconds(n),i=this.toSeconds(i),this._events.add({type:t.TimelineSignal.Type.Curve,value:a,time:n,duration:i}),this._param.setValueAtTime(a[0],n);for(var s=1;s<a.length;s++){var c=n+s/(a.length-1)*i;this._param.linearRampToValueAtTime(a[s],c)}return this},t.TimelineSignal.prototype.cancelScheduledValues=function(t){return t=this.toSeconds(t),this._events.cancel(t),this._param.cancelScheduledValues(t),this},t.TimelineSignal.prototype.setRampPoint=function(e){e=this.toSeconds(e);var n=this._toUnits(this.getValueAtTime(e)),i=this._searchBefore(e);if(i&&i.time===e)this.cancelScheduledValues(e+this.sampleTime);else if(i&&i.type===t.TimelineSignal.Type.Curve&&i.time+i.duration>e)this.cancelScheduledValues(e),this.linearRampToValueAtTime(n,e);else{var r=this._searchAfter(e);r&&(this.cancelScheduledValues(e),r.type===t.TimelineSignal.Type.Linear?this.linearRampToValueAtTime(n,e):r.type===t.TimelineSignal.Type.Exponential&&this.exponentialRampToValueAtTime(n,e)),this.setValueAtTime(n,e)}return this},t.TimelineSignal.prototype.linearRampToValueBetween=function(t,e,i){return this.setRampPoint(e),this.linearRampToValueAtTime(t,i),this},t.TimelineSignal.prototype.exponentialRampToValueBetween=function(t,e,i){return this.setRampPoint(e),this.exponentialRampToValueAtTime(t,i),this},t.TimelineSignal.prototype._searchBefore=function(t){return this._events.get(t)},t.TimelineSignal.prototype._searchAfter=function(t){return this._events.getAfter(t)},t.TimelineSignal.prototype.getValueAtTime=function(e){e=this.toSeconds(e);var n=this._searchAfter(e),i=this._searchBefore(e),r=this._initial;if(null===i)r=this._initial;else if(i.type===t.TimelineSignal.Type.Target){var a,o=this._events.getBefore(i.time);a=null===o?this._initial:o.value,r=this._exponentialApproach(i.time,a,i.value,i.constant,e)}else r=i.type===t.TimelineSignal.Type.Curve?this._curveInterpolate(i.time,i.value,i.duration,e):null===n?i.value:n.type===t.TimelineSignal.Type.Linear?this._linearInterpolate(i.time,i.value,n.time,n.value,e):n.type===t.TimelineSignal.Type.Exponential?this._exponentialInterpolate(i.time,i.value,n.time,n.value,e):i.value;return r},t.TimelineSignal.prototype.connect=t.SignalBase.prototype.connect,t.TimelineSignal.prototype._exponentialApproach=function(t,e,i,n,a){return i+(e-i)*Math.exp(-(a-t)/n)},t.TimelineSignal.prototype._linearInterpolate=function(t,e,i,n,a){return e+(a-t)/(i-t)*(n-e)},t.TimelineSignal.prototype._exponentialInterpolate=function(t,e,i,n,a){return(e=Math.max(this._minOutput,e))*Math.pow(n/e,(a-t)/(i-t))},t.TimelineSignal.prototype._curveInterpolate=function(t,e,i,n){var a=e.length;if(t+i<=n)return e[a-1];if(n<=t)return e[0];var r=(n-t)/i,s=Math.floor((a-1)*r),o=Math.ceil((a-1)*r),c=e[s],p=e[o];return o===s?c:this._linearInterpolate(s,c,o,p,r*(a-1))},t.TimelineSignal.prototype.dispose=function(){t.Signal.prototype.dispose.call(this),t.Param.prototype.dispose.call(this),this._events.dispose(),this._events=null},t.TimelineSignal}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(4),n(1),n(2)],void 0===(o=function(i){"use strict";return i.Scale=function(t,e){this._outputMin=this.defaultArg(t,0),this._outputMax=this.defaultArg(e,1),this._scale=this.input=new i.Multiply(1),this._add=this.output=new i.Add(0),this._scale.connect(this._add),this._setRange()},i.extend(i.Scale,i.SignalBase),Object.defineProperty(i.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(t){this._outputMin=t,this._setRange()}}),Object.defineProperty(i.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(t){this._outputMax=t,this._setRange()}}),i.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},i.Scale.prototype.dispose=function(){return i.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},i.Scale}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(16),n(30),n(31),n(12)],void 0===(o=function(t){return t.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},t.prototype.toSeconds=function(e){return this.isNumber(e)?e:this.isUndef(e)?this.now():this.isString(e)?new t.Time(e).toSeconds():e instanceof t.TimeBase?e.toSeconds():void 0},t.prototype.toFrequency=function(e){return this.isNumber(e)?e:this.isString(e)||this.isUndef(e)?new t.Frequency(e).valueOf():e instanceof t.TimeBase?e.toFrequency():void 0},t.prototype.toTicks=function(e){return this.isNumber(e)||this.isString(e)?new t.TransportTime(e).toTicks():this.isUndef(e)?t.Transport.ticks:e instanceof t.TimeBase?e.toTicks():void 0},t}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(18),n(9)],o=function(i){"use strict";return window.GainNode&&!AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),i.Gain=function(){var t=this.optionsObject(arguments,["gain","units"],i.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new i.Param({param:this._gainNode.gain,units:t.units,value:t.gain,convert:t.convert}),this._readOnly("gain")},i.extend(i.Gain),i.Gain.defaults={gain:1,convert:!0},i.Gain.prototype.dispose=function(){i.Param.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},i.prototype.createInsOuts=function(t,e){1===t?this.input=new i.Gain:1<t&&(this.input=new Array(t)),1===e?this.output=new i.Gain:1<e&&(this.output=new Array(t))},i.Gain}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(7),n(39),n(14),n(12)],o=function(t){"use strict";return t.Clock=function(){t.Emitter.call(this);var e=this.optionsObject(arguments,["callback","frequency"],t.Clock.defaults);this.callback=e.callback,this._nextTick=0,this._lastState=t.State.Stopped,this.frequency=new t.TimelineSignal(e.frequency,t.Type.Frequency),this._readOnly("frequency"),this.ticks=0,this._state=new t.TimelineState(t.State.Stopped),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},t.extend(t.Clock,t.Emitter),t.Clock.defaults={callback:t.noOp,frequency:1,lookAhead:"auto"},Object.defineProperty(t.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),t.Clock.prototype.start=function(e,n){return e=this.toSeconds(e),this._state.getValueAtTime(e)!==t.State.Started&&this._state.add({state:t.State.Started,time:e,offset:n}),this},t.Clock.prototype.stop=function(e){return e=this.toSeconds(e),this._state.cancel(e),this._state.setStateAtTime(t.State.Stopped,e),this},t.Clock.prototype.pause=function(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)===t.State.Started&&this._state.setStateAtTime(t.State.Paused,e),this},t.Clock.prototype._loop=function(){for(var e=this.now()+this.context.lookAhead+this.context.updateInterval+2*this.context.lag;e>this._nextTick&&this._state;){var n=this._state.getValueAtTime(this._nextTick);if(n!==this._lastState){this._lastState=n;var i=this._state.get(this._nextTick);n===t.State.Started?(this._nextTick=i.time,this.isUndef(i.offset)||(this.ticks=i.offset),this.emit("start",i.time,this.ticks)):n===t.State.Stopped?(this.ticks=0,this.emit("stop",i.time)):n===t.State.Paused&&this.emit("pause",i.time)}var s=this._nextTick;this.frequency&&(this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick),n===t.State.Started&&(this.callback(s),this.ticks++))}},t.Clock.prototype.getStateAtTime=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)},t.Clock.prototype.dispose=function(){t.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},t.Clock}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(14)],o=function(t){function e(e,n,r){if(e.input)Array.isArray(e.input)?(t.prototype.isUndef(r)&&(r=0),this.connect(e.input[r])):this.connect(e.input,n,r);else try{e instanceof AudioNode?i.call(this,e,n,r):i.call(this,e,n)}catch(n){throw new Error("error connecting to node: "+e+"\n"+n)}}var i,n;return!window.hasOwnProperty("AudioContext")&&window.hasOwnProperty("webkitAudioContext")&&(window.AudioContext=window.webkitAudioContext),t.Context=function(e){for(var n in t.Emitter.call(this),e=e||new window.AudioContext,this._context=e,this._context)this._defineProperty(this._context,n);this._latencyHint="interactive",this._lookAhead=.1,this._updateInterval=this._lookAhead/3,this._computedUpdateInterval=0,this._worker=this._createWorker(),this._constants={}},t.extend(t.Context,t.Emitter),t.Emitter.mixin(t.Context),t.Context.prototype._defineProperty=function(t,e){this.isUndef(this[e])&&Object.defineProperty(this,e,{get:function(){return"function"==typeof t[e]?t[e].bind(t):t[e]},set:function(n){t[e]=n}})},t.Context.prototype.now=function(){return this._context.currentTime},t.Context.prototype._createWorker=function(){window.URL=window.URL||window.webkitURL;var t=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){\ttimeoutTime = parseInt(msg.data);};function tick(){\tsetTimeout(tick, timeoutTime);\tself.postMessage('tick');}tick();"]),e=URL.createObjectURL(t),n=new Worker(e);return n.addEventListener("message",function(){this.emit("tick")}.bind(this)),n.addEventListener("message",function(){var t=this.now();if(this.isNumber(this._lastUpdate)){var e=t-this._lastUpdate;this._computedUpdateInterval=Math.max(e,.97*this._computedUpdateInterval)}this._lastUpdate=t}.bind(this)),n},t.Context.prototype.getConstant=function(t){if(this._constants[t])return this._constants[t];for(var e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0),r=0;r<n.length;r++)n[r]=t;var i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants[t]=i},Object.defineProperty(t.Context.prototype,"lag",{get:function(){var t=this._computedUpdateInterval-this._updateInterval;return Math.max(t,0)}}),Object.defineProperty(t.Context.prototype,"lookAhead",{get:function(){return this._lookAhead},set:function(t){this._lookAhead=t}}),Object.defineProperty(t.Context.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(e){this._updateInterval=Math.max(e,t.prototype.blockTime),this._worker.postMessage(Math.max(1e3*e,1))}}),Object.defineProperty(t.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(t){var e=t;if(this._latencyHint=t,this.isString(t))switch(t){case"interactive":e=.1,this._context.latencyHint=t;break;case"playback":e=.8,this._context.latencyHint=t;break;case"balanced":e=.25,this._context.latencyHint=t;break;case"fastest":e=.01}this.lookAhead=e,this.updateInterval=e/3}}),t.supported?(i=AudioNode.prototype.connect,n=AudioNode.prototype.disconnect,AudioNode.prototype.connect!==e&&(AudioNode.prototype.connect=e,AudioNode.prototype.disconnect=function(e,r,o){if(e&&e.input&&Array.isArray(e.input))t.prototype.isUndef(o)&&(o=0),this.disconnect(e.input[o],r,o);else if(e&&e.input)this.disconnect(e.input,r,o);else try{n.apply(this,arguments)}catch(r){throw new Error("error disconnecting node: "+e+"\n"+r)}}),t.context=new t.Context):console.warn("This browser does not support Tone.js"),t.Context}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(4),n(20),n(2),n(10)],void 0===(o=function(t){"use strict";return t.Subtract=function(e){this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new t.Gain,this._neg=new t.Negate,this._param=this.input[1]=new t.Signal(e),this._param.chain(this._neg,this._sum)},t.extend(t.Subtract,t.Signal),t.Subtract.prototype.dispose=function(){return t.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._param.dispose(),this._param=null,this},t.Subtract}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0)],o=function(t){"use strict";return t.Emitter=function(){this._events={}},t.extend(t.Emitter),t.Emitter.prototype.on=function(t,e){for(var i=t.split(/\W+/),n=0;n<i.length;n++){var r=i[n];this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(e)}return this},t.Emitter.prototype.off=function(e,n){for(var i=e.split(/\W+/),r=0;r<i.length;r++)if(e=i[r],this._events.hasOwnProperty(e))if(t.prototype.isUndef(n))this._events[e]=[];else for(var o=this._events[e],s=0;s<o.length;s++)o[s]===n&&o.splice(s,1);return this},t.Emitter.prototype.emit=function(t){if(this._events){var e=Array.apply(null,arguments).slice(1);if(this._events.hasOwnProperty(t))for(var i=this._events[t],n=0,r=i.length;n<r;n++)i[n].apply(this,e)}return this},t.Emitter.mixin=function(e){var n=["on","off","emit"];e._events={};for(var i=0;i<n.length;i++){var r=n[i],o=t.Emitter.prototype[r];e[r]=o}},t.Emitter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._events=null,this},t.Emitter}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){var r,o;r=[n(0)],void 0===(o=function(t){"use strict";return t.SignalBase=function(){},t.extend(t.SignalBase),t.SignalBase.prototype.connect=function(e,n,a){return t.Signal&&t.Signal===e.constructor||t.Param&&t.Param===e.constructor||t.TimelineSignal&&t.TimelineSignal===e.constructor?(e._param.cancelScheduledValues(0),e._param.value=0,e.overridden=!0):e instanceof AudioParam&&(e.cancelScheduledValues(0),e.value=0),t.prototype.connect.call(this,e,n,a),this},t.SignalBase}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(17)],void 0===(o=function(t){return t.Time=function(e,n){if(!(this instanceof t.Time))return new t.Time(e,n);this._plusNow=!1,t.TimeBase.call(this,e,n)},t.extend(t.Time,t.TimeBase),t.Time.prototype._unaryExpressions=Object.create(t.TimeBase.prototype._unaryExpressions),t.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(e){return t.Transport.nextSubdivision(e())}},t.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(t){return this._plusNow=!0,t()}},t.Time.prototype.quantize=function(t,e){return e=this.defaultArg(e,1),this._expr=function(t,e,n){return t=t(),e=e.toSeconds(),t+(Math.round(t/e)*e-t)*n}.bind(this,this._expr,new this.constructor(t),e),this},t.Time.prototype.addNow=function(){return this._plusNow=!0,this},t.Time.prototype._defaultExpr=function(){return this._plusNow=!0,this._noOp},t.Time.prototype.copy=function(e){return t.TimeBase.prototype.copy.call(this,e),this._plusNow=e._plusNow,this},t.Time.prototype.toNotation=function(){var t=this.toSeconds(),e=this._toNotationHelper(t,["1m","2n","4n","8n","16n","32n","64n","128n"]),n=this._toNotationHelper(t,["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"]);return n.split("+").length<e.split("+").length?n:e},t.Time.prototype._toNotationHelper=function(t,e){for(var n=this._notationToUnits(e[e.length-1]),r="",i=0;i<e.length;i++){var o=this._notationToUnits(e[i]),s=t/o;if(1-s%1<1e-6&&(s+=1e-6),0<(s=Math.floor(s))){if(r+=1===s?e[i]:s.toString()+"*"+e[i],(t-=s*o)<n)break;r+=" + "}}return""===r&&(r="0"),r},t.Time.prototype._notationToUnits=function(t){for(var e=this._primaryExpressions,n=[e.n,e.t,e.m],r=0;r<n.length;r++){var i=n[r],o=t.match(i.regexp);if(o)return i.method.call(this,o[1])}},t.Time.prototype.toBarsBeatsSixteenths=function(){var t=this._beatsToUnits(1),e=this.toSeconds()/t,n=Math.floor(e/this._timeSignature()),r=e%1*4;return e=Math.floor(e)%this._timeSignature(),3<(r=r.toString()).length&&(r=parseFloat(r).toFixed(3)),[n,e,r].join(":")},t.Time.prototype.toTicks=function(){var e=this._beatsToUnits(1),n=this.valueOf()/e;return Math.floor(n*t.Transport.PPQ)},t.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},t.Time.prototype.toFrequency=function(){return 1/this.toSeconds()},t.Time.prototype.toSeconds=function(){return this.valueOf()},t.Time.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},t.Time.prototype.valueOf=function(){return this._expr()+(this._plusNow?this.now():0)},t.Time}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0)],void 0===(o=function(t){return t.TimeBase=function(e,n){if(!(this instanceof t.TimeBase))return new t.TimeBase(e,n);if(this._expr=this._noOp,e instanceof t.TimeBase)this.copy(e);else if(!this.isUndef(n)||this.isNumber(e)){n=this.defaultArg(n,this._defaultUnits);var r=this._primaryExpressions[n].method;this._expr=r.bind(this,e)}else this.isString(e)?this.set(e):this.isUndef(e)&&(this._expr=this._defaultExpr())},t.extend(t.TimeBase),t.TimeBase.prototype.set=function(t){return this._expr=this._parseExprString(t),this},t.TimeBase.prototype.clone=function(){var t=new this.constructor;return t.copy(this),t},t.TimeBase.prototype.copy=function(t){var e=t._expr();return this.set(e)},t.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(t){return 1===(t=parseInt(t))?this._beatsToUnits(this._timeSignature()):this._beatsToUnits(4/t)}},t:{regexp:/^(\d+)t/i,method:function(t){return t=parseInt(t),this._beatsToUnits(8/(3*parseInt(t)))}},m:{regexp:/^(\d+)m/i,method:function(t){return this._beatsToUnits(parseInt(t)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(t){return this._ticksToUnits(parseInt(t))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(t){return this._frequencyToUnits(parseFloat(t))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,n){var r=0;return t&&"0"!==t&&(r+=this._beatsToUnits(this._timeSignature()*parseFloat(t))),e&&"0"!==e&&(r+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(r+=this._beatsToUnits(parseFloat(n)/4)),r}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(t){return this._secondsToUnits(parseFloat(t))}},samples:{regexp:/^(\d+)samples/,method:function(t){return parseInt(t)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)/,method:function(t){return this._primaryExpressions[this._defaultUnits].method.call(this,t)}}},t.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(t,e){return t()+e()}},"-":{regexp:/^\-/,precedence:2,method:function(t,e){return t()-e()}},"*":{regexp:/^\*/,precedence:1,method:function(t,e){return t()*e()}},"/":{regexp:/^\//,precedence:1,method:function(t,e){return t()/e()}}},t.TimeBase.prototype._unaryExpressions={neg:{regexp:/^\-/,method:function(t){return-t()}}},t.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}},t.TimeBase.prototype._tokenize=function(t){for(var e=-1,n=[];0<t.length;){var r=i(t=t.trim(),this);n.push(r),t=t.substr(r.value.length)}function i(t,e){for(var n=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"],r=0;r<n.length;r++){var i=e[n[r]];for(var s in i){var o=i[s],p=o.regexp,a=t.match(p);if(null!==a)return{method:o.method,precedence:o.precedence,regexp:o.regexp,value:a[0]}}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+t)}return{next:function(){return n[++e]},peek:function(){return n[e+1]}}},t.TimeBase.prototype._matchGroup=function(t,e,n){if(!this.isUndef(t))for(var r in e){var i=e[r];if(i.regexp.test(t.value)){if(this.isUndef(n))return i;if(i.precedence===n)return i}}return!1},t.TimeBase.prototype._parseBinary=function(t,e){var n;this.isUndef(e)&&(e=2),n=e<0?this._parseUnary(t):this._parseBinary(t,e-1);for(var r=t.peek();r&&this._matchGroup(r,this._binaryExpressions,e);)n=(r=t.next()).method.bind(this,n,this._parseBinary(t,e-1)),r=t.peek();return n},t.TimeBase.prototype._parseUnary=function(t){var e,n;e=t.peek();var r=this._matchGroup(e,this._unaryExpressions);return r?(e=t.next(),n=this._parseUnary(t),r.method.bind(this,n)):this._parsePrimary(t)},t.TimeBase.prototype._parsePrimary=function(t){var e,n;if(e=t.peek(),this.isUndef(e))throw new SyntaxError("Tone.TimeBase: Unexpected end of expression");if(this._matchGroup(e,this._primaryExpressions)){var r=(e=t.next()).value.match(e.regexp);return e.method.bind(this,r[1],r[2],r[3])}if(e&&"("===e.value){if(t.next(),n=this._parseBinary(t),!(e=t.next())||")"!==e.value)throw new SyntaxError("Expected )");return n}throw new SyntaxError("Tone.TimeBase: Cannot process token "+e.value)},t.TimeBase.prototype._parseExprString=function(t){this.isString(t)||(t=t.toString());var e=this._tokenize(t);return this._parseBinary(e)},t.TimeBase.prototype._noOp=function(){return 0},t.TimeBase.prototype._defaultExpr=function(){return this._noOp},t.TimeBase.prototype._defaultUnits="s",t.TimeBase.prototype._frequencyToUnits=function(t){return 1/t},t.TimeBase.prototype._beatsToUnits=function(e){return 60/t.Transport.bpm.value*e},t.TimeBase.prototype._secondsToUnits=function(t){return t},t.TimeBase.prototype._ticksToUnits=function(e){return e*(this._beatsToUnits(1)/t.Transport.PPQ)},t.TimeBase.prototype._timeSignature=function(){return t.Transport.timeSignature},t.TimeBase.prototype._pushExpr=function(e,n,r){return e instanceof t.TimeBase||(e=new this.constructor(e,r)),this._expr=this._binaryExpressions[n].method.bind(this,this._expr,e._expr),this},t.TimeBase.prototype.add=function(t,e){return this._pushExpr(t,"+",e)},t.TimeBase.prototype.sub=function(t,e){return this._pushExpr(t,"-",e)},t.TimeBase.prototype.mult=function(t,e){return this._pushExpr(t,"*",e)},t.TimeBase.prototype.div=function(t,e){return this._pushExpr(t,"/",e)},t.TimeBase.prototype.valueOf=function(){return this._expr()},t.TimeBase.prototype.dispose=function(){this._expr=null},t.TimeBase}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(9)],o=function(a){"use strict";return a.Param=function(){var t=this.optionsObject(arguments,["param","units","convert"],a.Param.defaults);this._param=this.input=t.param,this.units=t.units,this.convert=t.convert,this.overridden=!1,this._lfo=null,this.isObject(t.lfo)?this.value=t.lfo:this.isUndef(t.value)||(this.value=t.value)},a.extend(a.Param),a.Param.defaults={units:a.Type.Default,convert:!0,param:void 0},Object.defineProperty(a.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(t){if(this.isObject(t)){if(this.isUndef(a.LFO))throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.");this._lfo&&this._lfo.dispose(),this._lfo=new a.LFO(t).start(),this._lfo.connect(this.input)}else{var e=this._fromUnits(t);this._param.cancelScheduledValues(0),this._param.value=e}}}),a.Param.prototype._fromUnits=function(t){if(!this.convert&&!this.isUndef(this.convert))return t;switch(this.units){case a.Type.Time:return this.toSeconds(t);case a.Type.Frequency:return this.toFrequency(t);case a.Type.Decibels:return this.dbToGain(t);case a.Type.NormalRange:return Math.min(Math.max(t,0),1);case a.Type.AudioRange:return Math.min(Math.max(t,-1),1);case a.Type.Positive:return Math.max(t,0);default:return t}},a.Param.prototype._toUnits=function(t){return(this.convert||this.isUndef(this.convert))&&this.units===a.Type.Decibels?this.gainToDb(t):t},a.Param.prototype._minOutput=1e-5,a.Param.prototype.setValueAtTime=function(t,e){return t=this._fromUnits(t),(e=this.toSeconds(e))<=this.now()+this.blockTime?this._param.value=t:this._param.setValueAtTime(t,e),this},a.Param.prototype.setRampPoint=function(t){t=this.defaultArg(t,this.now());var e=this._param.value;return 0===e&&(e=this._minOutput),this._param.setValueAtTime(e,t),this},a.Param.prototype.linearRampToValueAtTime=function(t,e){return t=this._fromUnits(t),this._param.linearRampToValueAtTime(t,this.toSeconds(e)),this},a.Param.prototype.exponentialRampToValueAtTime=function(t,e){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),this._param.exponentialRampToValueAtTime(t,this.toSeconds(e)),this},a.Param.prototype.exponentialRampToValue=function(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialRampToValueAtTime(t,i+this.toSeconds(e)),this},a.Param.prototype.linearRampToValue=function(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.linearRampToValueAtTime(t,i+this.toSeconds(e)),this},a.Param.prototype.setTargetAtTime=function(t,e,i){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),i=Math.max(this._minOutput,i),this._param.setTargetAtTime(t,this.toSeconds(e),i),this},a.Param.prototype.setValueCurveAtTime=function(t,e,i){for(var a=0;a<t.length;a++)t[a]=this._fromUnits(t[a]);return this._param.setValueCurveAtTime(t,this.toSeconds(e),this.toSeconds(i)),this},a.Param.prototype.cancelScheduledValues=function(t){return this._param.cancelScheduledValues(this.toSeconds(t)),this},a.Param.prototype.rampTo=function(t,e,i){return e=this.defaultArg(e,0),this.units===a.Type.Frequency||this.units===a.Type.BPM||this.units===a.Type.Decibels?this.exponentialRampToValue(t,e,i):this.linearRampToValue(t,e,i),this},Object.defineProperty(a.Param.prototype,"lfo",{get:function(){return this._lfo}}),a.Param.prototype.dispose=function(){return a.prototype.dispose.call(this),this._param=null,this._lfo&&(this._lfo.dispose(),this._lfo=null),this},a.Param}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(9)],o=function(i){"use strict";return i.Timeline=function(){var t=this.optionsObject(arguments,["memory"],i.Timeline.defaults);this._timeline=[],this._toRemove=[],this._iterating=!1,this.memory=t.memory},i.extend(i.Timeline),i.Timeline.defaults={memory:1/0},Object.defineProperty(i.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),i.Timeline.prototype.add=function(t){if(this.isUndef(t.time))throw new Error("Tone.Timeline: events must have a time attribute");if(this._timeline.length){var i=this._search(t.time);this._timeline.splice(i+1,0,t)}else this._timeline.push(t);if(this.length>this.memory){var e=this.length-this.memory;this._timeline.splice(0,e)}return this},i.Timeline.prototype.remove=function(t){if(this._iterating)this._toRemove.push(t);else{var i=this._timeline.indexOf(t);-1!==i&&this._timeline.splice(i,1)}return this},i.Timeline.prototype.get=function(t){var i=this._search(t);return-1!==i?this._timeline[i]:null},i.Timeline.prototype.peek=function(){return this._timeline[0]},i.Timeline.prototype.shift=function(){return this._timeline.shift()},i.Timeline.prototype.getAfter=function(t){var i=this._search(t);return i+1<this._timeline.length?this._timeline[i+1]:null},i.Timeline.prototype.getBefore=function(t){var i=this._timeline.length;if(0<i&&this._timeline[i-1].time<t)return this._timeline[i-1];var e=this._search(t);return 0<=e-1?this._timeline[e-1]:null},i.Timeline.prototype.cancel=function(t){if(1<this._timeline.length){var i=this._search(t);if(0<=i)if(this._timeline[i].time===t){for(var e=i;0<=e&&this._timeline[e].time===t;e--)i=e;this._timeline=this._timeline.slice(0,i)}else this._timeline=this._timeline.slice(0,i+1);else this._timeline=[]}else 1===this._timeline.length&&this._timeline[0].time>=t&&(this._timeline=[]);return this},i.Timeline.prototype.cancelBefore=function(t){if(this._timeline.length){var i=this._search(t);0<=i&&(this._timeline=this._timeline.slice(i+1))}return this},i.Timeline.prototype._search=function(t){var i=0,e=this._timeline.length,n=e;if(0<e&&this._timeline[e-1].time<=t)return e-1;for(;i<n;){var r=Math.floor(i+(n-i)/2),s=this._timeline[r],o=this._timeline[r+1];if(s.time===t){for(var c=r;c<this._timeline.length;c++)this._timeline[c].time===t&&(r=c);return r}if(s.time<t&&o.time>t)return r;s.time>t?n=r:s.time<t&&(i=r+1)}return-1},i.Timeline.prototype._iterate=function(t,i,e){this._iterating=!0,i=this.defaultArg(i,0),e=this.defaultArg(e,this._timeline.length-1);for(var n=i;n<=e;n++)t(this._timeline[n]);if(this._iterating=!1,0<this._toRemove.length){for(var r=0;r<this._toRemove.length;r++){var s=this._timeline.indexOf(this._toRemove[r]);-1!==s&&this._timeline.splice(s,1)}this._toRemove=[]}},i.Timeline.prototype.forEach=function(t){return this._iterate(t),this},i.Timeline.prototype.forEachBefore=function(t,i){var e=this._search(t);return-1!==e&&this._iterate(i,0,e),this},i.Timeline.prototype.forEachAfter=function(t,i){var e=this._search(t);return this._iterate(i,e+1),this},i.Timeline.prototype.forEachFrom=function(t,i){for(var e=this._search(t);0<=e&&this._timeline[e].time>=t;)e--;return this._iterate(i,e+1),this},i.Timeline.prototype.forEachAtTime=function(i,t){var e=this._search(i);return-1!==e&&this._iterate((function(e){e.time===i&&t(e)}),0,e),this},i.Timeline.prototype.dispose=function(){i.prototype.dispose.call(this),this._timeline=null,this._toRemove=null},i.Timeline}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(1),n(2)],void 0===(o=function(t){"use strict";return t.Negate=function(){this._multiply=this.input=this.output=new t.Multiply(-1)},t.extend(t.Negate,t.SignalBase),t.Negate.prototype.dispose=function(){return t.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},t.Negate}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(2),n(1),n(6)],void 0===(o=function(t){"use strict";return t.GreaterThanZero=function(){this._thresh=this.output=new t.WaveShaper((function(t){return t<=0?0:1}),127),this._scale=this.input=new t.Multiply(1e4),this._scale.connect(this._thresh)},t.extend(t.GreaterThanZero,t.SignalBase),t.GreaterThanZero.prototype.dispose=function(){return t.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},t.GreaterThanZero}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o,c;o=[],r=function(){var t=function(t,e){this._dragged=!1,this._element=t,this._bindedMove=this._moved.bind(this),this._bindedEnd=this._ended.bind(this,e),t.addEventListener("touchstart",this._bindedEnd),t.addEventListener("touchmove",this._bindedMove),t.addEventListener("touchend",this._bindedEnd),t.addEventListener("mouseup",this._bindedEnd)};function e(t){return"running"===t.state}return t.prototype._moved=function(t){this._dragged=!0},t.prototype._ended=function(t){this._dragged||function(t){var e=t.createBuffer(1,1,t.sampleRate),n=t.createBufferSource();n.buffer=e,n.connect(t.destination),n.start(0),t.resume&&t.resume()}(t),this._dragged=!1},t.prototype.dispose=function(){this._element.removeEventListener("touchstart",this._bindedEnd),this._element.removeEventListener("touchmove",this._bindedMove),this._element.removeEventListener("touchend",this._bindedEnd),this._element.removeEventListener("mouseup",this._bindedEnd),this._bindedMove=null,this._bindedEnd=null,this._element=null},function(n,r,o){var i=new Promise((function(t){!function(t,n){e(t)?n():function r(){e(t)?n():(requestAnimationFrame(r),t.resume&&t.resume())}()}(n,t)})),c=[];return function e(n,r,i){if(Array.isArray(n)||NodeList&&n instanceof NodeList)for(var o=0;o<n.length;o++)e(n[o],r,i);else if("string"==typeof n)e(document.querySelectorAll(n),r,i);else if(n.jquery&&"function"==typeof n.toArray)e(n.toArray(),r,i);else if(Element&&n instanceof Element){var c=new t(n,i);r.push(c)}}(r=r||document.body,c,n),i.then((function(){for(var t=0;t<c.length;t++)c[t].dispose();c=null,o&&o()})),i}},void 0===(c="function"==typeof r?r.apply(e,o):r)||(t.exports=c)},function(t,e,n){var r,o;r=[n(0),n(2),n(32),n(38),n(10)],void 0===(o=function(i){"use strict";return i.CrossFade=function(t){this.createInsOuts(2,1),this.a=this.input[0]=new i.Gain,this.b=this.input[1]=new i.Gain,this.fade=new i.Signal(this.defaultArg(t,.5),i.Type.NormalRange),this._equalPowerA=new i.EqualPowerGain,this._equalPowerB=new i.EqualPowerGain,this._invert=new i.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},i.extend(i.CrossFade),i.CrossFade.prototype.dispose=function(){return i.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},i.CrossFade}.apply(e,r))||(t.exports=o)},function(t,e){!function(){var t,s=[];function p(t){var e=this,n={},i=-1;this.parameters.forEach((function(t,r){var o=s[++i]||(s[i]=new Float32Array(e.bufferSize));o.fill(t.value),n[r]=o})),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime);var r=a(t.inputBuffer),o=a(t.outputBuffer);this.instance.process([r],[o],n)}function a(t){for(var e=[],n=0;n<t.numberOfChannels;n++)e[n]=t.getChannelData(n);return e}function e(t){return t.$$processors||(t.$$processors={})}function n(t){this.$$context=t}"function"!=typeof AudioWorkletNode&&(self.AudioWorkletNode=function(n,r,o){var c=e(n)[r],l=n.createScriptProcessor(void 0,2,o&&o.outputChannelCount?o.outputChannelCount[0]:2);if(l.parameters=new Map,c.properties)for(var i=0;i<c.properties.length;i++){var s=c.properties[i],a=n.createGain().gain;a.value=s.defaultValue,l.parameters.set(s.name,a)}var u=new MessageChannel;t=u.port2;var h=new c.Processor(o||{});return t=null,l.port=u.port1,l.processor=c,l.instance=h,l.onaudioprocess=p,l},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=(n.prototype.addModule=function(n,r){var o=this;return fetch(n).then((function(t){if(!t.ok)throw Error(t.status);return t.text()})).then((function(n){var c={sampleRate:0,currentTime:0,AudioWorkletProcessor:function(){this.port=t},registerProcessor:function(t,n){e(o.$$context)[t]={realm:l,context:c,Processor:n,properties:n.parameterDescriptors||[]}}},l=new function(t,e){var n=document.createElement("iframe");n.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",e.appendChild(n);var r=n.contentWindow,o=r.document,i="var window,$hook";for(var s in r)s in t||"eval"===s||(i+=",",i+=s);for(var a in t)i+=",",i+=a,i+="=self.",i+=a;var u=o.createElement("script");u.appendChild(o.createTextNode('function $hook(self,console) {"use strict";\n        '+i+";return function() {return eval(arguments[0])}}")),o.body.appendChild(u),this.exec=r.$hook(t,console)}(c.self=c,document.documentElement);return l.exec((r&&r.transpile||String)(n)),null}))},n))}()},function(t,e){!function(){function t(param){param&&(param.setTargetAtTime||(param.setTargetAtTime=param.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=window.webkitAudioContext,"function"!=typeof AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),"function"!=typeof AudioContext.prototype.createDelay&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),"function"!=typeof AudioContext.prototype.createScriptProcessor&&(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),"function"!=typeof AudioContext.prototype.createPeriodicWave&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var e=this.internal_createGain();return t(e.gain),e},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(e){var n=e?this.internal_createDelay(e):this.internal_createDelay();return t(n.delayTime),n},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var e=this.internal_createBufferSource();return e.start?(e.internal_start=e.start,e.start=function(t,n,r){void 0!==r?e.internal_start(t||0,n,r):e.internal_start(t||0,n||0)}):e.start=function(t,e,n){e||n?this.noteGrainOn(t||0,e,n):this.noteOn(t||0)},e.stop?(e.internal_stop=e.stop,e.stop=function(t){e.internal_stop(t||0)}):e.stop=function(t){this.noteOff(t||0)},t(e.playbackRate),e},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var e=this.internal_createDynamicsCompressor();return t(e.threshold),t(e.knee),t(e.ratio),t(e.reduction),t(e.attack),t(e.release),e},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var e=this.internal_createBiquadFilter();return t(e.frequency),t(e.detune),t(e.Q),t(e.gain),e},"function"!=typeof AudioContext.prototype.createOscillator&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var e=this.internal_createOscillator();return e.start?(e.internal_start=e.start,e.start=function(t){e.internal_start(t||0)}):e.start=function(t){this.noteOn(t||0)},e.stop?(e.internal_stop=e.stop,e.stop=function(t){e.internal_stop(t||0)}):e.stop=function(t){this.noteOff(t||0)},e.setPeriodicWave||(e.setPeriodicWave=e.setWaveTable),t(e.frequency),t(e.detune),e})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext)}(window),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var n=document.createElement("audio");p5.prototype.isSupported=function(){return!!n.canPlayType};p5.prototype.isFileSupported=function(t){switch(t.toLowerCase()){case"mp3":return!!n.canPlayType&&n.canPlayType("audio/mpeg;");case"wav":return!!n.canPlayType&&n.canPlayType('audio/wav; codecs="1"');case"ogg":return!!n.canPlayType&&n.canPlayType('audio/ogg; codecs="vorbis"');case"aac":case"m4a":case"mp4":return!!n.canPlayType&&(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/aac;"));case"aif":case"aiff":return!!n.canPlayType&&n.canPlayType("audio/x-aiff;");default:return!1}}},function(t,e){var g;g=function(){return this}();try{g=g||new Function("return this")()}catch(t){"object"==typeof window&&(g=window)}t.exports=g},function(t,e,n){"use strict";n.r(e),e.default='function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they\'re available as values at compile time\nvar processorNames = {\n  "recorderProcessor": "recorder-processor",\n  "soundFileProcessor": "sound-file-processor",\n  "amplitudeProcessor": "amplitude-processor"\n};\nvar RingBuffer = {\n  "default":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: "push",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: "pull",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: "framesAvailable",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}["default"];\n\nvar RecorderProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(RecorderProcessor, _AudioWorkletProcesso);\n\n  function RecorderProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, RecorderProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RecorderProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.numOutputChannels = options.outputChannelCount || 2;\n    _this.numInputChannels = processorOptions.numInputChannels || 2;\n    _this.bufferSize = processorOptions.bufferSize || 1024;\n    _this.recording = false;\n\n    _this.clear();\n\n    _this.port.onmessage = function (event) {\n      var data = event.data;\n\n      if (data.name === \'start\') {\n        _this.record(data.duration);\n      } else if (data.name === \'stop\') {\n        _this.stop();\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(RecorderProcessor, [{\n    key: "process",\n    value: function process(inputs) {\n      if (!this.recording) {\n        return true;\n      } else if (this.sampleLimit && this.recordedSamples >= this.sampleLimit) {\n        this.stop();\n        return true;\n      }\n\n      var input = inputs[0];\n      this.inputRingBuffer.push(input);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n\n        for (var channel = 0; channel < this.numOutputChannels; ++channel) {\n          var inputChannelCopy = this.inputRingBufferArraySequence[channel].slice();\n\n          if (channel === 0) {\n            this.leftBuffers.push(inputChannelCopy);\n\n            if (this.numInputChannels === 1) {\n              this.rightBuffers.push(inputChannelCopy);\n            }\n          } else if (channel === 1 && this.numInputChannels > 1) {\n            this.rightBuffers.push(inputChannelCopy);\n          }\n        }\n\n        this.recordedSamples += this.bufferSize;\n      }\n\n      return true;\n    }\n  }, {\n    key: "record",\n    value: function record(duration) {\n      if (duration) {\n        this.sampleLimit = Math.round(duration * sampleRate);\n      }\n\n      this.recording = true;\n    }\n  }, {\n    key: "stop",\n    value: function stop() {\n      this.recording = false;\n      var buffers = this.getBuffers();\n      var leftBuffer = buffers[0].buffer;\n      var rightBuffer = buffers[1].buffer;\n      this.port.postMessage({\n        name: \'buffers\',\n        leftBuffer: leftBuffer,\n        rightBuffer: rightBuffer\n      }, [leftBuffer, rightBuffer]);\n      this.clear();\n    }\n  }, {\n    key: "getBuffers",\n    value: function getBuffers() {\n      var buffers = [];\n      buffers.push(this.mergeBuffers(this.leftBuffers));\n      buffers.push(this.mergeBuffers(this.rightBuffers));\n      return buffers;\n    }\n  }, {\n    key: "mergeBuffers",\n    value: function mergeBuffers(channelBuffer) {\n      var result = new Float32Array(this.recordedSamples);\n      var offset = 0;\n      var lng = channelBuffer.length;\n\n      for (var i = 0; i < lng; i++) {\n        var buffer = channelBuffer[i];\n        result.set(buffer, offset);\n        offset += buffer.length;\n      }\n\n      return result;\n    }\n  }, {\n    key: "clear",\n    value: function clear() {\n      var _this2 = this;\n\n      this.leftBuffers = [];\n      this.rightBuffers = [];\n      this.inputRingBuffer = new RingBuffer(this.bufferSize, this.numInputChannels);\n      this.inputRingBufferArraySequence = new Array(this.numInputChannels).fill(null).map(function () {\n        return new Float32Array(_this2.bufferSize);\n      });\n      this.recordedSamples = 0;\n      this.sampleLimit = null;\n    }\n  }]);\n\n  return RecorderProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.recorderProcessor, RecorderProcessor);'},function(t,e,n){"use strict";n.r(e),e.default='function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they\'re available as values at compile time\nvar processorNames = {\n  "recorderProcessor": "recorder-processor",\n  "soundFileProcessor": "sound-file-processor",\n  "amplitudeProcessor": "amplitude-processor"\n};\nvar RingBuffer = {\n  "default":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: "push",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: "pull",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: "framesAvailable",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}["default"];\n\nvar SoundFileProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(SoundFileProcessor, _AudioWorkletProcesso);\n\n  function SoundFileProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, SoundFileProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SoundFileProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.bufferSize = processorOptions.bufferSize || 256;\n    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, 1);\n    _this.inputRingBufferArraySequence = [new Float32Array(_this.bufferSize)];\n    return _this;\n  }\n\n  _createClass(SoundFileProcessor, [{\n    key: "process",\n    value: function process(inputs) {\n      var input = inputs[0]; // we only care about the first input channel, because that contains the position data\n\n      this.inputRingBuffer.push([input[0]]);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n        var inputChannel = this.inputRingBufferArraySequence[0];\n        var position = inputChannel[inputChannel.length - 1] || 0;\n        this.port.postMessage({\n          name: \'position\',\n          position: position\n        });\n      }\n\n      return true;\n    }\n  }]);\n\n  return SoundFileProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.soundFileProcessor, SoundFileProcessor);'},function(t,e,n){"use strict";n.r(e),e.default='function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they\'re available as values at compile time\nvar processorNames = {\n  "recorderProcessor": "recorder-processor",\n  "soundFileProcessor": "sound-file-processor",\n  "amplitudeProcessor": "amplitude-processor"\n};\nvar RingBuffer = {\n  "default":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: "push",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: "pull",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: "framesAvailable",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}["default"];\n\nvar AmplitudeProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(AmplitudeProcessor, _AudioWorkletProcesso);\n\n  function AmplitudeProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, AmplitudeProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AmplitudeProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.numOutputChannels = options.outputChannelCount || 1;\n    _this.numInputChannels = processorOptions.numInputChannels || 2;\n    _this.normalize = processorOptions.normalize || false;\n    _this.smoothing = processorOptions.smoothing || 0;\n    _this.bufferSize = processorOptions.bufferSize || 2048;\n    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, _this.numInputChannels);\n    _this.outputRingBuffer = new RingBuffer(_this.bufferSize, _this.numOutputChannels);\n    _this.inputRingBufferArraySequence = new Array(_this.numInputChannels).fill(null).map(function () {\n      return new Float32Array(_this.bufferSize);\n    });\n    _this.stereoVol = [0, 0];\n    _this.stereoVolNorm = [0, 0];\n    _this.volMax = 0.001;\n\n    _this.port.onmessage = function (event) {\n      var data = event.data;\n\n      if (data.name === \'toggleNormalize\') {\n        _this.normalize = data.normalize;\n      } else if (data.name === \'smoothing\') {\n        _this.smoothing = Math.max(0, Math.min(1, data.smoothing));\n      }\n    };\n\n    return _this;\n  } // TO DO make this stereo / dependent on # of audio channels\n\n\n  _createClass(AmplitudeProcessor, [{\n    key: "process",\n    value: function process(inputs, outputs) {\n      var input = inputs[0];\n      var output = outputs[0];\n      var smoothing = this.smoothing;\n      this.inputRingBuffer.push(input);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n\n        for (var channel = 0; channel < this.numInputChannels; ++channel) {\n          var inputBuffer = this.inputRingBufferArraySequence[channel];\n          var bufLength = inputBuffer.length;\n          var sum = 0;\n\n          for (var i = 0; i < bufLength; i++) {\n            var x = inputBuffer[i];\n\n            if (this.normalize) {\n              sum += Math.max(Math.min(x / this.volMax, 1), -1) * Math.max(Math.min(x / this.volMax, 1), -1);\n            } else {\n              sum += x * x;\n            }\n          } // ... then take the square root of the sum.\n\n\n          var rms = Math.sqrt(sum / bufLength);\n          this.stereoVol[channel] = Math.max(rms, this.stereoVol[channel] * smoothing);\n          this.volMax = Math.max(this.stereoVol[channel], this.volMax);\n        } // calculate stero normalized volume and add volume from all channels together\n\n\n        var volSum = 0;\n\n        for (var index = 0; index < this.stereoVol.length; index++) {\n          this.stereoVolNorm[index] = Math.max(Math.min(this.stereoVol[index] / this.volMax, 1), 0);\n          volSum += this.stereoVol[index];\n        } // volume is average of channels\n\n\n        var volume = volSum / this.stereoVol.length; // normalized value\n\n        var volNorm = Math.max(Math.min(volume / this.volMax, 1), 0);\n        this.port.postMessage({\n          name: \'amplitude\',\n          volume: volume,\n          volNorm: volNorm,\n          stereoVol: this.stereoVol,\n          stereoVolNorm: this.stereoVolNorm\n        }); // pass input through to output\n\n        this.outputRingBuffer.push(this.inputRingBufferArraySequence);\n      } // pull 128 frames out of the ring buffer\n      // if the ring buffer does not have enough frames, the output will be silent\n\n\n      this.outputRingBuffer.pull(output);\n      return true;\n    }\n  }]);\n\n  return AmplitudeProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.amplitudeProcessor, AmplitudeProcessor);'},function(t,e,n){var r,o;r=[n(0),n(17)],void 0===(o=function(t){t.Frequency=function(e,n){if(!(this instanceof t.Frequency))return new t.Frequency(e,n);t.TimeBase.call(this,e,n)},t.extend(t.Frequency,t.TimeBase),t.Frequency.prototype._primaryExpressions=Object.create(t.TimeBase.prototype._primaryExpressions),t.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(t){return this.midiToFrequency(t)}},t.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(t,n){var r=e[t.toLowerCase()]+12*(parseInt(n)+1);return this.midiToFrequency(r)}},t.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,n){var r=1;return t&&"0"!==t&&(r*=this._beatsToUnits(this._timeSignature()*parseFloat(t))),e&&"0"!==e&&(r*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(r*=this._beatsToUnits(parseFloat(n)/4)),r}},t.Frequency.prototype.transpose=function(t){return this._expr=function(t,e){return t()*this.intervalToFrequencyRatio(e)}.bind(this,this._expr,t),this},t.Frequency.prototype.harmonize=function(t){return this._expr=function(t,e){for(var n=t(),r=[],o=0;o<e.length;o++)r[o]=n*this.intervalToFrequencyRatio(e[o]);return r}.bind(this,this._expr,t),this},t.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.valueOf())},t.Frequency.prototype.toNote=function(){var e=this.valueOf(),n=Math.log(e/t.Frequency.A4)/Math.LN2,r=Math.round(12*n)+57,o=Math.floor(r/12);return o<0&&(r+=-12*o),i[r%12]+o.toString()},t.Frequency.prototype.toSeconds=function(){return 1/this.valueOf()},t.Frequency.prototype.toFrequency=function(){return this.valueOf()},t.Frequency.prototype.toTicks=function(){var e=this._beatsToUnits(1),n=this.valueOf()/e;return Math.floor(n*t.Transport.PPQ)},t.Frequency.prototype._frequencyToUnits=function(t){return t},t.Frequency.prototype._ticksToUnits=function(e){return 1/(60*e/(t.Transport.bpm.value*t.Transport.PPQ))},t.Frequency.prototype._beatsToUnits=function(e){return 1/t.TimeBase.prototype._beatsToUnits.call(this,e)},t.Frequency.prototype._secondsToUnits=function(t){return 1/t},t.Frequency.prototype._defaultUnits="hz";var e={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return t.Frequency.A4=440,t.Frequency.prototype.midiToFrequency=function(e){return t.Frequency.A4*Math.pow(2,(e-69)/12)},t.Frequency.prototype.frequencyToMidi=function(e){return 69+12*Math.log(e/t.Frequency.A4)/Math.LN2},t.Frequency}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(16)],void 0===(o=function(t){return t.TransportTime=function(e,n){if(!(this instanceof t.TransportTime))return new t.TransportTime(e,n);t.Time.call(this,e,n)},t.extend(t.TransportTime,t.Time),t.TransportTime.prototype._unaryExpressions=Object.create(t.Time.prototype._unaryExpressions),t.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(e){var n=this._secondsToTicks(e()),r=Math.ceil(t.Transport.ticks/n);return this._ticksToUnits(r*n)}},t.TransportTime.prototype._secondsToTicks=function(e){var n=e/this._beatsToUnits(1);return Math.round(n*t.Transport.PPQ)},t.TransportTime.prototype.valueOf=function(){return this._secondsToTicks(this._expr())+(this._plusNow?t.Transport.ticks:0)},t.TransportTime.prototype.toTicks=function(){return this.valueOf()},t.TransportTime.prototype.toSeconds=function(){return this._expr()+(this._plusNow?t.Transport.seconds:0)},t.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()},t.TransportTime}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(4),n(13),n(1),n(33),n(21),n(34),n(20),n(35),n(36),n(37)],o=function(p){"use strict";function t(t,e,n){var r=new t;return n._eval(e[0]).connect(r,0,0),n._eval(e[1]).connect(r,0,1),r}function e(t,e,n){var r=new t;return n._eval(e[0]).connect(r,0,0),r}function n(t){return t?parseFloat(t):void 0}function i(t){return t&&t.args?parseFloat(t.args):void 0}return p.Expr=function(){var t=this._replacements(Array.prototype.slice.call(arguments)),e=this._parseInputs(t);this._nodes=[],this.input=new Array(e);for(var n=0;n<e;n++)this.input[n]=this.context.createGain();var r,o=this._parseTree(t);try{r=this._eval(o)}catch(e){throw this._disposeNodes(),new Error("Tone.Expr: Could evaluate expression: "+t)}this.output=r},p.extend(p.Expr,p.SignalBase),p.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(t){return new p.Signal(n(t))}},input:{regexp:/^\$\d/,method:function(t,e){return e.input[n(t.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:e.bind(this,p.Abs)},mod:{regexp:/^mod/,method:function(t,e){var n=i(t[1]),r=new p.Modulo(n);return e._eval(t[0]).connect(r),r}},pow:{regexp:/^pow/,method:function(t,e){var n=i(t[1]),r=new p.Pow(n);return e._eval(t[0]).connect(r),r}},a2g:{regexp:/^a2g/,method:function(t,e){var n=new p.AudioToGain;return e._eval(t[0]).connect(n),n}}},binary:{"+":{regexp:/^\+/,precedence:1,method:t.bind(this,p.Add)},"-":{regexp:/^\-/,precedence:1,method:function(n,r){return 1===n.length?e(p.Negate,n,r):t(p.Subtract,n,r)}},"*":{regexp:/^\*/,precedence:0,method:t.bind(this,p.Multiply)}},unary:{"-":{regexp:/^\-/,method:e.bind(this,p.Negate)},"!":{regexp:/^\!/,method:e.bind(this,p.NOT)}}},p.Expr.prototype._parseInputs=function(t){var e=t.match(/\$\d/g),n=0;if(null!==e)for(var r=0;r<e.length;r++){var o=parseInt(e[r].substr(1))+1;n=Math.max(n,o)}return n},p.Expr.prototype._replacements=function(t){for(var e=t.shift(),n=0;n<t.length;n++)e=e.replace(/\%/i,t[n]);return e},p.Expr.prototype._tokenize=function(t){for(var e=-1,n=[];0<t.length;){var r=o(t=t.trim());n.push(r),t=t.substr(r.value.length)}function o(t){for(var e in p.Expr._Expressions){var n=p.Expr._Expressions[e];for(var r in n){var o=n[r],i=o.regexp,a=t.match(i);if(null!==a)return{type:e,value:a[0],method:o.method}}}throw new SyntaxError("Tone.Expr: Unexpected token "+t)}return{next:function(){return n[++e]},peek:function(){return n[e+1]}}},p.Expr.prototype._parseTree=function(t){var e=this._tokenize(t),a=this.isUndef.bind(this);function n(t,e){return!a(t)&&"glue"===t.type&&t.value===e}function r(t,e,n){var r=p.Expr._Expressions[e];if(!a(t))for(var o in r){var i=r[o];if(i.regexp.test(t.value)){if(a(n))return!0;if(i.precedence===n)return!0}}return!1}function i(t){var n;a(t)&&(t=5),n=t<0?function t(){var n,o;return r(n=e.peek(),"unary")?(n=e.next(),o=t(),{operator:n.value,method:n.method,args:[o]}):s()}():i(t-1);for(var o=e.peek();r(o,"binary",t);)n={operator:(o=e.next()).value,method:o.method,args:[n,i(t-1)]},o=e.peek();return n}function s(){var t,r;if(t=e.peek(),a(t))throw new SyntaxError("Tone.Expr: Unexpected termination of expression");if("func"===t.type)return function(t){var r=[];if(!n(e.next(),"("))throw new SyntaxError('Tone.Expr: Expected ( in a function call "'+t.value+'"');if(n(e.peek(),")")||(r=function(){for(var t,r=[];t=i(),!a(t)&&(r.push(t),n(e.peek(),","));)e.next();return r}()),n(e.next(),")"))return{method:t.method,args:r,name:name};throw new SyntaxError('Tone.Expr: Expected ) in a function call "'+t.value+'"')}(t=e.next());if("value"===t.type)return{method:(t=e.next()).method,args:t.value};if(n(t,"(")){if(e.next(),r=i(),!n(t=e.next(),")"))throw new SyntaxError("Expected )");return r}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+t.value)}return i()},p.Expr.prototype._eval=function(t){if(!this.isUndef(t)){var e=t.method(t.args,this);return this._nodes.push(e),e}},p.Expr.prototype._disposeNodes=function(){for(var t=0;t<this._nodes.length;t++){var e=this._nodes[t];this.isFunction(e.dispose)?e.dispose():this.isFunction(e.disconnect)&&e.disconnect(),e=null,this._nodes[t]=null}this._nodes=null},p.Expr.prototype.dispose=function(){p.prototype.dispose.call(this),this._disposeNodes()},p.Expr}.apply(e,r),void 0===o||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(21),n(13),n(2)],void 0===(o=function(t){"use strict";return t.GreaterThan=function(e){this.createInsOuts(2,0),this._param=this.input[0]=new t.Subtract(e),this.input[1]=this._param.input[1],this._gtz=this.output=new t.GreaterThanZero,this._param.connect(this._gtz)},t.extend(t.GreaterThan,t.Signal),t.GreaterThan.prototype.dispose=function(){return t.prototype.dispose.call(this),this._param.dispose(),this._param=null,this._gtz.dispose(),this._gtz=null,this},t.GreaterThan}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(6),n(15)],void 0===(o=function(s){"use strict";return s.Abs=function(){this._abs=this.input=this.output=new s.WaveShaper((function(s){return 0===s?0:Math.abs(s)}),127)},s.extend(s.Abs,s.SignalBase),s.Abs.prototype.dispose=function(){return s.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},s.Abs}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(6),n(1),n(13)],void 0===(o=function(i){"use strict";return i.Modulo=function(t){this.createInsOuts(1,0),this._shaper=new i.WaveShaper(Math.pow(2,16)),this._multiply=new i.Multiply,this._subtract=this.output=new i.Subtract,this._modSignal=new i.Signal(t),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(t)},i.extend(i.Modulo,i.SignalBase),i.Modulo.prototype._setWaveShaper=function(i){this._shaper.setMap((function(t){return Math.floor((t+1e-4)/i)}))},Object.defineProperty(i.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(t){this._modSignal.value=t,this._setWaveShaper(t)}}),i.Modulo.prototype.dispose=function(){return i.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},i.Modulo}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(6)],void 0===(o=function(t){"use strict";return t.Pow=function(e){this._exp=this.defaultArg(e,1),this._expScaler=this.input=this.output=new t.WaveShaper(this._expFunc(this._exp),8192)},t.extend(t.Pow,t.SignalBase),Object.defineProperty(t.Pow.prototype,"value",{get:function(){return this._exp},set:function(t){this._exp=t,this._expScaler.setMap(this._expFunc(this._exp))}}),t.Pow.prototype._expFunc=function(t){return function(e){return Math.pow(Math.abs(e),t)}},t.Pow.prototype.dispose=function(){return t.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},t.Pow}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(6),n(2)],void 0===(o=function(t){"use strict";return t.AudioToGain=function(){this._norm=this.input=this.output=new t.WaveShaper((function(t){return(t+1)/2}))},t.extend(t.AudioToGain,t.SignalBase),t.AudioToGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},t.AudioToGain}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(6)],void 0===(o=function(t){"use strict";return t.EqualPowerGain=function(){this._eqPower=this.input=this.output=new t.WaveShaper(function(t){return Math.abs(t)<.001?0:this.equalPowerScale(t)}.bind(this),4096)},t.extend(t.EqualPowerGain,t.SignalBase),t.EqualPowerGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},t.EqualPowerGain}.apply(e,r))||(t.exports=o)},function(t,e,n){var r,o;r=[n(0),n(19),n(9)],void 0===(o=function(t){"use strict";return t.TimelineState=function(e){t.Timeline.call(this),this._initial=e},t.extend(t.TimelineState,t.Timeline),t.TimelineState.prototype.getValueAtTime=function(t){var e=this.get(t);return null!==e?e.state:this._initial},t.TimelineState.prototype.setStateAtTime=function(t,e){this.add({state:t,time:e})},t.TimelineState}.apply(e,r))||(t.exports=o)},function(t,e,n){"use strict";n.r(e);n(24),n(25);var r=n(3);var o=new function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.input=r.a.createGain(),this.output=r.a.createGain(),this.limiter=r.a.createDynamicsCompressor(),this.limiter.threshold.value=-3,this.limiter.ratio.value=20,this.limiter.knee.value=1,this.audiocontext=r.a,this.output.disconnect(),this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=r.a.createGain(),this.fftMeter=r.a.createGain(),this.output.connect(this.meter),this.output.connect(this.fftMeter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]};p5.prototype.getOutputVolume=function(){return o.output.gain.value},p5.prototype.outputVolume=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("number"==typeof t){var r=o.audiocontext.currentTime,c=o.output.gain.value;o.output.gain.cancelScheduledValues(r+n),o.output.gain.linearRampToValueAtTime(c,r+n),o.output.gain.linearRampToValueAtTime(t,r+n+e)}else{if(!t)return o.output.gain;t.connect(o.output.gain)}},p5.prototype.soundOut=p5.soundOut=o,p5.soundOut._silentNode=o.audiocontext.createGain(),p5.soundOut._silentNode.gain.value=0,p5.soundOut._silentNode.connect(o.audiocontext.destination);var main=o,c=n(5),l=n.n(c);function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function f(t){var e=Math.log(t/440)/Math.log(2);return Math.round(12*e)+69}function d(t){return 440*Math.pow(2,(t-69)/12)}function y(t){if("string"!=typeof t)return t;var e={A:21,B:23,C:24,D:26,E:28,F:29,G:31}[t[0].toUpperCase()];switch(e+=12*(~~t.slice(-1)-1),t[1]){case"#":e+=1;break;case"b":e-=1}return d(e)}function m(t){var e,n=v(e=t.getChannelData(0),t.numberOfChannels>1?t.getChannelData(1):e),r=new window.ArrayBuffer(44+2*n.length),view=new window.DataView(r);_(view,0,"RIFF"),view.setUint32(4,36+2*n.length,!0),_(view,8,"WAVE"),_(view,12,"fmt "),view.setUint32(16,16,!0),view.setUint16(20,1,!0),view.setUint16(22,2,!0),view.setUint32(24,main.audiocontext.sampleRate,!0),view.setUint32(28,4*main.audiocontext.sampleRate,!0),view.setUint16(32,4,!0),view.setUint16(34,16,!0),_(view,36,"data"),view.setUint32(40,2*n.length,!0);for(var o=n.length,c=44,i=0;i<o;i++)view.setInt16(c,32767*n[i],!0),c+=2;return view}function v(t,e){for(var n=t.length+e.length,r=new Float32Array(n),o=0,c=0;c<n;)r[c++]=t[o],r[c++]=e[o],o++;return r}function _(view,t,e){for(var n=e.length,i=0;i<n;i++)view.setUint8(t+i,e.charCodeAt(i))}function T(t){var e=t,n=new AudioWorkletNode(main.audiocontext,l.a.soundFileProcessor);return n instanceof ScriptProcessorNode&&(e=n.bufferSize),n.disconnect(),n=null,e}var w=function(t,e,n){var r,o,c=new Error;return c.name=t,c.originalStack=c.stack+e,r=c.stack+e,c.failedPath=n,o=r.split("\n").filter((function(t){return!t.match(/(p5.|native code|globalInit)/g)})),c.stack=o.join("\n"),c},x=[n(27).default,n(28).default,n(29).default],S=main.audiocontext,k=!1;function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function O(t,e,n){return e&&A(t.prototype,e),n&&A(t,n),t}p5.prototype.registerMethod("init",(function(){if(!k){this.preload||window.preload||(this.preload=function(){}),this._incrementPreload();var t=function(){k=!0,this._decrementPreload()}.bind(this);Promise.all(x.map((function(t){var e=new Blob([t],{type:"application/javascript"}),n=URL.createObjectURL(e);return S.audioWorklet.addModule(n)}))).then(t)}}));var C,R=main.audiocontext;void 0!==R.createStereoPanner?C=function(){function t(input,output){P(this,t),this.stereoPanner=this.input=R.createStereoPanner(),input.connect(this.stereoPanner),this.stereoPanner.connect(output)}return O(t,[{key:"pan",value:function(t,e){var time=e||0,n=R.currentTime+time;this.stereoPanner.pan.linearRampToValueAtTime(t,n)}},{key:"inputChannels",value:function(){}},{key:"connect",value:function(t){this.stereoPanner.connect(t)}},{key:"disconnect",value:function(){this.stereoPanner&&this.stereoPanner.disconnect()}}]),t}():C=function(){function t(input,output,e){P(this,t),this.input=R.createGain(),input.connect(this.input),this.left=R.createGain(),this.right=R.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",e>1?(this.splitter=R.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=R.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(output)}return O(t,[{key:"pan",value:function(t,e){var time=e||0,n=R.currentTime+time,r=(t+1)/2,o=Math.cos(r*Math.PI/2),c=Math.sin(r*Math.PI/2);this.left.gain.linearRampToValueAtTime(c,n),this.right.gain.linearRampToValueAtTime(o,n)}},{key:"inputChannels",value:function(t){1===t?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):2===t&&(void 0===this.splitter&&(this.splitter=R.createChannelSplitter(2)),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))}},{key:"connect",value:function(t){this.output.connect(t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}}]),t}();var E=C;function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function j(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function B(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var M=main.audiocontext,V=function t(e,time,n,r){B(this,t),this.callback=e,this.time=time,this.id=n,this.val=r};function F(t){var e=t.target,n=this;e._playing=!1,e.removeEventListener("ended",n._clearOnEnd),n._onended(n),n.bufferSourceNodes.map((function(t,i){return i})).reverse().forEach((function(i){!1===n.bufferSourceNodes[i]._playing&&n.bufferSourceNodes.splice(i,1)})),0===n.bufferSourceNodes.length&&(n._playing=!1)}var D=function(){function t(e,n,r,o){if(B(this,t),void 0!==e){if("string"==typeof e||"string"==typeof e[0]){var path=p5.prototype._checkFileFormats(e);this.url=path}else if("object"===N(e)&&!(window.File&&window.FileReader&&window.FileList&&window.Blob))throw"Unable to load file because the File API is not supported";e.file&&(e=e.file),this.file=e}this._onended=function(){},this._looping=!1,this._playing=!1,this._paused=!1,this._pauseTime=0,this._cues=[],this._cueIDCounter=0,this._lastPos=0,this._counterNode=null,this._workletNode=null,this.bufferSourceNodes=[],this.bufferSourceNode=null,this.buffer=null,this.playbackRate=1,this.input=main.audiocontext.createGain(),this.output=main.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.pauseTime=0,this.mode="sustain",this.startMillis=null,this.panPosition=0,this.panner=new E(this.output,main.input,2),(this.url||this.file)&&this.load(n,r),main.soundArray.push(this),this._whileLoading="function"==typeof o?o:function(){},this._clearOnEnd=F.bind(this),this.amp=this.setVolume,this.fade=this.setVolume}var e,n,r;return e=t,(n=[{key:"load",value:function(t,e){var n=this,r=(new Error).stack;if(void 0!==this.url&&""!==this.url){var o=new XMLHttpRequest;o.addEventListener("progress",(function(t){n._updateProgress(t)}),!1),o.open("GET",this.url,!0),o.responseType="arraybuffer",o.onload=function(){if(200===o.status){if(!n.panner)return;M.decodeAudioData(o.response,(function(e){n.panner&&(n.buffer=e,n.panner.inputChannels(e.numberOfChannels),t&&t(n))}),(function(){if(n.panner){var t=new w("decodeAudioData",r,n.url),o="AudioContext error at decodeAudioData for "+n.url;e?(t.msg=o,e(t)):console.error(o+"\n The error stack trace includes: \n"+t.stack)}}))}else{if(!n.panner)return;var c=new w("loadSound",r,n.url),l="Unable to load "+n.url+". The request status was: "+o.status+" ("+o.statusText+")";e?(c.message=l,e(c)):console.error(l+"\n The error stack trace includes: \n"+c.stack)}},o.onerror=function(){var t=new w("loadSound",r,n.url),o="There was no response from the server at "+n.url+". Check the url and internet connectivity.";e?(t.message=o,e(t)):console.error(o+"\n The error stack trace includes: \n"+t.stack)},o.send()}else if(void 0!==this.file){var c=new FileReader;c.onload=function(){n.panner&&M.decodeAudioData(c.result,(function(e){n.panner&&(n.buffer=e,n.panner.inputChannels(e.numberOfChannels),t&&t(n))}))},c.onerror=function(t){n.panner&&onerror&&onerror(t)},c.readAsArrayBuffer(this.file)}}},{key:"_updateProgress",value:function(t){if(t.lengthComputable){var e=t.loaded/t.total*.99;this._whileLoading(e,t)}else this._whileLoading("size unknown")}},{key:"isLoaded",value:function(){return!!this.buffer}},{key:"play",value:function(t,e,n,r,o){if(this.output){var c,l,time=t||0;if(time<0&&(time=0),time+=main.audiocontext.currentTime,void 0!==e&&this.rate(e),void 0!==n&&this.setVolume(n),!this.buffer)throw"not ready to play file, buffer has yet to load. Try preload()";if(this._pauseTime=0,"restart"===this.mode&&this.buffer&&this.bufferSourceNode&&(this.bufferSourceNode.stop(time),this._counterNode.stop(time)),"untildone"!==this.mode||!this.isPlaying()){if(this.bufferSourceNode=this._initSourceNode(),delete this._counterNode,this._counterNode=this._initCounterNode(),r){if(!(r>=0&&r<this.buffer.duration))throw"start time out of range";c=r}else c=0;o&&(o=o<=this.buffer.duration-c?o:this.buffer.duration),this._paused?(this.bufferSourceNode.start(time,this.pauseTime,o),this._counterNode.start(time,this.pauseTime,o)):(this.bufferSourceNode.start(time,c,o),this._counterNode.start(time,c,o)),this._playing=!0,this._paused=!1,this.bufferSourceNodes.push(this.bufferSourceNode),this.bufferSourceNode._arrayIndex=this.bufferSourceNodes.length-1,this.bufferSourceNode.addEventListener("ended",this._clearOnEnd),this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping,!0===this._looping&&(l=o||c-1e-15,this.bufferSourceNode.loopStart=c,this.bufferSourceNode.loopEnd=l,this._counterNode.loopStart=c,this._counterNode.loopEnd=l)}}else console.warn("SoundFile.play() called after dispose")}},{key:"playMode",value:function(t){var s=t.toLowerCase();if("restart"===s&&this.buffer&&this.bufferSourceNode)for(var i=0;i<this.bufferSourceNodes.length-1;i++){var e=main.audiocontext.currentTime;this.bufferSourceNodes[i].stop(e)}if("restart"!==s&&"sustain"!==s&&"untildone"!==s)throw'Invalid play mode. Must be either "restart" or "sustain"';this.mode=s}},{key:"pause",value:function(t){var e=(t||0)+main.audiocontext.currentTime;this.isPlaying()&&this.buffer&&this.bufferSourceNode?(this._paused=!0,this._playing=!1,this.pauseTime=this.currentTime(),this.bufferSourceNode.stop(e),this._counterNode.stop(e),this._pauseTime=this.currentTime()):this._pauseTime=0}},{key:"loop",value:function(t,e,n,r,o){this._looping=!0,this.play(t,e,n,r,o)}},{key:"setLoop",value:function(t){if(!0===t)this._looping=!0;else{if(!1!==t)throw"Error: setLoop accepts either true or false";this._looping=!1}this.bufferSourceNode&&(this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping)}},{key:"isLooping",value:function(){return!!this.bufferSourceNode&&!0===this._looping&&!0===this.isPlaying()}},{key:"isPlaying",value:function(){return this._playing}},{key:"isPaused",value:function(){return this._paused}},{key:"stop",value:function(t){var time=t||0;if("sustain"===this.mode||"untildone"===this.mode)this.stopAll(time),this._playing=!1,this.pauseTime=0,this._paused=!1;else if(this.buffer&&this.bufferSourceNode){var e=main.audiocontext.currentTime,n=time||0;this.pauseTime=0,this.bufferSourceNode.stop(e+n),this._counterNode.stop(e+n),this._playing=!1,this._paused=!1}}},{key:"stopAll",value:function(t){var e=main.audiocontext.currentTime,time=t||0;if(this.buffer&&this.bufferSourceNode){for(var i in this.bufferSourceNodes){var n=this.bufferSourceNodes[i];if(n)try{n.stop(e+time)}catch(t){}}this._counterNode.stop(e+time)}}},{key:"getVolume",value:function(){return this.output.gain.value}},{key:"pan",value:function(t,e){this.panPosition=t,this.panner.pan(t,e)}},{key:"getPan",value:function(){return this.panPosition}},{key:"rate",value:function(t){var e=!1;if(void 0===t)return this.playbackRate;if(this.playbackRate=t,0===t?t=1e-13:t<0&&!this.reversed?(t=Math.abs(t),e=!0):t>0&&this.reversed&&(e=!0),this.bufferSourceNode){var n=main.audiocontext.currentTime;this.bufferSourceNode.playbackRate.cancelScheduledValues(n),this.bufferSourceNode.playbackRate.linearRampToValueAtTime(Math.abs(t),n),this._counterNode.playbackRate.cancelScheduledValues(n),this._counterNode.playbackRate.linearRampToValueAtTime(Math.abs(t),n)}return e&&this.reverseBuffer(),this.playbackRate}},{key:"setPitch",value:function(t){var e=d(t)/d(60);this.rate(e)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setVolume",value:function(t,e,n){if("number"==typeof t){var r=e||0,o=n||0,c=main.audiocontext.currentTime,l=this.output.gain.value;this.output.gain.cancelScheduledValues(c+o),this.output.gain.linearRampToValueAtTime(l,c+o),this.output.gain.linearRampToValueAtTime(t,c+o+r)}else{if(!t)return this.output.gain;t.connect(this.output.gain)}}},{key:"duration",value:function(){return this.buffer?this.buffer.duration:0}},{key:"currentTime",value:function(){return this.reversed?Math.abs(this._lastPos-this.buffer.length)/M.sampleRate:this._lastPos/M.sampleRate}},{key:"jump",value:function(t,e){if(t<0||t>this.buffer.duration)throw"jump time out of range";if(e>this.buffer.duration-t)throw"end time out of range";var n=t||0,r=e||void 0;this.isPlaying()&&(this.stop(0),this.play(0,this.playbackRate,this.output.gain.value,n,r))}},{key:"channels",value:function(){return this.buffer.numberOfChannels}},{key:"sampleRate",value:function(){return this.buffer.sampleRate}},{key:"frames",value:function(){return this.buffer.length}},{key:"getPeaks",value:function(t){if(!this.buffer)throw"Cannot load peaks yet, buffer is not loaded";if(t||(t=5*window.width),this.buffer){for(var e=this.buffer,n=e.length/t,r=~~(n/10)||1,o=e.numberOfChannels,c=new Float32Array(Math.round(t)),l=0;l<o;l++)for(var h=e.getChannelData(l),i=0;i<t;i++){for(var f=~~(i*n),d=~~(f+n),y=0,m=f;m<d;m+=r){var v=h[m];(v>y||-v>y)&&(y=v)}(0===l||Math.abs(y)>c[i])&&(c[i]=y)}return c}}},{key:"reverseBuffer",value:function(){if(!this.buffer)throw"SoundFile is not done loading";var t=this._lastPos/M.sampleRate,e=this.getVolume();this.setVolume(0,.001);for(var n=this.buffer.numberOfChannels,i=0;i<n;i++)this.buffer.getChannelData(i).reverse();this.reversed=!this.reversed,this.isPlaying()&&t&&this.jump(this.duration()-t),this.setVolume(e,.001)}},{key:"onended",value:function(t){return this._onended=t,this}},{key:"add",value:function(){}},{key:"dispose",value:function(){var t=main.audiocontext.currentTime,e=main.soundArray.indexOf(this);if(main.soundArray.splice(e,1),this.stop(t),this.buffer&&this.bufferSourceNode){for(var i=0;i<this.bufferSourceNodes.length-1;i++)if(null!==this.bufferSourceNodes[i]){this.bufferSourceNodes[i].disconnect();try{this.bufferSourceNodes[i].stop(t)}catch(t){console.warn("no buffer source node to dispose")}this.bufferSourceNodes[i]=null}if(this.isPlaying()){try{this._counterNode.stop(t)}catch(t){console.log(t)}this._counterNode=null}}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.panner.connect(t.input):this.panner.connect(t):this.panner.connect(main.input)}},{key:"disconnect",value:function(){this.panner&&this.panner.disconnect()}},{key:"getLevel",value:function(){console.warn("p5.SoundFile.getLevel has been removed from the library. Use p5.Amplitude instead")}},{key:"setPath",value:function(p,t){var path=p5.prototype._checkFileFormats(p);this.url=path,this.load(t)}},{key:"setBuffer",value:function(t){var e=t.length,n=t[0].length,r=M.createBuffer(e,n,M.sampleRate);t[0]instanceof Float32Array||(t[0]=new Float32Array(t[0]));for(var o=0;o<e;o++)r.getChannelData(o).set(t[o]);this.buffer=r,this.panner.inputChannels(e)}},{key:"_initCounterNode",value:function(){var t=this,e=this,n=M.currentTime,r=M.createBufferSource(),o=T(256);return e._workletNode&&(e._workletNode.disconnect(),delete e._workletNode),e._workletNode=new AudioWorkletNode(M,l.a.soundFileProcessor,{processorOptions:{bufferSize:o}}),e._workletNode.port.onmessage=function(n){if("position"===n.data.name){if(0===n.data.position)return;t._lastPos=n.data.position,t._onTimeUpdate(e._lastPos)}},r.buffer=function(t){for(var e=t.length,n=M.createBuffer(1,t.length,M.sampleRate),r=n.getChannelData(0),o=0;o<e;o++)r[o]=o;return n}(e.buffer),r.playbackRate.setValueAtTime(e.playbackRate,n),r.connect(e._workletNode),e._workletNode.connect(p5.soundOut._silentNode),r}},{key:"_initSourceNode",value:function(){var t=M.createBufferSource();return t.buffer=this.buffer,t.playbackRate.value=this.playbackRate,t.connect(this.output),t}},{key:"processPeaks",value:function(t,e,n,r){console.warn("processPeaks is deprecated")}},{key:"addCue",value:function(time,t,e){var n=this._cueIDCounter++,r=new V(t,time,n,e);return this._cues.push(r),n}},{key:"removeCue",value:function(t){for(var e=this._cues.length,i=0;i<e;i++)if(this._cues[i].id===t){this._cues.splice(i,1);break}this._cues.length}},{key:"clearCues",value:function(){this._cues=[]}},{key:"_onTimeUpdate",value:function(t){for(var e=t/this.buffer.sampleRate,n=this._cues.length,i=0;i<n;i++){var r=this._cues[i],o=r.time,c=r.val;(this._prevUpdateTime||0)<=o&&o<=e&&r.callback(c)}this._prevUpdateTime=e}},{key:"save",value:function(t){p5.prototype.saveSound(this,t,"wav")}},{key:"getBlob",value:function(){var t=m(this.buffer);return new Blob([t],{type:"audio/wav"})}}])&&j(e.prototype,n),r&&j(e,r),t}();var I=D;function U(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var G=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bufferSize=T(2048),this.audiocontext=main.audiocontext,this._workletNode=new AudioWorkletNode(this.audiocontext,l.a.amplitudeProcessor,{outputChannelCount:[1],parameterData:{smoothing:e||0},processorOptions:{normalize:!1,smoothing:e||0,numInputChannels:2,bufferSize:this.bufferSize}}),this._workletNode.port.onmessage=function(t){"amplitude"===t.data.name&&(this.volume=t.data.volume,this.volNorm=t.data.volNorm,this.stereoVol=t.data.stereoVol,this.stereoVolNorm=t.data.stereoVolNorm)}.bind(this),this.input=this._workletNode,this.output=this.audiocontext.createGain(),this.volume=0,this.volNorm=0,this.stereoVol=[0,0],this.stereoVolNorm=[0,0],this.normalize=!1,this._workletNode.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),main.meter.connect(this._workletNode),main.soundArray.push(this)}var e,n,r;return e=t,(n=[{key:"setInput",value:function(source,t){main.meter.disconnect(),t&&(this._workletNode.parameters.get("smoothing").value=t),null==source?(console.log("Amplitude input source is not ready! Connecting to main output instead"),main.meter.connect(this._workletNode)):source?(source.connect(this._workletNode),this._workletNode.disconnect(),this._workletNode.connect(this.output)):main.meter.connect(this._workletNode)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):this.output.connect(t):this.output.connect(this.panner.connect(main.input))}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"getLevel",value:function(t){return void 0!==t?this.normalize?this.stereoVolNorm[t]:this.stereoVol[t]:this.normalize?this.volNorm:this.volume}},{key:"toggleNormalize",value:function(t){this.normalize="boolean"==typeof t?t:!this.normalize,this._workletNode.port.postMessage({name:"toggleNormalize",normalize:this.normalize})}},{key:"smooth",value:function(s){s>=0&&s<1?this._workletNode.port.postMessage({name:"smoothing",smoothing:s}):console.log("Error: smoothing must be between 0 and 1")}},{key:"dispose",value:function(){var t=main.soundArray.indexOf(this);main.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._workletNode.disconnect(),delete this._workletNode}}])&&U(e.prototype,n),r&&U(e,r),t}();function L(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var z=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.input=this.analyser=main.audiocontext.createAnalyser(),Object.defineProperties(this,{bins:{get:function(){return this.analyser.fftSize/2},set:function(b){this.analyser.fftSize=2*b},configurable:!0,enumerable:!0},smoothing:{get:function(){return this.analyser.smoothingTimeConstant},set:function(s){this.analyser.smoothingTimeConstant=s},configurable:!0,enumerable:!0}}),this.smooth(e),this.bins=n||1024,main.fftMeter.connect(this.analyser),this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3],main.soundArray.push(this)}var e,n,r;return e=t,n=[{key:"setInput",value:function(source){source?(source.output?source.output.connect(this.analyser):source.connect&&source.connect(this.analyser),main.fftMeter.disconnect()):main.fftMeter.connect(this.analyser)}},{key:"waveform",value:function(){for(var t,e,n=new Array,i=0;i<arguments.length;i++)"number"==typeof arguments[i]&&(t=arguments[i],this.analyser.fftSize=2*t),"string"==typeof arguments[i]&&(e=arguments[i]);if(e&&!p5.prototype._isSafari())return X(this,this.timeDomain),this.analyser.getFloatTimeDomainData(this.timeDomain),this.timeDomain;Y(this,this.timeDomain),this.analyser.getByteTimeDomainData(this.timeDomain);for(var r=0;r<this.timeDomain.length;r++){var o=p5.prototype.map(this.timeDomain[r],0,255,-1,1);n.push(o)}return n}},{key:"analyze",value:function(){for(var t,i=0;i<arguments.length;i++)"number"==typeof arguments[i]&&(this.bins=arguments[i],this.analyser.fftSize=2*this.bins),"string"==typeof arguments[i]&&(t=arguments[i]);if(t&&"db"===t.toLowerCase())return W(this),this.analyser.getFloatFrequencyData(this.freqDomain),this.freqDomain;Z(this,this.freqDomain),this.analyser.getByteFrequencyData(this.freqDomain);var e=Array.apply([],this.freqDomain);return e}},{key:"getEnergy",value:function(t,e){var n=main.audiocontext.sampleRate/2;if("bass"===t?(t=this.bass[0],e=this.bass[1]):"lowMid"===t?(t=this.lowMid[0],e=this.lowMid[1]):"mid"===t?(t=this.mid[0],e=this.mid[1]):"highMid"===t?(t=this.highMid[0],e=this.highMid[1]):"treble"===t&&(t=this.treble[0],e=this.treble[1]),"number"!=typeof t)throw"invalid input for getEnergy()";if(e){if(t&&e){if(t>e){var r=e;e=t,t=r}for(var o=Math.round(t/n*this.freqDomain.length),c=Math.round(e/n*this.freqDomain.length),l=0,h=0,i=o;i<=c;i++)l+=this.freqDomain[i],h+=1;return l/h}throw"invalid input for getEnergy()"}var f=Math.round(t/n*this.freqDomain.length);return this.freqDomain[f]}},{key:"getFreq",value:function(t,e){return console.log("getFreq() is deprecated. Please use getEnergy() instead."),this.getEnergy(t,e)}},{key:"getCentroid",value:function(){for(var t=main.audiocontext.sampleRate/2,e=0,n=0,i=0;i<this.freqDomain.length;i++)e+=i*this.freqDomain[i],n+=this.freqDomain[i];var r=0;return 0!==n&&(r=e/n),r*(t/this.freqDomain.length)}},{key:"smooth",value:function(s){return void 0!==s&&(this.smoothing=s),this.smoothing}},{key:"dispose",value:function(){var t=main.soundArray.indexOf(this);main.soundArray.splice(t,1),this.analyser&&(this.analyser.disconnect(),delete this.analyser)}},{key:"linAverages",value:function(t){for(var e=t||16,n=this.freqDomain,r=n.length,o=Math.floor(r/e),c=new Array(e),l=0,h=0;h<r;h++)c[l]=void 0!==c[l]?(c[l]+n[h])/2:n[h],h%o==o-1&&l++;return c}},{key:"logAverages",value:function(t){for(var e=main.audiocontext.sampleRate/2,n=this.freqDomain,r=n.length,o=new Array(t.length),c=0,l=0;l<r;l++)Math.round(l*e/this.freqDomain.length)>t[c].hi&&c++,o[c]=void 0!==o[c]?(o[c]+n[l])/2:n[l];return o}},{key:"getOctaveBands",value:function(t,e){var n=t||3,r=e||15.625,o=[],c={lo:r/Math.pow(2,1/(2*n)),ctr:r,hi:r*Math.pow(2,1/(2*n))};o.push(c);for(var l=main.audiocontext.sampleRate/2;c.hi<l;){var h={};h.lo=c.hi,h.ctr=c.ctr*Math.pow(2,1/n),h.hi=h.ctr*Math.pow(2,1/(2*n)),o.push(h),c=h}return o}}],n&&L(e.prototype,n),r&&L(e,r),t}();function W(t){t.freqDomain instanceof Float32Array==!1&&(t.freqDomain=new Float32Array(t.analyser.frequencyBinCount))}function Z(t){t.freqDomain instanceof Uint8Array==!1&&(t.freqDomain=new Uint8Array(t.analyser.frequencyBinCount))}function X(t){t.timeDomain instanceof Float32Array==!1&&(t.timeDomain=new Float32Array(t.analyser.frequencyBinCount))}function Y(t){t.timeDomain instanceof Uint8Array==!1&&(t.timeDomain=new Uint8Array(t.analyser.frequencyBinCount))}var H=z,$=n(4),Q=n.n($),J=n(1),K=n.n(J),tt=n(8),et=n.n(tt);function nt(t){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(t)}function it(t,e){return!e||"object"!==nt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ot(t){return ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ot(t)}function st(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}function at(t,p){return at=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},at(t,p)}function ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ct(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lt(t,e,n,r,o){var c=t.oscillator;for(var i in t.mathOps)t.mathOps[i]instanceof o&&(c.disconnect(),t.mathOps[i].dispose(),(n=i)<t.mathOps.length-2&&(r=t.mathOps[i+1]));return n===t.mathOps.length-1&&t.mathOps.push(r),i>0&&(c=t.mathOps[i-1]),c.disconnect(),c.connect(e),e.connect(r),t.mathOps[n]=e,t}var ht=function(){function t(e,n){if(ut(this,t),"string"==typeof e){var r=n;n=e,e=r}if("number"==typeof n){var o=n;n=e,e=o}this.started=!1,this.phaseAmount=void 0,this.oscillator=main.audiocontext.createOscillator(),this.f=e||440,this.oscillator.type=n||"sine",this.oscillator.frequency.setValueAtTime(this.f,main.audiocontext.currentTime),this.output=main.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,main.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=main.input,this.panner=new E(this.output,this.connection,1),this.mathOps=[this.output],main.soundArray.push(this),this.fade=this.amp}var e,n,r;return e=t,n=[{key:"start",value:function(time,t){if(this.started){var e=main.audiocontext.currentTime;this.stop(e)}if(!this.started){var n=t||this.f,r=this.oscillator.type;for(var i in this.oscillator&&(this.oscillator.disconnect(),delete this.oscillator),this.oscillator=main.audiocontext.createOscillator(),this.oscillator.frequency.value=Math.abs(n),this.oscillator.type=r,this.oscillator.connect(this.output),time=time||0,this.oscillator.start(time+main.audiocontext.currentTime),this.freqNode=this.oscillator.frequency,this._freqMods)void 0!==this._freqMods[i].connect&&this._freqMods[i].connect(this.oscillator.frequency);this.started=!0}}},{key:"stop",value:function(time){if(this.started){var t=time||0,e=main.audiocontext.currentTime;this.oscillator.stop(t+e),this.started=!1}}},{key:"amp",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("number"==typeof t){var r=main.audiocontext.currentTime;this.output.gain.linearRampToValueAtTime(t,r+n+e)}else{if(!t)return this.output.gain;t.connect(this.output.gain)}}},{key:"getAmp",value:function(){return this.output.gain.value}},{key:"freq",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("number"!=typeof t||isNaN(t)){if(!t)return this.oscillator.frequency;t.output&&(t=t.output),t.connect(this.oscillator.frequency),this._freqMods.push(t)}else{this.f=t;var r=main.audiocontext.currentTime;0===e?this.oscillator.frequency.setValueAtTime(t,n+r):t>0?this.oscillator.frequency.exponentialRampToValueAtTime(t,n+e+r):this.oscillator.frequency.linearRampToValueAtTime(t,n+e+r),this.phaseAmount&&this.phase(this.phaseAmount)}}},{key:"getFreq",value:function(){return this.oscillator.frequency.value}},{key:"setType",value:function(t){this.oscillator.type=t}},{key:"getType",value:function(){return this.oscillator.type}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?(this.panner.connect(t.input),this.connection=t.input):(this.panner.connect(t),this.connection=t):this.panner.connect(main.input)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect(),this.panner&&(this.panner.disconnect(),this.output&&this.output.connect(this.panner)),this.oscMods=[]}},{key:"pan",value:function(t,e){this.panPosition=t,this.panner.pan(t,e)}},{key:"getPan",value:function(){return this.panPosition}},{key:"dispose",value:function(){var t=main.soundArray.indexOf(this);if(main.soundArray.splice(t,1),this.oscillator){var e=main.audiocontext.currentTime;this.stop(e),this.disconnect(),this.panner=null,this.oscillator=null}this.osc2&&this.osc2.dispose()}},{key:"phase",value:function(p){var t=p5.prototype.map(p,0,1,0,1/this.f),e=main.audiocontext.currentTime;this.phaseAmount=p,this.dNode||(this.dNode=main.audiocontext.createDelay(),this.oscillator.disconnect(),this.oscillator.connect(this.dNode),this.dNode.connect(this.output)),this.dNode.delayTime.setValueAtTime(t,e)}},{key:"add",value:function(t){var e=new Q.a(t);return lt(this,e,this.mathOps.length-1,this.output,Q.a)}},{key:"mult",value:function(t){var e=new K.a(t);return lt(this,e,this.mathOps.length-1,this.output,K.a)}},{key:"scale",value:function(t,e,n,r){var o,c;4===arguments.length?(o=p5.prototype.map(n,t,e,0,1)-.5,c=p5.prototype.map(r,t,e,0,1)-.5):(o=arguments[0],c=arguments[1]);var l=new et.a(o,c),h=this.mathOps.length-1,f=this.output;return lt(this,l,h,f,et.a)}}],n&&ct(e.prototype,n),r&&ct(e,r),t}(),pt=function(t){function e(t){return ut(this,e),it(this,ot(e).call(this,t,"sine"))}return st(e,t),e}(ht),ft=function(t){function e(t){return ut(this,e),it(this,ot(e).call(this,t,"triangle"))}return st(e,t),e}(ht),yt=function(t){function e(t){return ut(this,e),it(this,ot(e).call(this,t,"sawtooth"))}return st(e,t),e}(ht),mt=function(t){function e(t){return ut(this,e),it(this,ot(e).call(this,t,"square"))}return st(e,t),e}(ht),vt=ht,_t=n(7),gt=n.n(_t);p5.Envelope=function(t,e,n,r,o,c){this.aTime=t||.1,this.aLevel=e||1,this.dTime=n||.5,this.dLevel=r||0,this.rTime=o||0,this.rLevel=c||0,this._rampHighPercentage=.98,this._rampLowPercentage=.02,this.output=main.audiocontext.createGain(),this.control=new gt.a,this._init(),this.control.connect(this.output),this.connection=null,this.mathOps=[this.control],this.isExponential=!1,this.sourceToClear=null,this.wasTriggered=!1,main.soundArray.push(this)},p5.Envelope.prototype._init=function(){var t=main.audiocontext.currentTime;this.control.setTargetAtTime(1e-5,t,.001),this._setRampAD(this.aTime,this.dTime)},p5.Envelope.prototype.set=function(t,e,n,r,o,c){this.aTime=t,this.aLevel=e,this.dTime=n||0,this.dLevel=r||0,this.rTime=o||0,this.rLevel=c||0,this._setRampAD(t,n)},p5.Envelope.prototype.setADSR=function(t,e,n,r){this.aTime=t,this.dTime=e||0,this.sPercent=n||0,this.dLevel=void 0!==n?n*(this.aLevel-this.rLevel)+this.rLevel:0,this.rTime=r||0,this._setRampAD(t,e)},p5.Envelope.prototype.setRange=function(t,e){this.aLevel=t||1,this.rLevel=e||0},p5.Envelope.prototype._setRampAD=function(t,e){this._rampAttackTime=this.checkExpInput(t),this._rampDecayTime=this.checkExpInput(e);var n=1;n=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=t/this.checkExpInput(n),n=Math.log(1/this._rampLowPercentage),this._rampDecayTC=e/this.checkExpInput(n)},p5.Envelope.prototype.setRampPercentages=function(t,e){this._rampHighPercentage=this.checkExpInput(t),this._rampLowPercentage=this.checkExpInput(e);var n=1;n=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=this._rampAttackTime/this.checkExpInput(n),n=Math.log(1/this._rampLowPercentage),this._rampDecayTC=this._rampDecayTime/this.checkExpInput(n)},p5.Envelope.prototype.setInput=function(){for(var i=0;i<arguments.length;i++)this.connect(arguments[i])},p5.Envelope.prototype.setExp=function(t){this.isExponential=t},p5.Envelope.prototype.checkExpInput=function(t){return t<=0&&(t=1e-8),t},p5.Envelope.prototype.play=function(t,e,n){var r=e||0;t&&this.connection!==t&&this.connect(t),this.triggerAttack(t,r),this.triggerRelease(t,r+this.aTime+this.dTime+~~n)},p5.Envelope.prototype.triggerAttack=function(t,e){var n=main.audiocontext.currentTime+(e||0);this.lastAttack=n,this.wasTriggered=!0,t&&this.connection!==t&&this.connect(t);var r=this.control.getValueAtTime(n);!0===this.isExponential?this.control.exponentialRampToValueAtTime(this.checkExpInput(r),n):this.control.linearRampToValueAtTime(r,n),n+=this.aTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.aLevel),n),r=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(r,n)):(this.control.linearRampToValueAtTime(this.aLevel,n),r=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(r,n)),n+=this.dTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.dLevel),n),r=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(r,n)):(this.control.linearRampToValueAtTime(this.dLevel,n),r=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(r,n))},p5.Envelope.prototype.triggerRelease=function(t,e){if(this.wasTriggered){var n=main.audiocontext.currentTime+(e||0);t&&this.connection!==t&&this.connect(t);var r=this.control.getValueAtTime(n);!0===this.isExponential?this.control.exponentialRampToValueAtTime(this.checkExpInput(r),n):this.control.linearRampToValueAtTime(r,n),n+=this.rTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.rLevel),n),r=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(r,n)):(this.control.linearRampToValueAtTime(this.rLevel,n),r=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(r,n)),this.wasTriggered=!1}},p5.Envelope.prototype.ramp=function(t,e,n,r){var o=main.audiocontext.currentTime+(e||0),c=this.checkExpInput(n),l=void 0!==r?this.checkExpInput(r):void 0;t&&this.connection!==t&&this.connect(t);var h=this.checkExpInput(this.control.getValueAtTime(o));c>h?(this.control.setTargetAtTime(c,o,this._rampAttackTC),o+=this._rampAttackTime):c<h&&(this.control.setTargetAtTime(c,o,this._rampDecayTC),o+=this._rampDecayTime),void 0!==l&&(l>c?this.control.setTargetAtTime(l,o,this._rampAttackTC):l<c&&this.control.setTargetAtTime(l,o,this._rampDecayTC))},p5.Envelope.prototype.connect=function(t){this.connection=t,(t instanceof p5.Oscillator||t instanceof p5.SoundFile||t instanceof p5.AudioIn||t instanceof p5.Reverb||t instanceof p5.Noise||t instanceof p5.Filter||t instanceof p5.Delay)&&(t=t.output.gain),t instanceof AudioParam&&t.setValueAtTime(0,main.audiocontext.currentTime),this.output.connect(t)},p5.Envelope.prototype.disconnect=function(){this.output&&this.output.disconnect()},p5.Envelope.prototype.add=function(t){var e=new Q.a(t),n=this.mathOps.length,r=this.output;return p5.prototype._mathChain(this,e,n,r,Q.a)},p5.Envelope.prototype.mult=function(t){var e=new K.a(t),n=this.mathOps.length,r=this.output;return p5.prototype._mathChain(this,e,n,r,K.a)},p5.Envelope.prototype.scale=function(t,e,n,r){var o=new et.a(t,e,n,r),c=this.mathOps.length,l=this.output;return p5.prototype._mathChain(this,o,c,l,et.a)},p5.Envelope.prototype.dispose=function(){var t=main.soundArray.indexOf(this);main.soundArray.splice(t,1),this.disconnect(),this.control&&(this.control.dispose(),this.control=null);for(var i=1;i<this.mathOps.length;i++)this.mathOps[i].dispose()},p5.Env=function(t,e,n,r,o,c){console.warn("WARNING: p5.Env is now deprecated and may be removed in future versions. Please use the new p5.Envelope instead."),p5.Envelope.call(this,t,e,n,r,o,c)},p5.Env.prototype=Object.create(p5.Envelope.prototype);var bt=p5.Envelope;function Tt(t){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tt(t)}function wt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xt(t,e){return!e||"object"!==Tt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},St(t)}function kt(t,p){return kt=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},kt(t,p)}var Pt=function(){for(var t=2*main.audiocontext.sampleRate,e=main.audiocontext.createBuffer(1,t,main.audiocontext.sampleRate),n=e.getChannelData(0),i=0;i<t;i++)n[i]=2*Math.random()-1;return e.type="white",e}(),At=function(){var t,e,n,r,o,c,l,h=2*main.audiocontext.sampleRate,f=main.audiocontext.createBuffer(1,h,main.audiocontext.sampleRate),d=f.getChannelData(0);t=e=n=r=o=c=l=0;for(var i=0;i<h;i++){var y=2*Math.random()-1;t=.99886*t+.0555179*y,e=.99332*e+.0750759*y,n=.969*n+.153852*y,r=.8665*r+.3104856*y,o=.55*o+.5329522*y,c=-.7616*c-.016898*y,d[i]=t+e+n+r+o+c+l+.5362*y,d[i]*=.11,l=.115926*y}return f.type="pink",f}(),Ot=function(){for(var t=2*main.audiocontext.sampleRate,e=main.audiocontext.createBuffer(1,t,main.audiocontext.sampleRate),n=e.getChannelData(0),r=0,i=0;i<t;i++){var o=2*Math.random()-1;n[i]=(r+.02*o)/1.02,r=n[i],n[i]*=3.5}return e.type="brown",e}(),Ct=function(t){function e(t){var n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),delete(n=xt(this,St(e).call(this))).f,delete n.freq,delete n.oscillator,r="brown"===t?Ot:"pink"===t?At:Pt,n.buffer=r,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kt(t,e)}(e,t),n=e,(r=[{key:"setType",value:function(t){switch(t){case"white":default:this.buffer=Pt;break;case"pink":this.buffer=At;break;case"brown":this.buffer=Ot}if(this.started){var e=main.audiocontext.currentTime;this.stop(e),this.start(e+.01)}}},{key:"getType",value:function(){return this.buffer.type}},{key:"start",value:function(){this.started&&this.stop(),this.noise=main.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var t=main.audiocontext.currentTime;this.noise.start(t),this.started=!0}},{key:"stop",value:function(){var t=main.audiocontext.currentTime;this.noise&&(this.noise.stop(t),this.started=!1)}},{key:"dispose",value:function(){var t=main.audiocontext.currentTime,e=main.soundArray.indexOf(this);main.soundArray.splice(e,1),this.noise&&(this.noise.disconnect(),this.stop(t)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}])&&wt(n.prototype,r),o&&wt(n,o),e}(vt),Rt=n(2),qt=n.n(Rt);function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function Nt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function jt(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bt(t){return Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(t)}function Mt(t,p){return Mt=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},Mt(t,p)}var Vt=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=jt(this,Bt(e).call(this,t,"sawtooth"))).w=n||0,r.osc2=new yt(t),r.dNode=main.audiocontext.createDelay(),r.dcOffset=Ft(),r.dcGain=main.audiocontext.createGain(),r.dcOffset.connect(r.dcGain),r.dcGain.connect(r.output),r.f=t||440;var o=r.w/r.oscillator.frequency.value;return r.dNode.delayTime.value=o,r.dcGain.gain.value=1.7*(.5-r.w),r.osc2.disconnect(),r.osc2.panner.disconnect(),r.osc2.amp(-1),r.osc2.output.connect(r.dNode),r.dNode.connect(r.output),r.output.gain.value=1,r.output.connect(r.panner),r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(e,t),n=e,r=[{key:"width",value:function(t){if("number"==typeof t){if(t<=1&&t>=0){this.w=t;var e=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=e}this.dcGain.gain.value=1.7*(.5-this.w)}else{t.connect(this.dNode.delayTime);var n=new qt.a(-.5);t.connect(n);var r=new K.a(-1),o=new K.a(1.7);(n=n.connect(r).connect(o)).connect(this.dcGain.gain)}}},{key:"start",value:function(t,time){var e=main.audiocontext.currentTime,n=time||0;if(!this.started){var r=t||this.f,o=this.oscillator.type;this.oscillator=main.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(r,e),this.oscillator.type=o,this.oscillator.connect(this.output),this.oscillator.start(n+e),this.osc2.oscillator=main.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(r,n+e),this.osc2.oscillator.type=o,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(n+e),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=Ft(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(n+e),void 0!==this.mods&&void 0!==this.mods.frequency&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}}},{key:"stop",value:function(time){if(this.started){var t=time||0,e=main.audiocontext.currentTime;this.oscillator.stop(t+e),this.osc2.oscillator&&this.osc2.oscillator.stop(t+e),this.dcOffset.stop(t+e),this.started=!1,this.osc2.started=!1}}},{key:"freq",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("number"==typeof t){this.f=t;var r=main.audiocontext.currentTime,o=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(r),this.oscillator.frequency.setValueAtTime(o,r+n),this.oscillator.frequency.exponentialRampToValueAtTime(t,n+e+r),this.osc2.oscillator.frequency.cancelScheduledValues(r),this.osc2.oscillator.frequency.setValueAtTime(o,r+n),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(t,n+e+r),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else t.output&&(t.output.disconnect(),t.output.connect(this.oscillator.frequency),t.output.connect(this.osc2.oscillator.frequency),this.freqMod=t)}}],r&&Nt(n.prototype,r),o&&Nt(n,o),e}(vt);function Ft(){for(var t=main.audiocontext,e=t.createBuffer(1,2048,t.sampleRate),data=e.getChannelData(0),i=0;i<2048;i++)data[i]=1;var n=t.createBufferSource();return n.buffer=e,n.loop=!0,n}var Dt=Vt;function It(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}main.inputSources=[];var Ut=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.input=main.audiocontext.createGain(),this.output=main.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=null,this.enabled=!1,this.amplitude=new G,this.output.connect(this.amplitude.input),window.MediaStreamTrack&&window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia||(e?e():window.alert("This browser does not support MediaStreamTrack and mediaDevices")),main.soundArray.push(this)}var e,n,r;return e=t,(n=[{key:"start",value:function(t,e){var n=this;this.stream&&this.stop();var r=main.inputSources[n.currentSource],o={audio:{sampleRate:main.audiocontext.sampleRate,echoCancellation:!1}};main.inputSources[this.currentSource]&&(o.audio.deviceId=r.deviceId),window.navigator.mediaDevices.getUserMedia(o).then((function(e){n.stream=e,n.enabled=!0,n.mediaStream=main.audiocontext.createMediaStreamSource(e),n.mediaStream.connect(n.output),n.amplitude.setInput(n.output),t&&t()})).catch((function(t){e?e(t):console.error(t)}))}},{key:"stop",value:function(){this.stream&&(this.stream.getTracks().forEach((function(track){track.stop()})),this.mediaStream.disconnect(),delete this.mediaStream,delete this.stream)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):t.hasOwnProperty("analyser")?this.output.connect(t.analyser):this.output.connect(t):this.output.connect(main.input)}},{key:"disconnect",value:function(){this.output&&(this.output.disconnect(),this.output.connect(this.amplitude.input))}},{key:"getLevel",value:function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()}},{key:"amp",value:function(t,e){if(e){var n=e||0,r=this.output.gain.value;this.output.gain.cancelScheduledValues(main.audiocontext.currentTime),this.output.gain.setValueAtTime(r,main.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(t,n+main.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(main.audiocontext.currentTime),this.output.gain.setValueAtTime(t,main.audiocontext.currentTime)}},{key:"getSources",value:function(t,e){return new Promise((function(n,r){window.navigator.mediaDevices.enumerateDevices().then((function(e){main.inputSources=e.filter((function(t){return"audioinput"===t.kind})),n(main.inputSources),t&&t(main.inputSources)})).catch((function(t){r(t),e?e(t):console.error("This browser does not support MediaStreamTrack.getSources()")}))}))}},{key:"setSource",value:function(t){main.inputSources.length>0&&t<main.inputSources.length?(this.currentSource=t,console.log("set source to ",main.inputSources[this.currentSource])):console.log("unable to set input source"),this.stream&&this.stream.active&&this.start()}},{key:"dispose",value:function(){var t=main.soundArray.indexOf(this);main.soundArray.splice(t,1),this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),delete this.amplitude,delete this.output}}])&&It(e.prototype,n),r&&It(e,r),t}(),Gt=n(23),Lt=n.n(Gt);function zt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ac=main.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._drywet=new Lt.a(1),this.wet=this.ac.createGain(),this.input.connect(this._drywet.a),this.wet.connect(this._drywet.b),this._drywet.connect(this.output),this.connect(),main.soundArray.push(this)}var e,n,r;return e=t,n=[{key:"amp",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=main.audiocontext.currentTime,o=r+n,c=o+e+.001,l=this.output.gain.value;this.output.gain.cancelScheduledValues(r),this.output.gain.linearRampToValueAtTime(l,o+.001),this.output.gain.linearRampToValueAtTime(t,c)}},{key:"chain",value:function(){if(arguments.length>0){this.connect(arguments[0]);for(var i=1;i<arguments.length;i+=1)arguments[i-1].connect(arguments[i])}return this}},{key:"drywet",value:function(t){return void 0!==t&&(this._drywet.fade.value=t),this._drywet.fade.value}},{key:"connect",value:function(t){var u=t||p5.soundOut.input;this.output.connect(u.input?u.input:u)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){var t=main.soundArray.indexOf(this);main.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._drywet&&(this._drywet.disconnect(),delete this._drywet),this.wet&&(this.wet.disconnect(),delete this.wet),this.ac=void 0}}],n&&zt(e.prototype,n),r&&zt(e,r),t}(),Zt=Wt;function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Yt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ht(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $t(t,e){return!e||"object"!==Xt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qt(t,e,n){return Qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Jt(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(n):desc.value}},Qt(t,e,n||t)}function Jt(t){return Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Jt(t)}function Kt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&te(t,e)}function te(t,p){return te=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},te(t,p)}var ee=function(t){function e(t){var n;return Yt(this,e),(n=$t(this,Jt(e).call(this))).biquad=n.ac.createBiquadFilter(),n.input.connect(n.biquad),n.biquad.connect(n.wet),t&&n.setType(t),n._on=!0,n._untoggledType=n.biquad.type,n}var n,r,o;return Kt(e,t),n=e,(r=[{key:"process",value:function(t,e,n,time){t.connect(this.input),this.set(e,n,time)}},{key:"set",value:function(t,e,time){t&&this.freq(t,time),e&&this.res(e,time)}},{key:"freq",value:function(t,time){var e=time||0;return t<=0&&(t=1),"number"==typeof t?(this.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+e),this.biquad.frequency.exponentialRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.biquad.frequency),this.biquad.frequency.value}},{key:"res",value:function(t,time){var e=time||0;return"number"==typeof t?(this.biquad.Q.value=t,this.biquad.Q.cancelScheduledValues(this.ac.currentTime+.01+e),this.biquad.Q.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.biquad.Q),this.biquad.Q.value}},{key:"gain",value:function(t,time){var e=time||0;return"number"==typeof t?(this.biquad.gain.value=t,this.biquad.gain.cancelScheduledValues(this.ac.currentTime+.01+e),this.biquad.gain.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.biquad.gain),this.biquad.gain.value}},{key:"toggle",value:function(){return this._on=!this._on,!0===this._on?this.biquad.type=this._untoggledType:!1===this._on&&(this.biquad.type="allpass"),this._on}},{key:"setType",value:function(t){this.biquad.type=t,this._untoggledType=this.biquad.type}},{key:"dispose",value:function(){Qt(Jt(e.prototype),"dispose",this).call(this),this.biquad&&(this.biquad.disconnect(),delete this.biquad)}}])&&Ht(n.prototype,r),o&&Ht(n,o),e}(Zt),ne=function(t){function e(){return Yt(this,e),$t(this,Jt(e).call(this,"lowpass"))}return Kt(e,t),e}(ee),ie=function(t){function e(){return Yt(this,e),$t(this,Jt(e).call(this,"highpass"))}return Kt(e,t),e}(ee),re=function(t){function e(){return Yt(this,e),$t(this,Jt(e).call(this,"bandpass"))}return Kt(e,t),e}(ee),filter=ee;function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function se(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ae(t,e){return!e||"object"!==oe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ue(t){return ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ue(t)}function ce(t,p){return ce=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},ce(t,p)}var le=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ae(this,ue(e).call(this,"peaking"))).disconnect(),r.set(t,n),r.biquad.gain.value=0,delete r.input,delete r.output,delete r._drywet,delete r.wet,r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ce(t,e)}(e,t),n=e,(r=[{key:"amp",value:function(){console.warn("`amp()` is not available for p5.EQ bands. Use `.gain()`")}},{key:"drywet",value:function(){console.warn("`drywet()` is not available for p5.EQ bands.")}},{key:"connect",value:function(t){var u=t||p5.soundOut.input;this.biquad?this.biquad.connect(u.input?u.input:u):this.output.connect(u.input?u.input:u)}},{key:"disconnect",value:function(){this.biquad&&this.biquad.disconnect()}},{key:"dispose",value:function(){var t=main.soundArray.indexOf(this);main.soundArray.splice(t,1),this.disconnect(),delete this.biquad}}])&&se(n.prototype,r),o&&se(n,o),e}(filter);function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}function pe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fe(t,e){return!e||"object"!==he(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function de(t,e,n){return de="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=ye(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(n):desc.value}},de(t,e,n||t)}function ye(t){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(t)}function me(t,p){return me=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},me(t,p)}var ve=function(t){function e(t){var n,r,o,c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=fe(this,ye(e).call(this)),r=3===(t=3===t||8===t?t:3)?Math.pow(2,3):2,n.bands=[];for(var i=0;i<t;i++)i===t-1?(o=21e3,c=.01):0===i?(o=100,c=.1):1===i?(o=3===t?360*r:360,c=1):(o=n.bands[i-1].freq()*r,c=1),n.bands[i]=n._newBand(o,c),i>0?n.bands[i-1].connect(n.bands[i].biquad):n.input.connect(n.bands[i].biquad);return n.bands[t-1].connect(n.output),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&me(t,e)}(e,t),n=e,r=[{key:"process",value:function(t){t.connect(this.input)}},{key:"set",value:function(){if(arguments.length===2*this.bands.length)for(var i=0;i<arguments.length;i+=2)this.bands[i/2].freq(arguments[i]),this.bands[i/2].gain(arguments[i+1]);else console.error("Argument mismatch. .set() should be called with "+2*this.bands.length+" arguments. (one frequency and gain value pair for each band of the eq)")}},{key:"_newBand",value:function(t,e){return new le(t,e)}},{key:"dispose",value:function(){if(de(ye(e.prototype),"dispose",this).call(this),this.bands){for(;this.bands.length>0;)this.bands.pop().dispose();delete this.bands}}}],r&&pe(n.prototype,r),o&&pe(n,o),e}(Zt),_e=ve;function ge(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var be=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ac=main.audiocontext,this.listener=this.ac.listener}var e,n,r;return e=t,n=[{key:"process",value:function(t){t.connect(this.input)}},{key:"position",value:function(t,e,n,time){return this.positionX(t,time),this.positionY(e,time),this.positionZ(n,time),[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}},{key:"positionX",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.positionX.value=t,this.listener.positionX.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.positionX.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.positionX),this.listener.positionX.value}},{key:"positionY",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.positionY.value=t,this.listener.positionY.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.positionY.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.positionY),this.listener.positionY.value}},{key:"positionZ",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.positionZ.value=t,this.listener.positionZ.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.positionZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.positionZ),this.listener.positionZ.value}},{key:"orient",value:function(t,e,n,r,o,c,time){return 3===arguments.length||4===arguments.length?(time=arguments[3],this.orientForward(t,e,n,time)):6!==arguments.length&&7!==arguments||(this.orientForward(t,e,n),this.orientUp(r,o,c,time)),[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value,this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}},{key:"orientForward",value:function(t,e,n,time){return this.forwardX(t,time),this.forwardY(e,time),this.forwardZ(n,time),[this.listener.forwardX,this.listener.forwardY,this.listener.forwardZ]}},{key:"orientUp",value:function(t,e,n,time){return this.upX(t,time),this.upY(e,time),this.upZ(n,time),[this.listener.upX,this.listener.upY,this.listener.upZ]}},{key:"forwardX",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.forwardX.value=t,this.listener.forwardX.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.forwardX.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.forwardX),this.listener.forwardX.value}},{key:"forwardY",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.forwardY.value=t,this.listener.forwardY.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.forwardY.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.forwardY),this.listener.forwardY.value}},{key:"forwardZ",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.forwardZ.value=t,this.listener.forwardZ.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.forwardZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.forwardZ),this.listener.forwardZ.value}},{key:"upX",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.upX.value=t,this.listener.upX.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.upX.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.upX),this.listener.upX.value}},{key:"upY",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.upY.value=t,this.listener.upY.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.upY.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.upY),this.listener.upY.value}},{key:"upZ",value:function(t,time){var e=time||0;return"number"==typeof t?(this.listener.upZ.value=t,this.listener.upZ.cancelScheduledValues(this.ac.currentTime+.01+e),this.listener.upZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.listener.upZ),this.listener.upZ.value}}],n&&ge(e.prototype,n),r&&ge(e,r),t}(),Te=be;function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function xe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Se(t,e){return!e||"object"!==we(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ke(t,e,n){return ke="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Pe(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(n):desc.value}},ke(t,e,n||t)}function Pe(t){return Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Pe(t)}function Ae(t,p){return Ae=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},Ae(t,p)}var Oe=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Se(this,Pe(e).call(this))).panner=t.ac.createPanner(),t.panner.panningModel="HRTF",t.panner.distanceModel="linear",t.panner.connect(t.output),t.input.connect(t.panner),t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ae(t,e)}(e,t),n=e,(r=[{key:"process",value:function(t){t.connect(this.input)}},{key:"set",value:function(t,e,n,time){return this.positionX(t,time),this.positionY(e,time),this.positionZ(n,time),[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}},{key:"positionX",value:function(t,time){var e=time||0;return"number"==typeof t?(this.panner.positionX.value=t,this.panner.positionX.cancelScheduledValues(this.ac.currentTime+.01+e),this.panner.positionX.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.panner.positionX),this.panner.positionX.value}},{key:"positionY",value:function(t,time){var e=time||0;return"number"==typeof t?(this.panner.positionY.value=t,this.panner.positionY.cancelScheduledValues(this.ac.currentTime+.01+e),this.panner.positionY.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.panner.positionY),this.panner.positionY.value}},{key:"positionZ",value:function(t,time){var e=time||0;return"number"==typeof t?(this.panner.positionZ.value=t,this.panner.positionZ.cancelScheduledValues(this.ac.currentTime+.01+e),this.panner.positionZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.panner.positionZ),this.panner.positionZ.value}},{key:"orient",value:function(t,e,n,time){return this.orientX(t,time),this.orientY(e,time),this.orientZ(n,time),[this.panner.orientationX.value,this.panner.orientationY.value,this.panner.orientationZ.value]}},{key:"orientX",value:function(t,time){var e=time||0;return"number"==typeof t?(this.panner.orientationX.value=t,this.panner.orientationX.cancelScheduledValues(this.ac.currentTime+.01+e),this.panner.orientationX.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.panner.orientationX),this.panner.orientationX.value}},{key:"orientY",value:function(t,time){var e=time||0;return"number"==typeof t?(this.panner.orientationY.value=t,this.panner.orientationY.cancelScheduledValues(this.ac.currentTime+.01+e),this.panner.orientationY.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.panner.orientationY),this.panner.orientationY.value}},{key:"orientZ",value:function(t,time){var e=time||0;return"number"==typeof t?(this.panner.orientationZ.value=t,this.panner.orientationZ.cancelScheduledValues(this.ac.currentTime+.01+e),this.panner.orientationZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):t&&t.connect(this.panner.orientationZ),this.panner.orientationZ.value}},{key:"setFalloff",value:function(t,e){this.maxDist(t),this.rolloff(e)}},{key:"maxDist",value:function(t){return"number"==typeof t&&(this.panner.maxDistance=t),this.panner.maxDistance}},{key:"rolloff",value:function(t){return"number"==typeof t&&(this.panner.rolloffFactor=t),this.panner.rolloffFactor}},{key:"dispose",value:function(){ke(Pe(e.prototype),"dispose",this).call(this),this.panner&&(this.panner.disconnect(),delete this.panner)}}])&&xe(n.prototype,r),o&&xe(n,o),e}(Zt);function Ce(t){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(t)}function Re(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qe(t,e){return!e||"object"!==Ce(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ee(t,e,n){return Ee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Ne(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(n):desc.value}},Ee(t,e,n||t)}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ne(t)}function je(t,p){return je=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},je(t,p)}var Be=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qe(this,Ne(e).call(this)))._split=t.ac.createChannelSplitter(2),t._merge=t.ac.createChannelMerger(2),t._leftGain=t.ac.createGain(),t._rightGain=t.ac.createGain(),t.leftDelay=t.ac.createDelay(),t.rightDelay=t.ac.createDelay(),t._leftFilter=new filter,t._rightFilter=new filter,t._leftFilter.disconnect(),t._rightFilter.disconnect(),t._leftFilter.biquad.frequency.setValueAtTime(1200,t.ac.currentTime),t._rightFilter.biquad.frequency.setValueAtTime(1200,t.ac.currentTime),t._leftFilter.biquad.Q.setValueAtTime(.3,t.ac.currentTime),t._rightFilter.biquad.Q.setValueAtTime(.3,t.ac.currentTime),t.input.connect(t._split),t.leftDelay.connect(t._leftGain),t.rightDelay.connect(t._rightGain),t._leftGain.connect(t._leftFilter.input),t._rightGain.connect(t._rightFilter.input),t._merge.connect(t.wet),t._leftFilter.biquad.gain.setValueAtTime(1,t.ac.currentTime),t._rightFilter.biquad.gain.setValueAtTime(1,t.ac.currentTime),t.setType(0),t._maxDelay=t.leftDelay.delayTime.maxValue,t.feedback(.5),t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&je(t,e)}(e,t),n=e,(r=[{key:"process",value:function(t,e,n,r){var o=n||0,c=e||0;if(o>=1)throw new Error("Feedback value will force a positive feedback loop.");if(c>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");t.connect(this.input),this.leftDelay.delayTime.setValueAtTime(c,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(c,this.ac.currentTime),this._leftGain.gain.value=o,this._rightGain.gain.value=o,r&&(this._leftFilter.freq(r),this._rightFilter.freq(r))}},{key:"delayTime",value:function(t){"number"!=typeof t?(t.connect(this.leftDelay.delayTime),t.connect(this.rightDelay.delayTime)):(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(t,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(t,this.ac.currentTime))}},{key:"feedback",value:function(t){if(t&&"number"!=typeof t)t.connect(this._leftGain.gain),t.connect(this._rightGain.gain);else{if(t>=1)throw new Error("Feedback value will force a positive feedback loop.");"number"==typeof t&&(this._leftGain.gain.value=t,this._rightGain.gain.value=t)}return this._leftGain.gain.value}},{key:"filter",value:function(t,q){this._leftFilter.set(t,q),this._rightFilter.set(t,q)}},{key:"setType",value:function(t){1===t&&(t="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),"pingPong"===t?(this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay)):(this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._rightFilter.output.connect(this.rightDelay))}},{key:"dispose",value:function(){Ee(Ne(e.prototype),"dispose",this).call(this),this._split.disconnect(),this._leftFilter.dispose(),this._rightFilter.dispose(),this._merge.disconnect(),this._leftGain.disconnect(),this._rightGain.disconnect(),this.leftDelay.disconnect(),this.rightDelay.disconnect(),this._split=void 0,this._leftFilter=void 0,this._rightFilter=void 0,this._merge=void 0,this._leftGain=void 0,this._rightGain=void 0,this.leftDelay=void 0,this.rightDelay=void 0}}])&&Re(n.prototype,r),o&&Re(n,o),e}(Zt);function Me(t){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Me(t)}function Ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function De(t,e,n){return e&&Fe(t.prototype,e),n&&Fe(t,n),t}function Ie(t,e){return!e||"object"!==Me(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ue(t,e,n){return Ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Ge(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(n):desc.value}},Ue(t,e,n||t)}function Ge(t){return Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ge(t)}function Le(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ze(t,e)}function ze(t,p){return ze=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},ze(t,p)}var We=function(t){function e(){var t;return Ve(this,e),(t=Ie(this,Ge(e).call(this)))._initConvolverNode(),t.input.gain.value=.5,t._seconds=3,t._decay=2,t._reverse=!1,t._buildImpulse(),t}return Le(e,t),De(e,[{key:"_initConvolverNode",value:function(){this.convolverNode=this.ac.createConvolver(),this.input.connect(this.convolverNode),this.convolverNode.connect(this.wet)}},{key:"_teardownConvolverNode",value:function(){this.convolverNode&&(this.convolverNode.disconnect(),delete this.convolverNode)}},{key:"_setBuffer",value:function(t){this._teardownConvolverNode(),this._initConvolverNode(),this.convolverNode.buffer=t}},{key:"process",value:function(t,e,n,r){t.connect(this.input);var o=!1;e&&(this._seconds=e,o=!0),n&&(this._decay=n),r&&(this._reverse=r),o&&this._buildImpulse()}},{key:"set",value:function(t,e,n){var r=!1;t&&(this._seconds=t,r=!0),e&&(this._decay=e),n&&(this._reverse=n),r&&this._buildImpulse()}},{key:"_buildImpulse",value:function(){var t,i,e=this.ac.sampleRate,n=e*this._seconds,r=this._decay,o=this.ac.createBuffer(2,n,e),c=o.getChannelData(0),l=o.getChannelData(1);for(i=0;i<n;i++)t=this._reverse?n-i:i,c[i]=(2*Math.random()-1)*Math.pow(1-t/n,r),l[i]=(2*Math.random()-1)*Math.pow(1-t/n,r);this._setBuffer(o)}},{key:"dispose",value:function(){Ue(Ge(e.prototype),"dispose",this).call(this),this._teardownConvolverNode()}}]),e}(Zt),Ze=function(t){function e(path,t,n){var r;return Ve(this,e),(r=Ie(this,Ge(e).call(this)))._initConvolverNode(),r.input.gain.value=.5,path?(r.impulses=[],r._loadBuffer(path,t,n)):(r._seconds=3,r._decay=2,r._reverse=!1,r._buildImpulse()),r.impulses=[],r.set=null,r}return Le(e,t),De(e,[{key:"_loadBuffer",value:function(t,e,n){var path=p5.prototype._checkFileFormats(t),o=this,c=(new Error).stack,l=Object(r.b)(),h=new XMLHttpRequest;h.open("GET",path,!0),h.responseType="arraybuffer",h.onload=function(){if(200===h.status)l.decodeAudioData(h.response,(function(t){var n={},r=path.split("/");n.name=r[r.length-1],n.audioBuffer=t,o.impulses.push(n),o._setBuffer(n.audioBuffer),e&&e(n)}),(function(){var t=new w("decodeAudioData",c,o.url),e="AudioContext error at decodeAudioData for "+o.url;n?(t.msg=e,n(t)):console.error(e+"\n The error stack trace includes: \n"+t.stack)}));else{var t=new w("loadConvolver",c,o.url),r="Unable to load "+o.url+". The request status was: "+h.status+" ("+h.statusText+")";n?(t.message=r,n(t)):console.error(r+"\n The error stack trace includes: \n"+t.stack)}},h.onerror=function(){var t=new w("loadConvolver",c,o.url),e="There was no response from the server at "+o.url+". Check the url and internet connectivity.";n?(t.message=e,n(t)):console.error(e+"\n The error stack trace includes: \n"+t.stack)},h.send()}},{key:"process",value:function(t){t.connect(this.input)}},{key:"addImpulse",value:function(path,t,e){window.location.origin.indexOf("file://")>-1&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(path,t,e)}},{key:"resetImpulse",value:function(path,t,e){window.location.origin.indexOf("file://")>-1&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(path,t,e)}},{key:"toggleImpulse",value:function(t){if("number"==typeof t&&t<this.impulses.length&&this._setBuffer(this.impulses[t].audioBuffer),"string"==typeof t)for(var i=0;i<this.impulses.length;i++)if(this.impulses[i].name===t){this._setBuffer(this.impulses[i].audioBuffer);break}}},{key:"dispose",value:function(){for(var i in Ue(Ge(e.prototype),"dispose",this).call(this),this.impulses)this.impulses[i]&&(this.impulses[i]=null)}}]),e}(We);var Xe=n(11),Ye=n.n(Xe);function He(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $e=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clock=new Ye.a({callback:this.ontick.bind(this)}),this.syncedParts=[],this.bpm=120,this._init(),this.prevTick=0,this.tatumTime=0,this.tickCallback=function(){}}var e,n,r;return e=t,n=[{key:"ontick",value:function(t){var e=t-this.prevTick,n=t-main.audiocontext.currentTime;if(!(e-this.tatumTime<=-.02)){this.prevTick=t;var r=this;this.syncedParts.forEach((function(t){t.isPlaying&&(t.incrementStep(n),t.phrases.forEach((function(t){var e=t.sequence,o=r.metroTicks%e.length;0!==e[o]&&(r.metroTicks<e.length||!t.looping)&&t.callback(n,e[o])})))})),this.metroTicks+=1,this.tickCallback(n)}}},{key:"setBPM",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=60/(t*this.tatums),r=main.audiocontext.currentTime;this.tatumTime=n,this.clock.frequency.setValueAtTime(this.clock.frequency.value,r),this.clock.frequency.linearRampToValueAtTime(t,r+e),this.bpm=t}},{key:"getBPM",value:function(){return this.clock.getRate()/this.tatums*60}},{key:"_init",value:function(){this.metroTicks=0}},{key:"resetSync",value:function(t){this.syncedParts=[t]}},{key:"pushSync",value:function(t){this.syncedParts.push(t)}},{key:"start",value:function(t){var e=t||0,n=main.audiocontext.currentTime;this.clock.start(n+e),this.setBPM(this.bpm)}},{key:"stop",value:function(t){var e=t||0,n=main.audiocontext.currentTime;this.clock.stop(n+e)}},{key:"beatLength",value:function(t){this.tatums=1/t/4}}],n&&He(e.prototype,n),r&&He(e,r),t}(),Qe=$e;function Je(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ke(t,e,n){return e&&Je(t.prototype,e),n&&Je(t,n),t}function tn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var en=120;p5.prototype.setBPM=function(t,e){for(var i in en=t,main.parts)main.parts[i]&&main.parts[i].setBPM(t,e)};var nn=function t(e,n,r){tn(this,t),this.phraseStep=0,this.name=e,this.callback=n,this.sequence=r},rn=function(){function t(e,n){tn(this,t),this.length=e||0,this.partStep=0,this.phrases=[],this.isPlaying=!1,this.noLoop(),this.tatums=n||.0625,this.metro=new Qe,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(en),main.parts.push(this),this.callback=function(){}}return Ke(t,[{key:"setBPM",value:function(t,e){this.metro.setBPM(t,e)}},{key:"getBPM",value:function(){return this.metro.getBPM()}},{key:"start",value:function(time){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);var t=time||0;this.metro.start(t)}}},{key:"loop",value:function(time){this.looping=!0,this.onended=function(){this.partStep=0};var t=time||0;this.start(t)}},{key:"noLoop",value:function(){this.looping=!1,this.onended=function(){this.stop()}}},{key:"stop",value:function(time){this.partStep=0,this.pause(time)}},{key:"pause",value:function(time){this.isPlaying=!1;var t=time||0;this.metro.stop(t)}},{key:"addPhrase",value:function(t,e,n){var p;if(3===arguments.length)p=new nn(t,e,n);else{if(!(arguments[0]instanceof nn))throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";p=arguments[0]}this.phrases.push(p),p.sequence.length>this.length&&(this.length=p.sequence.length)}},{key:"removePhrase",value:function(t){for(var i in this.phrases)this.phrases[i].name===t&&this.phrases.splice(i,1)}},{key:"getPhrase",value:function(t){for(var i in this.phrases)if(this.phrases[i].name===t)return this.phrases[i]}},{key:"replaceSequence",value:function(t,e){for(var i in this.phrases)this.phrases[i].name===t&&(this.phrases[i].sequence=e)}},{key:"incrementStep",value:function(time){this.partStep<this.length-1?(this.callback(time),this.partStep+=1):this.looping||this.partStep!==this.length-1||this.onended()}},{key:"onStep",value:function(t){this.callback=t}}]),t}(),on=function(){function t(){tn(this,t),this.parts=[],this.currentPart=new Array(arguments.length);var e=this;for(var i in arguments)this.parts[i]=arguments[i],this.parts[i].nextPart=this.parts[i+1],this.parts[i].onended=function(){e.resetPart(i),sn(e)};this.looping=!1}return Ke(t,[{key:"onended",value:function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0}},{key:"start",value:function(){this.parts[this.currentPart].start(),this.scoreStep=0}},{key:"stop",value:function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0}},{key:"pause",value:function(){this.parts[this.currentPart].stop()}},{key:"loop",value:function(){this.looping=!0,this.start()}},{key:"noLoop",value:function(){this.looping=!1}},{key:"resetParts",value:function(){var t=this;this.parts.forEach((function(e){t.resetParts[e]}))}},{key:"resetPart",value:function(i){for(var p in this.parts[i].stop(),this.parts[i].partStep=0,this.parts[i].phrases)this.parts[i]&&(this.parts[i].phrases[p].phraseStep=0)}},{key:"setBPM",value:function(t,e){for(var i in this.parts)this.parts[i]&&this.parts[i].setBPM(t,e)}}]),t}();function sn(t){t.currentPart++,t.currentPart>=t.parts.length?(t.scoreStep=0,t.onended()):(t.scoreStep=0,t.parts[t.currentPart-1].stop(),t.parts[t.currentPart].start())}function an(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var un=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,"bpm",{get:function(){return this._bpm},set:function(t){this.musicalTimeMode||console.warn('Changing the BPM in "seconds" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string ("2n", "4n", "1m"...etc)'),this._bpm=t,this._update()}}),Object.defineProperty(this,"timeSignature",{get:function(){return this._timeSignature},set:function(t){this.musicalTimeMode||console.warn('Changing the timeSignature in "seconds" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string ("2n", "4n", "1m"...etc)'),this._timeSignature=t,this._update()}}),Object.defineProperty(this,"interval",{get:function(){return this._interval},set:function(t){this.musicalTimeMode="number"!=typeof t,this._interval=t,this._update()}}),Object.defineProperty(this,"iterations",{get:function(){return this.clock.ticks}}),this.callback=e,this.musicalTimeMode="number"!=typeof this._interval,this._interval=n||1,this._timeSignature=4,this._bpm=60,this.isPlaying=!1,this.maxIterations=1/0;var r=this;this.clock=new Ye.a({callback:function(time){var t=time-main.audiocontext.currentTime;t>0&&r.iterations<=r.maxIterations&&r.callback(t)},frequency:this._calcFreq()})}var e,n,r;return e=t,(n=[{key:"start",value:function(t){var e=t||0,n=main.audiocontext.currentTime;this.isPlaying||(this.clock.start(n+e),this.isPlaying=!0)}},{key:"stop",value:function(t){var e=t||0,n=main.audiocontext.currentTime;this.isPlaying&&(this.clock.stop(n+e),this.isPlaying=!1)}},{key:"pause",value:function(t){var e=t||0,n=main.audiocontext.currentTime;this.isPlaying&&(this.clock.pause(n+e),this.isPlaying=!1)}},{key:"syncedStart",value:function(t,e){var n=e||0,r=main.audiocontext.currentTime;if(t.isPlaying){if(t.isPlaying){var time=t.clock._nextTick-main.audiocontext.currentTime;this.clock.start(r+time),this.isPlaying=!0}}else t.clock.start(r+n),t.isPlaying=!0,this.clock.start(r+n),this.isPlaying=!0}},{key:"_update",value:function(){this.clock.frequency.value=this._calcFreq()}},{key:"_calcFreq",value:function(){return"number"==typeof this._interval?(this.musicalTimeMode=!1,1/this._interval):"string"==typeof this._interval?(this.musicalTimeMode=!0,this._bpm/60/this._convertNotation(this._interval)*(this._timeSignature/4)):void 0}},{key:"_convertNotation",value:function(t){var e=t.slice(-1);switch(t=Number(t.slice(0,-1)),e){case"m":return this._measure(t);case"n":return this._note(t);default:console.warn("Specified interval is not formatted correctly. See Tone.js timing reference for more info: https://github.com/Tonejs/Tone.js/wiki/Time")}}},{key:"_measure",value:function(t){return t*this._timeSignature}},{key:"_note",value:function(t){return this._timeSignature/t}}])&&an(e.prototype,n),r&&an(e,r),t}();function cn(t){return cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cn(t)}function ln(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hn(t,e){return!e||"object"!==cn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pn(t,e,n){return pn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=fn(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(n):desc.value}},pn(t,e,n||t)}function fn(t){return fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},fn(t)}function dn(t,p){return dn=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},dn(t,p)}var yn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hn(this,fn(e).call(this))).compressor=t.ac.createDynamicsCompressor(),t.input.connect(t.compressor),t.compressor.connect(t.wet),t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dn(t,e)}(e,t),n=e,(r=[{key:"process",value:function(t,e,n,r,o,c){t.connect(this.input),this.set(e,n,r,o,c)}},{key:"set",value:function(t,e,n,r,o){void 0!==t&&this.attack(t),void 0!==e&&this.knee(e),void 0!==n&&this.ratio(n),void 0!==r&&this.threshold(r),void 0!==o&&this.release(o)}},{key:"attack",value:function(t,time){var e=time||0;return"number"==typeof t?(this.compressor.attack.value=t,this.compressor.attack.cancelScheduledValues(this.ac.currentTime+.01+e),this.compressor.attack.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):void 0!==t&&t.connect(this.compressor.attack),this.compressor.attack.value}},{key:"knee",value:function(t,time){var e=time||0;return"number"==typeof t?(this.compressor.knee.value=t,this.compressor.knee.cancelScheduledValues(this.ac.currentTime+.01+e),this.compressor.knee.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):void 0!==t&&t.connect(this.compressor.knee),this.compressor.knee.value}},{key:"ratio",value:function(t,time){var e=time||0;return"number"==typeof t?(this.compressor.ratio.value=t,this.compressor.ratio.cancelScheduledValues(this.ac.currentTime+.01+e),this.compressor.ratio.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):void 0!==t&&t.connect(this.compressor.ratio),this.compressor.ratio.value}},{key:"threshold",value:function(t,time){var e=time||0;return"number"==typeof t?(this.compressor.threshold.value=t,this.compressor.threshold.cancelScheduledValues(this.ac.currentTime+.01+e),this.compressor.threshold.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):void 0!==t&&t.connect(this.compressor.threshold),this.compressor.threshold.value}},{key:"release",value:function(t,time){var e=time||0;return"number"==typeof t?(this.compressor.release.value=t,this.compressor.release.cancelScheduledValues(this.ac.currentTime+.01+e),this.compressor.release.linearRampToValueAtTime(t,this.ac.currentTime+.02+e)):"undefined"!=typeof number&&t.connect(this.compressor.release),this.compressor.release.value}},{key:"reduction",value:function(){return this.compressor.reduction.value}},{key:"dispose",value:function(){pn(fn(e.prototype),"dispose",this).call(this),this.compressor&&(this.compressor.disconnect(),delete this.compressor)}}])&&ln(n.prototype,r),o&&ln(n,o),e}(Zt);function mn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var vn=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.framesPerPeak=o||20,this.framesSinceLastPeak=0,this.decayRate=.95,this.threshold=r||.35,this.cutoff=0,this.cutoffMult=1.5,this.energy=0,this.penergy=0,this.currentValue=0,this.isDetected=!1,this.f1=e||40,this.f2=n||2e4,this._onPeak=function(){}}var e,n,r;return e=t,(n=[{key:"update",value:function(t){var e=this.energy=t.getEnergy(this.f1,this.f2)/255;e>this.cutoff&&e>this.threshold&&e-this.penergy>0?(this._onPeak(),this.isDetected=!0,this.cutoff=e*this.cutoffMult,this.framesSinceLastPeak=0):(this.isDetected=!1,this.framesSinceLastPeak<=this.framesPerPeak?this.framesSinceLastPeak++:(this.cutoff*=this.decayRate,this.cutoff=Math.max(this.cutoff,this.threshold))),this.currentValue=e,this.penergy=e}},{key:"onPeak",value:function(t,e){var n=this;n._onPeak=function(){t(n.energy,e)}}}])&&mn(e.prototype,n),r&&mn(e,r),t}();function _n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var gn=main.audiocontext,bn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.input=gn.createGain(),this.output=gn.createGain(),this._inputChannels=2,this._outputChannels=2;var e=T(1024);this._workletNode=new AudioWorkletNode(gn,l.a.recorderProcessor,{outputChannelCount:[this._outputChannels],processorOptions:{numInputChannels:this._inputChannels,bufferSize:e}}),this._workletNode.port.onmessage=function(t){if("buffers"===t.data.name){var e=[new Float32Array(t.data.leftBuffer),new Float32Array(t.data.rightBuffer)];this._callback(e)}}.bind(this),this._callback=function(){},this._workletNode.connect(p5.soundOut._silentNode),this.setInput(),main.soundArray.push(this)}var e,n,r;return e=t,(n=[{key:"setInput",value:function(t){this.input.disconnect(),this.input=null,this.input=gn.createGain(),this.input.connect(this._workletNode),this.input.connect(this.output),t?t.connect(this.input):p5.soundOut.output.connect(this.input)}},{key:"record",value:function(t,e,n){this._workletNode.port.postMessage({name:"start",duration:e}),t&&n?this._callback=function(e){t.setBuffer(e),n()}:t&&(this._callback=function(e){t.setBuffer(e)})}},{key:"stop",value:function(){this._workletNode.port.postMessage({name:"stop"})}},{key:"dispose",value:function(){var t=main.soundArray.indexOf(this);main.soundArray.splice(t,1),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._workletNode=null}}])&&_n(e.prototype,n),r&&_n(e,r),t}();function Tn(t){return Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tn(t)}function wn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xn(t,e){return!e||"object"!==Tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sn(t,e,n){return Sn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=kn(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(n):desc.value}},Sn(t,e,n||t)}function kn(t){return kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},kn(t)}function Pn(t,p){return Pn=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},Pn(t,p)}function An(t){for(var e,n="number"==typeof t?t:50,r=44100,o=new Float32Array(r),c=Math.PI/180,i=0;i<r;++i)e=2*i/r-1,o[i]=(3+n)*e*20*c/(Math.PI+n*Math.abs(e));return o}var On=function(t){function e(t,n){var r;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=xn(this,kn(e).call(this)),void 0===t&&(t=.25),"number"!=typeof t)throw new Error("amount must be a number");if(void 0===n&&(n="2x"),"string"!=typeof n)throw new Error("oversample must be a String");var o=p5.prototype.map(t,0,1,0,2e3);return r.waveShaperNode=r.ac.createWaveShaper(),r.amount=o,r.waveShaperNode.curve=An(o),r.waveShaperNode.oversample=n,r.input.connect(r.waveShaperNode),r.waveShaperNode.connect(r.wet),r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pn(t,e)}(e,t),n=e,(r=[{key:"process",value:function(t,e,n){t.connect(this.input),this.set(e,n)}},{key:"set",value:function(t,e){if(t){var n=p5.prototype.map(t,0,1,0,2e3);this.amount=n,this.waveShaperNode.curve=An(n)}e&&(this.waveShaperNode.oversample=e)}},{key:"getAmount",value:function(){return this.amount}},{key:"getOversample",value:function(){return this.waveShaperNode.oversample}},{key:"dispose",value:function(){Sn(kn(e.prototype),"dispose",this).call(this),this.waveShaperNode&&(this.waveShaperNode.disconnect(),this.waveShaperNode=null)}}])&&wn(n.prototype,r),o&&wn(n,o),e}(Zt);function Cn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Rn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ac=main.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.output),main.soundArray.push(this)}var e,n,r;return e=t,n=[{key:"setInput",value:function(t){t.connect(this.input)}},{key:"connect",value:function(t){var u=t||p5.soundOut.input;this.output.connect(u.input?u.input:u)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"amp",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=main.audiocontext.currentTime,o=this.output.gain.value;this.output.gain.cancelScheduledValues(r),this.output.gain.linearRampToValueAtTime(o,r+n),this.output.gain.linearRampToValueAtTime(t,r+n+e)}},{key:"dispose",value:function(){var t=main.soundArray.indexOf(this);main.soundArray.splice(t,1),this.output&&(this.output.disconnect(),delete this.output),this.input&&(this.input.disconnect(),delete this.input)}}],n&&Cn(e.prototype,n),r&&Cn(e,r),t}(),qn=Rn;function En(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Nn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ac=main.audiocontext,this.output=this.ac.createGain(),this.connect(),main.soundArray.push(this)}var e,n,r;return e=t,(n=[{key:"play",value:function(t,e,n,r){}},{key:"triggerAttack",value:function(t,e,n){}},{key:"triggerRelease",value:function(t){}},{key:"amp",value:function(t,e){}},{key:"connect",value:function(t){var u=t||main.input;this.output.connect(u.input?u.input:u)}},{key:"disconnect",value:function(){this.output.disconnect()}},{key:"dispose",value:function(){this.output&&(this.output.disconnect(),delete this.output)}}])&&En(e.prototype,n),r&&En(e,r),t}();function jn(t){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jn(t)}function Bn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vn(t,e,n){return Vn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var base=function(object,t){for(;!Object.prototype.hasOwnProperty.call(object,t)&&null!==(object=Fn(object)););return object}(t,e);if(base){var desc=Object.getOwnPropertyDescriptor(base,e);return desc.get?desc.get.call(n):desc.value}},Vn(t,e,n||t)}function Fn(t){return Fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Fn(t)}function Dn(t,p){return Dn=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t},Dn(t,p)}var In=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e){return!e||"object"!==jn(e)&&"function"!=typeof e?Mn(t):e}(this,Fn(e).call(this))).oscillator=new vt,t.env=new bt,t.env.setRange(1,0),t.env.setExp(!0),t.setADSR(.02,.25,.05,.35),t.oscillator.disconnect(),t.oscillator.connect(t.output),t.env.disconnect(),t.env.setInput(t.output.gain),t.oscillator.output.gain.value=1,t.oscillator.start(),t.connect(),main.soundArray.push(Mn(t)),Object.defineProperties(Mn(t),{attack:{get:function(){return this.env.aTime},set:function(t){this.env.setADSR(t,this.env.dTime,this.env.sPercent,this.env.rTime)}},decay:{get:function(){return this.env.dTime},set:function(t){this.env.setADSR(this.env.aTime,t,this.env.sPercent,this.env.rTime)}},sustain:{get:function(){return this.env.sPercent},set:function(t){this.env.setADSR(this.env.aTime,this.env.dTime,t,this.env.rTime)}},release:{get:function(){return this.env.rTime},set:function(t){this.env.setADSR(this.env.aTime,this.env.dTime,this.env.sPercent,t)}}}),t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dn(t,e)}(e,t),n=e,r=[{key:"play",value:function(t,e,n,r){this.triggerAttack(t,e,~~n),this.triggerRelease(~~n+(r||.15))}},{key:"triggerAttack",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=y(t),o=e||.1;this.oscillator.freq(r,0,n),this.env.ramp(this.output.gain,n,o)}},{key:"triggerRelease",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.env.ramp(this.output.gain,t,0)}},{key:"setADSR",value:function(t,e,n,r){this.env.setADSR(t,e,n,r)}},{key:"amp",value:function(t,e){var n=e||0;return void 0!==t&&this.oscillator.amp(t,n),this.oscillator.amp().value}},{key:"connect",value:function(t){var u=t||main.input;this.output.connect(u.input?u.input:u)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){Vn(Fn(e.prototype),"dispose",this).call(this),this.env&&this.env.dispose(),this.oscillator&&this.oscillator.dispose()}}],r&&Bn(n.prototype,r),o&&Bn(n,o),e}(Nn),Un=In;function Gn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Ln=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isDetected=!1,this.freqLow=e,this.freqHigh=n,this.treshold=r,this.energy=0,this.penergy=0,this.sensitivity=500,this.callback=o}var e,n,r;return e=t,(n=[{key:"update",value:function(t,e){if(this.energy=t.getEnergy(this.freqLow,this.freqHigh)/255,!1===this.isDetected&&this.energy-this.penergy>this.treshold){this.isDetected=!0,this.callback?this.callback(this.energy):e&&e(this.energy);var n=this;setTimeout((function(){n.isDetected=!1}),this.sensitivity)}this.penergy=this.energy}}])&&Gn(e.prototype,n),r&&Gn(e,r),t}();function zn(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Wn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.audiovoices=[],this.notes={},this._newest=0,this._oldest=0,this.maxVoices=n||8,this.AudioVoice=void 0===e?p5.MonoSynth:e,this._voicesInUse=new gt.a(0),this.output=main.audiocontext.createGain(),this.connect(),this._allocateVoices(),main.soundArray.push(this)}var e,n,r;return e=t,n=[{key:"_allocateVoices",value:function(){for(var i=0;i<this.maxVoices;i++)this.audiovoices.push(new this.AudioVoice),this.audiovoices[i].disconnect(),this.audiovoices[i].connect(this.output)}},{key:"play",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.noteAttack(t,e,n),this.noteRelease(t,n+r)}},{key:"noteADSR",value:function(t,a,e,s,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=main.audiocontext.currentTime,c=o+r;this.audiovoices[this.notes[t].getValueAtTime(c)].setADSR(a,e,s,n)}},{key:"setADSR",value:function(a,t,s,e){this.audiovoices.forEach((function(n){n.setADSR(a,t,s,e)}))}},{key:"noteAttack",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=main.audiocontext.currentTime+r,c=y(t),l=e||.1;this.notes[c]&&null!==this.notes[c].getValueAtTime(o)&&this.noteRelease(c,0),this._voicesInUse.getValueAtTime(o)<this.maxVoices?n=Math.max(~~this._voicesInUse.getValueAtTime(o),0):(n=this._oldest,oldestNote=f(this.audiovoices[this._oldest].oscillator.freq().value),this.noteRelease(oldestNote),this._oldest=(this._oldest+1)%(this.maxVoices-1)),this.notes[c]=new gt.a,this.notes[c].setValueAtTime(n,o);var h=null===this._voicesInUse._searchBefore(o)?0:this._voicesInUse._searchBefore(o).value;if(this._voicesInUse.setValueAtTime(h+1,o),this._updateAfter(o,1),this._newest=n,"number"==typeof l){var d=1/this._voicesInUse.getValueAtTime(o)*2;l=l>d?d:l}this.audiovoices[n].triggerAttack(c,l,r)}},{key:"_updateAfter",value:function(time,t){if(null!==this._voicesInUse._searchAfter(time)){this._voicesInUse._searchAfter(time).value+=t;var e=this._voicesInUse._searchAfter(time).time;this._updateAfter(e,t)}}},{key:"noteRelease",value:function(t,e){var n=main.audiocontext.currentTime,r=e||0,o=n+r;if(t){var c=y(t);if(this.notes[c]&&null!==this.notes[c].getValueAtTime(o)){var l=Math.max(~~this._voicesInUse.getValueAtTime(o).value,1);this._voicesInUse.setValueAtTime(l-1,o),l>0&&this._updateAfter(o,-1),this.audiovoices[this.notes[c].getValueAtTime(o)].triggerRelease(r),this.notes[c].dispose(),delete this.notes[c],this._newest=0===this._newest?0:(this._newest-1)%(this.maxVoices-1)}else console.warn("Cannot release a note that is not already playing")}else for(var h in this.audiovoices.forEach((function(t){t.triggerRelease(r)})),this._voicesInUse.setValueAtTime(0,o),this.notes)this.notes[h].dispose(),delete this.notes[h]}},{key:"connect",value:function(t){var u=t||main.input;this.output.connect(u.input?u.input:u)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){this.audiovoices.forEach((function(t){t.dispose()})),this.output&&(this.output.disconnect(),delete this.output)}}],n&&zn(e.prototype,n),r&&zn(e,r),t}(),Zn=Wn;var Xn=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),console.warn("p5.Signal is deprecated , Use Tone.js Signal instead ")};p5.prototype.getAudioContext=r.b,p5.prototype.userStartAudio=r.c,p5.prototype.sampleRate=function(){return main.audiocontext.sampleRate},p5.prototype.freqToMidi=f,p5.prototype.midiToFreq=d,p5.prototype.noteToFreq=y,p5.prototype.soundFormats=function(){main.extensions=[];for(var i=0;i<arguments.length;i++){if(arguments[i]=arguments[i].toLowerCase(),!(["mp3","wav","ogg","m4a","aac"].indexOf(arguments[i])>-1))throw arguments[i]+" is not a valid sound format!";main.extensions.push(arguments[i])}},p5.prototype.disposeSound=function(){for(var i=0;i<main.soundArray.length;i++)main.soundArray[i].dispose()},p5.prototype._checkFileFormats=function(t){var path;if("string"==typeof t){var e=(path=t).split(".").pop();if(["mp3","wav","ogg","m4a","aac"].indexOf(e)>-1){if(!p5.prototype.isFileSupported(e))for(var n=path.split("."),r=n[n.length-1],o=0;o<main.extensions.length;o++){var c=main.extensions[o];if(p5.prototype.isFileSupported(c)){r="",2===n.length&&(r+=n[0]);for(var l=1;l<=n.length-2;l++){r+="."+n[l]}path=r+=".",path=path+=c;break}}}else for(var f=0;f<main.extensions.length;f++){var d=main.extensions[f];if(p5.prototype.isFileSupported(d)){path=path+"."+d;break}}}else if("object"===h(t))for(var i=0;i<t.length;i++){var y=t[i].split(".").pop();if(p5.prototype.isFileSupported(y)){path=t[i];break}}return path},p5.prototype._mathChain=function(t,e,n,r,o){for(var i in t.mathOps)t.mathOps[i]instanceof o&&(t.mathOps[i].dispose(),(n=i)<t.mathOps.length-1&&(r=t.mathOps[i+1]));return t.mathOps[n-1].disconnect(),t.mathOps[n-1].connect(e),e.connect(r),t.mathOps[n]=e,t},p5.prototype.convertToWav=m,p5.prototype.interleave=v,p5.prototype.writeUTFBytes=_,p5.prototype.safeBufferSize=T,p5.prototype.saveSound=function(t,e){var n=m(t.buffer);p5.prototype.writeFile([n],e,"wav")},p5.prototype.registerMethod("remove",p5.prototype.disposeSound),p5.Panner=E,p5.SoundFile=I,p5.prototype.loadSound=function(path,t,e,n){window.location.origin.indexOf("file://")>-1&&"undefined"===window.cordova&&window.alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var r=this,s=new D(path,(function(){"function"==typeof t&&t.apply(r,arguments),"function"==typeof r._decrementPreload&&r._decrementPreload()}),e,n);return s},p5.prototype.registerPreloadMethod("loadSound",p5.prototype),p5.Amplitude=G,p5.FFT=H,p5.Oscillator=vt,p5.SinOsc=pt,p5.TriOsc=ft,p5.SawOsc=yt,p5.SqrOsc=mt,p5.Noise=Ct,p5.Pulse=Dt,p5.AudioIn=Ut,p5.Effect=Zt,p5.Filter=filter,p5.LowPass=ne,p5.HighPass=ie,p5.BandPass=re,p5.EQ=_e,p5.listener3D=Te,p5.Panner3D=Oe,p5.Delay=Be,p5.Reverb=We,p5.Convolver=Ze,p5.prototype.createConvolver=function(path,t,e){window.location.origin.indexOf("file://")>-1&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var n=this,r=new Ze(path,(function(e){"function"==typeof t&&t(e),"function"==typeof n._decrementPreload&&n._decrementPreload()}),e);return r.impulses=[],r},p5.prototype.registerPreloadMethod("createConvolver",p5.prototype),p5.Metro=Qe,p5.Phrase=nn,p5.Part=rn,p5.Score=on,p5.SoundLoop=un,p5.Compressor=yn,p5.peakDetect=vn,p5.SoundRecorder=bn,p5.Distortion=On,p5.Gain=qn,p5.AudioVoice=Nn,p5.MonoSynth=Un,p5.OnsetDetect=Ln,p5.PolySynth=Zn,p5.PeakDetect=vn,p5.Signal=Xn}])}}]);